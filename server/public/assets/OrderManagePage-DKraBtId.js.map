{"version":3,"file":"OrderManagePage-DKraBtId.js","sources":["../../../client/src/pages/admin/order/OrderManagePage.vue"],"sourcesContent":["<template>\n  <div class=\"order-management\">\n    <h1>주문 관리</h1>\n\n    <!-- 검색 영역 -->\n    <div class=\"search-area\">\n      <va-input\n        v-model=\"searchText\"\n        placeholder=\"주문번호, 거래처명 검색\"\n        style=\"width: 300px\"\n      />\n      <va-button @click=\"handleSearch\">검색</va-button>\n    </div>\n\n    <!-- 권한 없는 사용자를 위한 메시지 -->\n    <div v-if=\"!canManageSales\" class=\"permission-notice\">\n      <va-alert color=\"info\" icon=\"info\">\n        조회 전용 모드입니다. 주문 관리는 영업부서 권한이 필요합니다.\n      </va-alert>\n    </div>\n\n    <!-- 주문 목록 테이블 -->\n    <div class=\"table-section\">\n      <table class=\"order-table\">\n        <thead>\n          <tr>\n            <th>주문번호</th>\n            <th>거래처명</th>\n            <th>주문일</th>\n            <th>납기일</th>\n            <th>상태</th>\n            <!-- 삭제 버튼은 영업 권한이 있을 때만 -->\n            <th v-if=\"canManageSales\" style=\"width: 80px; text-align: center\">\n              삭제\n            </th>\n          </tr>\n        </thead>\n        <tbody>\n          <template v-for=\"order in groupedOrders\" :key=\"order.orderId\">\n            <!-- 주문 헤더 행 -->\n            <tr\n              @click=\"handleOrderClick(order)\"\n              class=\"order-header-row\"\n              :class=\"{\n                selected: selectedOrderId === order.orderId && canManageSales,\n                'read-only': !canManageSales,\n              }\"\n            >\n              <td>{{ order.orderId }}</td>\n              <td>{{ order.customerName }}</td>\n              <td>{{ formatDateToYMD(order.orderDate) }}</td>\n              <td>{{ formatDateToYMD(order.deliveryDate) }}</td>\n              <td>\n                <va-chip\n                  :color=\"getStatusColor(order.status)\"\n                  size=\"small\"\n                  :class=\"{ 'clickable-status': canManageSales }\"\n                  @click.stop=\"canManageSales ? openStatusModal(order) : null\"\n                  :title=\"canManageSales ? '클릭하여 상태 변경' : ''\"\n                >\n                  {{ order.status }}\n                </va-chip>\n              </td>\n              <!-- 삭제 버튼은 영업 권한이 있을 때만 -->\n              <td v-if=\"canManageSales\" style=\"text-align: center\">\n                <va-button\n                  icon=\"delete\"\n                  preset=\"plain\"\n                  size=\"medium\"\n                  color=\"danger\"\n                  @click.stop=\"deleteOrder(order)\"\n                  title=\"주문 삭제\"\n                />\n              </td>\n            </tr>\n\n            <!-- 제품 목록 행 (펼쳐질 때만 표시) -->\n            <Transition name=\"accordion\">\n              <tr\n                v-if=\"expandedOrders.includes(order.orderId)\"\n                class=\"product-details-row\"\n              >\n                <td :colspan=\"canManageSales ? 6 : 5\">\n                  <table class=\"product-table\">\n                    <thead>\n                      <tr>\n                        <th>제품명</th>\n                        <th>규격</th>\n                        <th>수량</th>\n                        <th>제품코드</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      <tr v-for=\"item in order.items\" :key=\"item.productCode\">\n                        <td>{{ item.productName }}</td>\n                        <td>{{ item.productStand }}</td>\n                        <td>{{ item.quantity }}</td>\n                        <td>{{ item.productCode }}</td>\n                      </tr>\n                    </tbody>\n                  </table>\n                </td>\n              </tr>\n            </Transition>\n          </template>\n        </tbody>\n      </table>\n    </div>\n\n    <!-- 주문 등록/수정 폼 (영업 권한만) -->\n    <div class=\"form-section\" v-if=\"canManageSales\">\n      <h2>{{ editMode ? \"주문 수정\" : \"주문 등록\" }}</h2>\n\n      <!-- 기본 정보 -->\n      <div class=\"form-row\">\n        <div class=\"form-group\" style=\"width: 240px\">\n          <label>거래처 <span class=\"required\">*</span></label>\n          <va-select\n            v-model=\"form.customerId\"\n            :options=\"customerOptions\"\n            placeholder=\"거래처를 선택하세요\"\n            style=\"width: 240px\"\n            text-by=\"label\"\n            value-by=\"value\"\n          />\n        </div>\n\n        <div class=\"form-group\">\n          <label>주문일 <span class=\"required\">*</span></label>\n          <va-date-input v-model=\"form.orderDate\" />\n        </div>\n        <div class=\"form-group\">\n          <label>납기일 <span class=\"required\">*</span></label>\n          <va-date-input v-model=\"form.deliveryDate\" />\n        </div>\n\n        <div class=\"form-group\">\n          <label>작성자</label>\n          <va-input\n            v-model=\"form.createdBy\"\n            placeholder=\"작성자명\"\n            style=\"width: 250px\"\n          />\n        </div>\n      </div>\n\n      <!-- 제품 정보 -->\n      <div class=\"products-section\">\n        <div class=\"section-header\">\n          <h3>제품 정보</h3>\n          <va-button size=\"small\" @click=\"addProduct\">제품 추가</va-button>\n        </div>\n\n        <table class=\"product-table\">\n          <thead>\n            <tr>\n              <th style=\"width: 186px\">제품명</th>\n              <th style=\"width: 120px\">규격 (정)</th>\n              <th>제품코드</th>\n              <th>수량 (box)</th>\n              <th>단가 (원)</th>\n              <th>주문가격 (원)</th>\n              <th style=\"width: 50px; text-align: center\">삭제</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(item, index) in form.products\" :key=\"index\">\n              <!-- 제품명 -->\n              <td>\n                <va-select\n                  v-model=\"item.productName\"\n                  :options=\"uniqueProductName\"\n                  placeholder=\"제품 선택\"\n                  @update:model-value=\"(val) => updateProduct(val, index)\"\n                />\n              </td>\n              <!-- 규격 -->\n              <td>\n                <va-select\n                  v-model=\"item.productStand\"\n                  :options=\"getProductStandOptions(item.productName)\"\n                  placeholder=\"규격 선택\"\n                  @update:model-value=\"\n                    (val) =>\n                      updateProductByProductStand(item.productName, val, index)\n                  \"\n                  :disabled=\"!item.productName\"\n                />\n              </td>\n              <!-- 제품코드 -->\n              <td>{{ item.productCode }}</td>\n              <!-- 수량 -->\n              <td>\n                <va-input\n                  v-model.number=\"item.quantity\"\n                  type=\"number\"\n                  min=\"1\"\n                  @input=\"onQuantityInput(index)\"\n                />\n              </td>\n              <!-- 단가 -->\n              <td>\n                {{ item.unitPrice.toLocaleString() }}\n              </td>\n              <!-- 주문가격 -->\n              <td>\n                {{ computedOrderPrices[index].toLocaleString() }}\n              </td>\n              <td style=\"text-align: center\">\n                <va-button\n                  icon=\"delete\"\n                  preset=\"plain\"\n                  size=\"medium\"\n                  color=\"danger\"\n                  @click=\"removeProduct(index)\"\n                />\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      <!-- 버튼 -->\n      <div class=\"form-actions\">\n        <va-button preset=\"secondary\" @click=\"resetForm\">\n          <va-icon name=\"refresh\" class=\"mr-1\" />\n          초기화\n        </va-button>\n        <va-button preset=\"secondary\" @click=\"cancelForm\">취소</va-button>\n        <va-button @click=\"saveOrder\">{{\n          editMode ? \"수정\" : \"저장\"\n        }}</va-button>\n      </div>\n    </div>\n\n    <!-- 권한 없는 사용자를 위한 안내 섹션 -->\n    <div class=\"permission-info-section\" v-else>\n      <div class=\"permission-content\">\n        <va-icon name=\"shopping_cart\" size=\"large\" color=\"primary\" />\n        <h3>주문 관리 권한 필요</h3>\n        <p>주문 등록 및 수정은 영업부서 권한이 필요합니다.</p>\n        <div class=\"current-permission\">\n          <va-chip color=\"info\" size=\"small\">\n            현재 권한: {{ userRole || \"조회 전용\" }}\n          </va-chip>\n        </div>\n        <p class=\"permission-desc\">\n          주문 목록은 조회할 수 있지만,<br />\n          등록, 수정, 삭제는 영업부서만 가능합니다.\n        </p>\n      </div>\n    </div>\n\n    <!-- 주문 상태 변경 모달 -->\n    <va-modal\n      v-model=\"showStatusModal\"\n      title=\"주문 상태 변경\"\n      size=\"small\"\n      hide-default-actions\n    >\n      <div class=\"status-modal-content\">\n        <div class=\"current-status\">\n          <p>\n            <strong>주문번호:</strong> {{ selectedOrderForStatus?.orderId }}\n          </p>\n          <p>\n            <strong>거래처:</strong> {{ selectedOrderForStatus?.customerName }}\n          </p>\n          <p>\n            <strong>현재 상태:</strong>\n            <va-chip\n              :color=\"getStatusColor(selectedOrderForStatus?.status)\"\n              size=\"small\"\n            >\n              {{ selectedOrderForStatus?.status }}\n            </va-chip>\n          </p>\n        </div>\n\n        <div class=\"form-group\">\n          <label>변경할 상태 <span class=\"required\">*</span></label>\n          <va-select\n            v-model=\"statusForm.newStatus\"\n            :options=\"statusOptions\"\n            placeholder=\"상태를 선택하세요\"\n          />\n        </div>\n      </div>\n\n      <template #footer>\n        <div class=\"modal-footer\">\n          <va-button preset=\"secondary\" @click=\"closeStatusModal\">\n            취소\n          </va-button>\n          <va-button @click=\"updateOrderStatus\" :loading=\"statusLoading\">\n            변경\n          </va-button>\n        </div>\n      </template>\n    </va-modal>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, onMounted } from \"vue\";\nimport axios from \"axios\";\nimport { useAuthStore } from \"@/stores/authStore\";\n\n// 인증 스토어 사용\nconst authStore = useAuthStore();\nconst { canManageSales, userRole } = authStore;\n\n// 데이터\nconst orders = ref<any[]>([]);\nconst customers = ref<any[]>([]);\nconst products = ref<any[]>([]);\n\n// 상태\nconst searchText = ref(\"\");\nconst editMode = ref(false);\nconst selectedOrderId = ref<number | null>(null);\n\n// 상태 모달 관련 데이터\nconst showStatusModal = ref(false);\nconst selectedOrderForStatus = ref<any | null>(null);\nconst statusLoading = ref(false);\n\nconst statusForm = ref({\n  newStatus: \"\",\n});\n\nconst statusOptions = ref([\"대기\", \"진행중\", \"완료\", \"지연\", \"취소\"]);\n\n// 날짜 포맷팅\nconst formatDateToYMD = (date: string | Date): string => {\n  const d = new Date(date);\n  const year = d.getFullYear();\n  const month = (\"0\" + (d.getMonth() + 1)).slice(-2);\n  const day = (\"0\" + d.getDate()).slice(-2);\n  return `${year}-${month}-${day}`;\n};\n\n// 펼쳐진 주문 목록 관리\nconst expandedOrders = ref<number[]>([]);\n\n// 주문 펼치기/접기 토글 함수\nconst toggleOrder = (orderId: number) => {\n  const index = expandedOrders.value.indexOf(orderId);\n  if (index > -1) {\n    expandedOrders.value.splice(index, 1); // 접기\n  } else {\n    expandedOrders.value.push(orderId); // 펼치기\n  }\n};\n\n// 같은 주문번호 그룹(아코디언)\ninterface OrderItem {\n  productName: string;\n  productStand: string;\n  quantity: number;\n  productCode: string;\n}\n\ninterface GroupedOrder {\n  orderId: number;\n  customerName: string;\n  orderDate: string;\n  deliveryDate: string;\n  status: string;\n  items: OrderItem[];\n}\n\nconst groupedOrders = computed<GroupedOrder[]>(() => {\n  const grouped: Record<string, GroupedOrder> = {};\n\n  filteredOrders.value.forEach((order) => {\n    const orderId = order.order_id;\n\n    if (!grouped[orderId]) {\n      grouped[orderId] = {\n        orderId: orderId,\n        customerName: order.account_name,\n        orderDate: order.order_date,\n        deliveryDate: order.delivery_date,\n        status: order.status,\n        items: [],\n      };\n    }\n\n    grouped[orderId].items.push({\n      productName: order.product_name,\n      productStand: order.product_stand,\n      quantity: order.order_qty,\n      productCode: order.product_code,\n    });\n  });\n\n  return Object.values(grouped);\n});\n\n// 폼 데이터\nconst form = ref({\n  customerId: \"\",\n  orderDate: new Date(),\n  deliveryDate: new Date(),\n  createdBy: \"\",\n  products: [\n    {\n      productCode: \"\",\n      productName: \"\",\n      productStand: \"\",\n      quantity: 1,\n      unitPrice: 0,\n    },\n  ],\n});\n\n// computed\nconst filteredOrders = computed(() => {\n  if (!searchText.value) return orders.value;\n\n  const search = searchText.value.toLowerCase();\n  return orders.value.filter(\n    (order) =>\n      String(order.order_id).toLowerCase().includes(search) ||\n      order.account_name.toLowerCase().includes(search),\n  );\n});\n\n// 거래처 선택 드롭다운(고객사만 나오게)\nconst customerOptions = computed(() =>\n  customers.value\n    .filter((c) => c.account_type == \"customer\")\n    .map((c) => ({\n      value: c.account_id,\n      label: c.account_name,\n    })),\n);\n\nconst uniqueProductName = computed(() => {\n  // 제품명 중복제거\n  const uniqueNames = [...new Set(products.value.map((p) => p.product_name))];\n  return uniqueNames;\n});\n\n// 제품 규격 선택\nfunction getProductStandOptions(productName: string) {\n  if (!productName) {\n    return [];\n  }\n\n  return products.value\n    .filter((p) => p.product_name === productName)\n    .map((p) => p.product_stand);\n}\n\n// 수량 마이너스 선택 못하게!\nfunction onQuantityInput(index: number) {\n  const q = form.value.products[index].quantity;\n  if (q < 1 || isNaN(q)) {\n    form.value.products[index].quantity = 1;\n  }\n}\n\n// 주문 가격 computed\nconst computedOrderPrices = computed(() => {\n  return form.value.products.map((item) => item.unitPrice * item.quantity);\n});\n\n// 상태 모달 함수들\nfunction openStatusModal(order: GroupedOrder) {\n  if (!canManageSales) {\n    alert(\"주문 상태 변경 권한이 없습니다.\");\n    return;\n  }\n\n  selectedOrderForStatus.value = order;\n  statusForm.value.newStatus = \"\";\n  showStatusModal.value = true;\n}\n\nfunction closeStatusModal() {\n  showStatusModal.value = false;\n  selectedOrderForStatus.value = null;\n}\n\nasync function updateOrderStatus() {\n  if (!statusForm.value.newStatus) {\n    alert(\"변경할 상태를 선택하세요.\");\n    return;\n  }\n\n  if (statusForm.value.newStatus === selectedOrderForStatus.value?.status) {\n    alert(\"현재 상태와 동일한 상태로는 변경할 수 없습니다.\");\n    return;\n  }\n\n  try {\n    statusLoading.value = true;\n\n    const statusData = {\n      newStatus: statusForm.value.newStatus,\n    };\n\n    await axios.put(\n      `/orders/${selectedOrderForStatus.value!.orderId}/status`,\n      statusData,\n    );\n\n    alert(\"주문 상태가 변경되었습니다.\");\n    closeStatusModal();\n\n    // 주문 목록 새로고침\n    await fetchOrders();\n  } catch (error: any) {\n    console.error(\"상태 변경 실패:\", error);\n    alert(\n      `상태 변경에 실패했습니다.\\n${error.response?.data?.message || \"알 수 없는 오류\"}`,\n    );\n  } finally {\n    statusLoading.value = false;\n  }\n}\n\n// 초기 데이터 로드\nonMounted(() => {\n  console.log(\"컴포넌트 마운트됨\");\n  fetchOrders();\n  fetchCustomers();\n  fetchProducts();\n});\n\n// API 함수들\nasync function fetchOrders() {\n  try {\n    const response = await axios.get(\"/orders/with-items\");\n    console.log(\"주문 데이터:\", response.data);\n    orders.value = response.data || [];\n  } catch (error) {\n    console.error(\"주문 조회 실패:\", error);\n    // Mock 데이터\n    orders.value = [\n      {\n        order_id: 1,\n        account_name: \"셀트리온\",\n        order_date: \"2024-01-15\",\n        delivery_date: \"2024-01-20\",\n        product_name: \"타이레놀 500mg\",\n        product_stand: \"10정\",\n        order_qty: 100,\n        product_code: \"TYL500\",\n        status: \"진행중\",\n      },\n      {\n        order_id: 2,\n        account_name: \"한미약품\",\n        order_date: \"2024-01-16\",\n        delivery_date: \"2024-01-22\",\n        product_name: \"아스피린 100mg\",\n        product_stand: \"30정\",\n        order_qty: 200,\n        product_code: \"ASP100\",\n        status: \"완료\",\n      },\n    ];\n  }\n}\n\nasync function fetchCustomers() {\n  try {\n    const response = await axios.get(\"/account\");\n    console.log(\"거래처 데이터:\", response.data);\n    customers.value = response.data || [];\n  } catch (error) {\n    console.error(\"거래처 조회 실패:\", error);\n    // Mock 데이터 추가\n    customers.value = [\n      { account_id: 1, account_name: \"셀트리온\", account_type: \"customer\" },\n      { account_id: 2, account_name: \"한미약품\", account_type: \"customer\" },\n    ];\n  }\n}\n\nasync function fetchProducts() {\n  try {\n    const response = await axios.get(\"/product\");\n    console.log(\"제품 데이터:\", response.data);\n    products.value = response.data || [];\n  } catch (error) {\n    console.error(\"제품 조회 실패:\", error);\n    // Mock 데이터 추가\n    products.value = [\n      {\n        product_id: 1,\n        product_name: \"타이레놀 500mg\",\n        product_stand: \"10정\",\n        product_code: \"TYL500\",\n        product_pay: 5000,\n      },\n      {\n        product_id: 2,\n        product_name: \"아스피린 100mg\",\n        product_stand: \"30정\",\n        product_code: \"ASP100\",\n        product_pay: 3000,\n      },\n    ];\n  }\n}\n\n// 검색\nfunction handleSearch() {\n  // filteredOrders computed가 자동으로 처리\n}\n\n// 주문 수정\nasync function editOrder(order: GroupedOrder) {\n  if (!canManageSales) {\n    console.log(\"주문 수정 권한이 없습니다.\");\n    return;\n  }\n\n  console.log(\"주문 수정:\", order);\n  editMode.value = true;\n  selectedOrderId.value = order.orderId;\n\n  try {\n    const response = await axios.get(`/orders/${order.orderId}/details`);\n    console.log(\"서버 응답 데이터: \", response.data);\n    const { order: orderInfo, items } = response.data;\n\n    // 거래처 ID 찾기\n    const customer = customers.value.find(\n      (c) => c.account_name === order.customerName,\n    );\n\n    form.value = {\n      customerId: customer?.account_id || \"\",\n      orderDate: new Date(orderInfo.order_date),\n      deliveryDate: new Date(orderInfo.delivery_date),\n      createdBy: orderInfo.created_by || \"\",\n      products: items.map((item: any) => ({\n        productName: item.product_name,\n        productStand: item.product_stand,\n        productCode: item.product_code,\n        quantity: item.order_qty,\n        unitPrice: item.unit_price || 0,\n      })),\n    };\n\n    console.log(\"폼 데이터 설정 완료: \", form.value);\n  } catch (error) {\n    console.error(\"주문 상세 조회 실패:\", error);\n    // API 실패시 목업 데이터로 폼 채우기\n    const customer = customers.value.find(\n      (c) => c.account_name === order.customerName,\n    );\n\n    form.value = {\n      customerId: customer?.account_id || \"\",\n      orderDate: new Date(order.orderDate),\n      deliveryDate: new Date(order.deliveryDate),\n      createdBy: \"관리자\",\n      products: order.items.map((item) => {\n        const product = products.value.find(\n          (p) =>\n            p.product_name === item.productName &&\n            p.product_stand === item.productStand,\n        );\n        return {\n          productName: item.productName,\n          productStand: item.productStand,\n          productCode: item.productCode,\n          quantity: item.quantity,\n          unitPrice: product?.product_pay || 0,\n        };\n      }),\n    };\n  }\n}\n\n// 주문 선택시 토글&수정폼\nfunction handleOrderClick(order: GroupedOrder) {\n  console.log(\"클릭된 order 데이터: \", order);\n  toggleOrder(order.orderId);\n\n  // 영업 권한이 있을 때만 수정 폼 로드\n  if (canManageSales) {\n    editOrder(order);\n  }\n}\n\n// 주문 삭제\nasync function deleteOrder(order: GroupedOrder) {\n  if (!canManageSales) {\n    alert(\"주문 관리 권한이 없습니다.\");\n    return;\n  }\n\n  if (!confirm(`주문번호 ${order.orderId}를 정말 삭제하시겠습니까?`)) return;\n\n  try {\n    await axios.delete(`/orders/${order.orderId}`);\n    alert(\"삭제되었습니다.\");\n\n    // 삭제한 주문이 선택된 상태였다면 폼 초기화\n    if (selectedOrderId.value === order.orderId) {\n      resetForm();\n    }\n\n    fetchOrders();\n  } catch (error) {\n    console.error(\"삭제 실패:\", error);\n    alert(\"삭제에 실패했습니다.\");\n  }\n}\n\nfunction addProduct() {\n  form.value.products.push({\n    productName: \"\",\n    productStand: \"\",\n    quantity: 1,\n    productCode: \"\",\n    unitPrice: 0,\n  });\n}\n\nfunction removeProduct(index: number) {\n  if (form.value.products.length > 1) {\n    form.value.products.splice(index, 1);\n  }\n}\n\n// 제품 선택 시 정보 업데이트\nfunction updateProduct(productName: string, index: number) {\n  const product = products.value.find((p) => p.product_name == productName);\n  if (product) {\n    form.value.products[index] = {\n      productCode: \"\",\n      productName: product.product_name,\n      productStand: \"\",\n      quantity: form.value.products[index].quantity || 1,\n      unitPrice: 0,\n    };\n  }\n}\n\n// 제품명, 규격 선택 시 나머지 데이터 자동입력\nfunction updateProductByProductStand(\n  productName: string,\n  productStand: string,\n  index: number,\n) {\n  console.log(\"규격 업데이트 됨!\");\n  const product = products.value.find(\n    (p) => p.product_name === productName && p.product_stand === productStand,\n  );\n  if (product) {\n    const quantity = form.value.products[index].quantity;\n    const unitPrice = product.product_pay;\n\n    form.value.products[index] = {\n      productCode: product.product_code,\n      productName: product.product_name,\n      productStand: product.product_stand,\n      quantity: quantity,\n      unitPrice: unitPrice,\n    };\n  }\n}\n\n// 폼 초기화\nfunction resetForm() {\n  form.value = {\n    customerId: \"\",\n    orderDate: new Date(),\n    deliveryDate: new Date(),\n    createdBy: \"\",\n    products: [\n      {\n        productName: \"\",\n        productStand: \"\",\n        quantity: 1,\n        productCode: \"\",\n        unitPrice: 0,\n      },\n    ],\n  };\n  editMode.value = false;\n  selectedOrderId.value = null;\n}\n\n// 저장\nasync function saveOrder() {\n  if (!canManageSales) {\n    alert(\"주문 관리 권한이 없습니다.\");\n    return;\n  }\n\n  // 유효성 검사\n  if (!form.value.customerId) {\n    alert(\"거래처를 선택하세요.\");\n    return;\n  }\n\n  if (form.value.products.some((p) => !p.productCode)) {\n    alert(\"제품 정보를 모두 입력하세요.\");\n    return;\n  }\n\n  if (editMode.value) {\n    // 수정모드\n    // 날짜를 YYYY-MM-DD 형식으로 변환\n    const formatDateForAPI = (date: Date) => {\n      const d = new Date(date);\n      const year = d.getFullYear();\n      const month = (\"0\" + (d.getMonth() + 1)).slice(-2);\n      const day = (\"0\" + d.getDate()).slice(-2);\n      return `${year}-${month}-${day}`;\n    };\n\n    const orderData = {\n      account_id: form.value.customerId,\n      order_date: formatDateForAPI(form.value.orderDate),\n      delivery_date: formatDateForAPI(form.value.deliveryDate),\n      created_by: form.value.createdBy || \"관리자\",\n      status: \"진행중\",\n      products: form.value.products.map((p, index) => ({\n        product_code: p.productCode,\n        order_qty: p.quantity,\n        order_price: computedOrderPrices.value[index],\n      })),\n    };\n\n    try {\n      await axios.put(`/orders/${selectedOrderId.value}`, orderData);\n      alert(\"수정되었습니다.\");\n      resetForm();\n      fetchOrders();\n    } catch (error: any) {\n      console.error(\"수정 실패:\", error);\n      alert(\n        `수정에 실패했습니다.\\n${error.response?.data?.message || error.message || \"알 수 없는 오류\"}`,\n      );\n    }\n  } else {\n    // 등록모드 - addOrderTransaction이 기대하는 형식으로\n    const orderData = {\n      customerId: {\n        value: form.value.customerId,\n      },\n      orderDate: form.value.orderDate,\n      deliveryDate: form.value.deliveryDate,\n      createdBy: form.value.createdBy || \"관리자\",\n      products: form.value.products.map((p, index) => ({\n        productCode: p.productCode,\n        quantity: p.quantity,\n        orderPrice: computedOrderPrices.value[index],\n      })),\n    };\n\n    console.log(\"저장할 데이터:\", orderData);\n\n    try {\n      await axios.post(\"/orders\", orderData);\n      alert(\"등록되었습니다.\");\n      resetForm();\n      fetchOrders();\n    } catch (error: any) {\n      console.error(\"저장 실패:\", error);\n      console.error(\"에러 상세:\", error.response?.data);\n      alert(\n        `저장에 실패했습니다.\\n${error.response?.data?.message || error.message || \"알 수 없는 오류\"}`,\n      );\n    }\n  }\n}\n\n// 취소\nfunction cancelForm() {\n  resetForm();\n}\n\n// 날짜 포맷\nfunction formatDate(dateString: string) {\n  if (!dateString) return \"-\";\n  return dateString.split(\"T\")[0];\n}\n\n// 상태별 색상\nfunction getStatusColor(status: string) {\n  const colors: Record<string, string> = {\n    진행중: \"info\",\n    완료: \"success\",\n    지연: \"danger\",\n    대기: \"warning\",\n    취소: \"secondary\",\n  };\n  return colors[status] || \"secondary\";\n}\n</script>\n\n<style scoped>\n.order-management {\n  padding: 20px;\n  max-width: 1400px;\n  margin: 0 auto;\n  min-width: 600px;\n}\n\nh1 {\n  margin-bottom: 20px;\n}\n\n/* 검색 영역 */\n.search-area {\n  display: flex;\n  gap: 10px;\n  margin-bottom: 20px;\n  align-items: center;\n  flex-wrap: nowrap;\n}\n\n.search-area .va-input {\n  width: 300px;\n  flex-shrink: 0;\n}\n\n/* 테이블 섹션 */\n.table-section {\n  background: white;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 20px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  overflow-x: auto;\n}\n\n.order-table {\n  width: 100%;\n  border-collapse: collapse;\n}\n\n.order-table th {\n  background: #f5f5f5;\n  padding: 12px;\n  text-align: left;\n  font-weight: 500;\n  border-bottom: 2px solid #e0e0e0;\n}\n\n.order-table td {\n  padding: 12px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.order-table tr:hover {\n  background: #f8f8f8;\n}\n\n.order-header-row.selected {\n  background-color: #e3f2fd;\n}\n\n.no-data {\n  text-align: center;\n  color: #999;\n}\n\n/* 클릭 가능한 상태 스타일 */\n.clickable-status {\n  cursor: pointer;\n  transition:\n    transform 0.2s,\n    box-shadow 0.2s;\n}\n\n.clickable-status:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n}\n\n/* 폼 섹션 */\n.form-section {\n  background: white;\n  border-radius: 8px;\n  padding: 20px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.form-section h2 {\n  margin-bottom: 20px;\n}\n\n.form-group {\n  margin-bottom: 16px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n}\n\n.form-row {\n  display: grid;\n  grid-template-columns: 1fr 1fr 1fr 1fr;\n  gap: 16px;\n}\n\n.required {\n  color: red;\n}\n\n/* 제품 섹션 */\n.products-section {\n  margin: 20px 0;\n  padding: 16px;\n  border: 1px solid #e0e0e0;\n  border-radius: 4px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n}\n\n.section-header h3 {\n  margin: 0;\n}\n\n.product-table {\n  width: 100%;\n  border-collapse: collapse;\n  table-layout: fixed;\n}\n\n.product-table th {\n  background: #f5f5f5;\n  padding: 8px;\n  text-align: left;\n  font-weight: 500;\n  border: 1px solid #e0e0e0;\n}\n\n.product-table td {\n  padding: 8px;\n  border: 1px solid #e0e0e0;\n}\n\n/* 버튼 영역 */\n.form-actions {\n  display: flex;\n  gap: 10px;\n  justify-content: flex-end;\n  margin-top: 20px;\n}\n\n.new-order-button {\n  margin-top: 20px;\n  text-align: center;\n}\n\n/* 상태 모달 스타일 */\n.status-modal-content {\n  padding: 16px 0;\n}\n\n.current-status {\n  margin-bottom: 20px;\n  padding: 12px;\n  background-color: #f8f9fa;\n  border-radius: 6px;\n}\n\n.current-status p {\n  margin: 4px 0;\n  font-size: 14px;\n}\n\n.modal-footer {\n  display: flex;\n  gap: 8px;\n  justify-content: flex-end;\n}\n\n/* 권한 안내 섹션 */\n.permission-info-section {\n  background: white;\n  border-radius: 8px;\n  padding: 40px 20px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  text-align: center;\n  margin-top: 20px;\n}\n\n.permission-content {\n  max-width: 400px;\n  margin: 0 auto;\n}\n\n.permission-content h3 {\n  margin: 16px 0;\n  color: #333;\n}\n\n.permission-content p {\n  color: #666;\n  line-height: 1.5;\n  margin: 12px 0;\n}\n\n.current-permission {\n  margin: 16px 0;\n}\n\n.permission-desc {\n  font-size: 14px;\n}\n\n/* 반응형 */\n@media (max-width: 1420px) {\n  .form-row {\n    grid-template-columns: 1fr 1fr 1fr;\n  }\n\n  .search-area {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n\n@media (max-width: 1180px) {\n  .form-row {\n    grid-template-columns: 1fr 1fr;\n  }\n\n  .search-area {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n\n@media (max-width: 768px) {\n  .form-row {\n    grid-template-columns: 1fr;\n  }\n\n  .search-area {\n    flex-direction: row;\n    align-items: center;\n  }\n}\n\n.order-header-row {\n  cursor: pointer;\n  transition: background-color 0.2s;\n}\n\n.order-header-row:hover {\n  background-color: #f5f5f5;\n}\n\n.product-details-row {\n  background-color: #fafafa;\n}\n\n.product-details-content {\n  overflow: hidden;\n}\n\n/* 제품목록 흘러내리는 애니메이션 */\n.accordion-enter-active {\n  animation: slideDown 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n}\n\n.accordion-leave-active {\n  animation: slideUp 0.3s cubic-bezier(0.55, 0.085, 0.68, 0.53);\n}\n\n@keyframes slideDown {\n  0% {\n    max-height: 0;\n    opacity: 0;\n    transform: scaleY(0);\n    transform-origin: top;\n  }\n  100% {\n    max-height: 400px;\n    opacity: 1;\n    transform: scaleY(1);\n    transform-origin: top;\n  }\n}\n\n@keyframes slideUp {\n  0% {\n    max-height: 400px;\n    opacity: 1;\n    transform: scaleY(1);\n    transform-origin: top;\n  }\n  100% {\n    max-height: 0;\n    opacity: 0;\n    transform: scaleY(0);\n    transform-origin: top;\n  }\n}\n\n.product-table {\n  width: 100%;\n  margin: 10px 0;\n}\n\n.product-table th,\n.product-table td {\n  padding: 8px;\n  text-align: left;\n  border-bottom: 1px solid #ddd;\n}\n</style>\n"],"names":["authStore","useAuthStore","canManageSales","userRole","orders","ref","customers","products","searchText","editMode","selectedOrderId","showStatusModal","selectedOrderForStatus","statusLoading","statusForm","statusOptions","formatDateToYMD","date","d","year","month","day","expandedOrders","toggleOrder","orderId","index","groupedOrders","computed","grouped","filteredOrders","order","form","search","customerOptions","c","uniqueProductName","p","getProductStandOptions","productName","onQuantityInput","q","computedOrderPrices","item","openStatusModal","closeStatusModal","updateOrderStatus","_a","statusData","axios","fetchOrders","error","_c","_b","onMounted","fetchCustomers","fetchProducts","response","handleSearch","editOrder","orderInfo","items","customer","product","handleOrderClick","deleteOrder","resetForm","addProduct","removeProduct","updateProduct","updateProductByProductStand","productStand","quantity","unitPrice","saveOrder","formatDateForAPI","orderData","_e","_d","cancelForm","getStatusColor","status","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_createVNode","_component_va_input","$event","_component_va_button","_unref","_hoisted_3","_component_va_alert","_hoisted_4","_hoisted_5","_hoisted_6","_Fragment","_renderList","_toDisplayString","_component_va_chip","_withModifiers","_createTextVNode","_hoisted_8","_Transition","_hoisted_9","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_component_va_select","_hoisted_15","_component_va_date_input","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","val","_hoisted_21","_hoisted_22","_component_va_icon","_hoisted_23","_hoisted_24","_hoisted_25","_component_va_modal","_hoisted_29","_hoisted_26","_hoisted_27","_hoisted_28"],"mappings":"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"}