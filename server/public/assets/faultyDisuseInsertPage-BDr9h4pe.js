import{d as b,n as i,o as w,v as d,x as c,e as v,f as g,p as D,i as o,j as u,w as f,m as V,_ as R}from"./index-KTdWOH4t.js";const S={class:"product-form"},C={class:"form-section"},U={class:"input-row"},k={class:"input-row"},x={class:"input-row"},Q={class:"form-section"},T={class:"input-row"},I={class:"input-row"},N={class:"form-buttons"},O=b({__name:"faultyDisuseInsertPage",setup(B){const p=i([]),r=i([]),e=i({faultyCode:"",occurDate:"",name:"",code:"",processStage:"",faultyType:"",faultyResult:"",faultyQuantity:"",disuseCompany:"",Representative:"",disuseReson:"",disuseState:""});w(async()=>{try{const t=await d.get("/faultyDisuses/productList");p.value=t.data.map(a=>({label:a.product_name,value:a.product_code}))}catch(t){console.error("제품명 목록 조회 실패:",t)}}),c(()=>e.value.name,async t=>{if(!t){r.value=[],e.value.code="";return}try{const a=await d.get("faultyDisuses/workOrderList",{params:{productCode:t}});r.value=a.data.map(s=>({label:s.work_order_no,value:s.work_order_no}))}catch(a){console.error("작업지시서 목록 조회 실패:",a),r.value=[],e.value.code=""}}),c(()=>e.value.code,async t=>{if(!(!e.value.name||!t))try{const s=(await d.get("/faultyDisuses/faultyInfo",{params:{productCode:e.value.name,workOrderNo:t}})).data;e.value.processStage=s.process_name||"",e.value.occurDate=s.created_at||"",e.value.faultyQuantity=s.quantity||"",e.value.faultyType=s.defect_type||""}catch(a){console.error("불량 정보 조회 실패:",a),e.value.processStage="",e.value.occurDate="",e.value.faultyQuantity="",e.value.faultyType=""}});function m(){e.value={faultyCode:"",occurDate:"",name:"",code:"",processStage:"",faultyType:"",faultyResult:"",faultyQuantity:"",disuseCompany:"",Representative:"",disuseReson:"",disuseState:""}}async function _(){if(!e.value.name||!e.value.code)return alert("제품명과 작업지시서는 필수입니다.");try{const t={product_code:e.value.name,work_order_no:e.value.code,process_name:e.value.processStage,occur_date:e.value.occurDate,defect_type:e.value.faultyType,faulty_quantity:Number(e.value.faultyQuantity),representative:e.value.Representative,disuse_reason:e.value.disuseReson,disuse_state:e.value.disuseState};await d.post("/faultyDisuses/register",t),alert("폐기정보 등록이 완료되었습니다."),m()}catch(t){console.error("등록 실패:",t),alert("등록 중 오류가 발생했습니다.")}}return(t,a)=>{const s=v("va-select"),n=v("va-input"),y=v("va-button");return g(),D("div",S,[a[14]||(a[14]=o("h3",{class:"form-title"},"불량품폐기 등록",-1)),a[15]||(a[15]=o("br",null,null,-1)),o("div",C,[a[10]||(a[10]=o("h3",{class:"form-title"},"불량이력 조회",-1)),o("div",U,[u(s,{modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.name=l),options:p.value,label:"제품명",placeholder:"제품을 선택하세요","value-by":"value","text-by":"label"},null,8,["modelValue","options"]),u(s,{modelValue:e.value.code,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.code=l),options:r.value,label:"작업지시서번호",placeholder:"작업지시서를 선택하세요","value-by":"value","text-by":"label",disabled:r.value.length===0},null,8,["modelValue","options","disabled"])]),o("div",k,[u(n,{modelValue:e.value.processStage,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.processStage=l),label:"공정단계"},null,8,["modelValue"]),u(n,{modelValue:e.value.occurDate,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.occurDate=l),label:"발생일자",type:"date"},null,8,["modelValue"])]),o("div",x,[u(n,{modelValue:e.value.faultyQuantity,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.faultyQuantity=l),label:"불량수량"},null,8,["modelValue"]),u(n,{modelValue:e.value.faultyType,"onUpdate:modelValue":a[5]||(a[5]=l=>e.value.faultyType=l),label:"불량유형"},null,8,["modelValue"])])]),o("div",Q,[a[11]||(a[11]=o("h3",{class:"form-title"},"폐기정보 등록",-1)),o("div",T,[u(n,{modelValue:e.value.faultyQuantity,"onUpdate:modelValue":a[6]||(a[6]=l=>e.value.faultyQuantity=l),label:"폐기수량"},null,8,["modelValue"]),u(n,{modelValue:e.value.Representative,"onUpdate:modelValue":a[7]||(a[7]=l=>e.value.Representative=l),label:"담당자"},null,8,["modelValue"])]),o("div",I,[u(n,{modelValue:e.value.disuseReson,"onUpdate:modelValue":a[8]||(a[8]=l=>e.value.disuseReson=l),label:"폐기사유"},null,8,["modelValue"]),u(n,{modelValue:e.value.disuseState,"onUpdate:modelValue":a[9]||(a[9]=l=>e.value.disuseState=l),label:"처리상태"},null,8,["modelValue"])])]),o("div",N,[u(y,{onClick:_,color:"primary"},{default:f(()=>a[12]||(a[12]=[V("등록")])),_:1,__:[12]}),u(y,{onClick:m,color:"seconderys"},{default:f(()=>a[13]||(a[13]=[V("초기화")])),_:1,__:[13]})])])}}}),L=R(O,[["__scopeId","data-v-9a9796dc"]]);export{L as default};
//# sourceMappingURL=faultyDisuseInsertPage-BDr9h4pe.js.map
