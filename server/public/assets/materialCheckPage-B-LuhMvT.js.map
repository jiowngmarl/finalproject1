{"version":3,"file":"materialCheckPage-B-LuhMvT.js","sources":["../../../client/src/pages/material/materialCheckPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"order-search-page\">\r\n    <!-- 출고 조회 -->\r\n    <div class=\"search-section\">\r\n      <h3 class=\"section-title\">자재 조회</h3>\r\n      <div class=\"search-form\">\r\n        <va-input v-model=\"filters.material_code\" label=\"자재코드\" />\r\n        <va-date-input v-model=\"filters.expiry_date\" label=\"유통기한\" :manual-input=\"false\" :clearable=\"true\" />\r\n        <va-input v-model=\"filters.material_name\" label=\"자재명\" />\r\n        <va-input v-model=\"filters.material_unit\" label=\"단위\" />\r\n        <va-input v-model=\"filters.material_cls\" label=\"분류\" />\r\n        <va-input v-model=\"filters.material_stand\" label=\"규격\"/>\r\n\r\n        <div class=\"button-group\">\r\n          <va-button @click=\"searchOrders\">조회</va-button>\r\n          <va-button color=\"secondary\" @click=\"resetFilters\">초기화</va-button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 발주 요청 리스트 -->\r\n    <div class=\"result-section\">\r\n      <h3 class=\"section-title\">자재 리스트</h3>\r\n      <div class=\"table-wrapper\">\r\n        <va-data-table\r\n          :items=\"materialChekck\"\r\n          :columns=\"columns\"\r\n          :per-page=\"perPage\"\r\n          :current-page.sync=\"page\"\r\n        >\r\n\r\n          <template #cell(received_date)=\"{ row }\">\r\n            {{ formatDateForView(row.source.received_date) }}\r\n          </template>\r\n\r\n          <template #cell(expiry_date)=\"{ row }\">\r\n            {{ formatDateForView(row.source.expiry_date) }}\r\n          </template>\r\n        </va-data-table>\r\n\r\n        <va-pagination\r\n          v-model=\"page\"\r\n          :pages=\"Math.max(1, Math.ceil(materialChekck.length / perPage))\"\r\n          class=\"mt-2\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport axios from 'axios'\r\nimport { ref, onMounted } from 'vue'\r\n\r\ninterface MaterialChekck {\r\n  material_code: string\r\n  material_name: string\r\n  quantity: number\r\n  material_unit: string\r\n  material_stand: string\r\n  received_date: string\r\n  expiry_date: string\r\n  material_cls: string\r\n}\r\n\r\nconst filters = ref({\r\n  material_code: '',\r\n  material_name: '',\r\n  material_unit: '',\r\n  material_cls: '',\r\n  expiry_date: null as Date | null,\r\n  material_stand: ''\r\n})\r\n\r\nconst materialChekck = ref<MaterialChekck[]>([])\r\nconst allMaterialChekck = ref<MaterialChekck[]>([])\r\nconst perPage = 5\r\n\r\nconst page = ref(1)\r\n\r\n\r\nconst formatDateForView = (date: Date | string | null | undefined): string => {\r\n  if (!date) return ''\r\n  const d = typeof date === 'string' ? new Date(date) : date\r\n  return `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()}`\r\n}\r\n\r\nconst columns = [\r\n  { key: 'material_code', label: '자재코드' },\r\n  { key: 'material_name', label: '자재명' },\r\n  { key: 'quantity', label: '재고' },\r\n  { key: 'material_unit', label: '단위' },\r\n  { key: 'material_stand', label: '규격' },\r\n  { key: 'received_date', label: '입고 일자' },\r\n  { key: 'expiry_date', label: '유통기한' },\r\n  { key: 'material_cls', label: '분류' }\r\n]\r\n\r\nconst fetchPurchase = async () => {\r\n  try {\r\n    const res = await axios.get('/materialCheck')\r\n    allMaterialChekck.value = Array.isArray(res.data) ? res.data : []\r\n    materialChekck.value = [...allMaterialChekck.value]\r\n    console.log(\"allOrders: \", res.data)\r\n    console.log(\"order: \", materialChekck.value)\r\n    \r\n  } catch (err) {\r\n    console.error('계획 조회 실패', err)\r\n    allMaterialChekck.value = []\r\n  }\r\n}\r\n\r\nfunction isSameDate(d1: Date, d2: Date): boolean {\r\n  return (\r\n    d1.getFullYear() === d2.getFullYear() &&\r\n    d1.getMonth() === d2.getMonth() &&\r\n    d1.getDate() === d2.getDate()\r\n  )\r\n}\r\n\r\n\r\nfunction searchOrders() {\r\n  const {\r\n    material_code,\r\n    material_name,\r\n    material_unit,\r\n    material_stand,\r\n    expiry_date,\r\n    material_cls,\r\n  } = filters.value\r\n\r\n  materialChekck.value = allMaterialChekck.value.filter((materialChekck) => {\r\n    const matchesMaterialCode = !material_code || materialChekck.material_code.includes(material_code)\r\n    const matchesMaterialName = !material_name || materialChekck.material_name.includes(material_name)\r\n    const matchesMaterialUnit = !material_unit || materialChekck.material_unit.includes(material_unit)\r\n    const matchesMaterialStand = !material_stand || materialChekck.material_stand.includes(material_stand)\r\n    const matchesMaterialCls = !material_cls || materialChekck.material_cls.includes(material_cls)\r\n\r\n    const matchesOutboundDate =\r\n      !expiry_date || isSameDate(new Date(materialChekck.expiry_date), new Date(expiry_date))\r\n\r\n    return (\r\n      matchesMaterialCode &&\r\n      matchesMaterialName &&\r\n      matchesMaterialUnit &&\r\n      matchesMaterialStand &&\r\n      matchesMaterialCls &&\r\n      matchesOutboundDate\r\n    )\r\n  })\r\n  page.value = 1\r\n}\r\n\r\nfunction resetFilters() {\r\n  filters.value = {\r\n    material_code: '',\r\n    material_name: '',\r\n    material_unit: '',\r\n    material_stand: '',\r\n    expiry_date: null,\r\n    material_cls: '',\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  fetchPurchase()\r\n})\r\n</script>\r\n\r\n\r\n\r\n<style scoped>\r\n.order-search-page {\r\n  padding: 20px;\r\n  max-width: 1400px;\r\n  margin: auto;\r\n}\r\n.section-title {\r\n  font-size: 1.2rem;\r\n  font-weight: bold;\r\n  margin-bottom: 15px;\r\n}\r\n.search-form {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  column-gap: 20px;\r\n  row-gap: 16px;\r\n}\r\n.button-group {\r\n  margin-top: 20px;\r\n  display: flex;\r\n  justify-content: center;\r\n  gap: 10px;\r\n}\r\n.result-section {\r\n  margin-top: 30px;\r\n  width: 100%;\r\n}\r\n.table-wrapper {\r\n  width: 100%;\r\n  overflow-x: auto; /* 필요 시만 스크롤 생김 */\r\n}\r\n.order-page {\r\n  padding: 20px;\r\n}\r\n\r\n.title {\r\n  text-align: center;\r\n  font-size: 24px;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.top-tables {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.info-table {\r\n  border-collapse: collapse;\r\n  width: 48%;\r\n  font-size: 14px;\r\n}\r\n\r\n.info-table th,\r\n.info-table td {\r\n  border: 1px solid #000;\r\n  padding: 6px;\r\n  text-align: left;\r\n}\r\n\r\n.request-text {\r\n  margin-top: 20px;\r\n  font-size: 16px;\r\n}\r\n\r\n.item-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-top: 10px;\r\n  font-size: 14px;\r\n}\r\n\r\n.item-table th,\r\n.item-table td {\r\n  border: 1px solid #000;\r\n  padding: 6px;\r\n  text-align: center;\r\n}\r\n\r\n.footer {\r\n  font-size: 13px;\r\n  margin-top: 20px;\r\n}\r\n</style>"],"names":["perPage","filters","ref","materialChekck","allMaterialChekck","page","formatDateForView","date","d","columns","fetchPurchase","res","axios","err","isSameDate","d1","d2","searchOrders","material_code","material_name","material_unit","material_stand","expiry_date","material_cls","matchesMaterialCode","matchesMaterialName","matchesMaterialUnit","matchesMaterialStand","matchesMaterialCls","matchesOutboundDate","resetFilters","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","_hoisted_3","_createVNode","_component_va_input","$event","_component_va_date_input","_hoisted_4","_component_va_button","_hoisted_5","_hoisted_6","_component_va_data_table","_withCtx","row","_createTextVNode","_toDisplayString","_component_va_pagination"],"mappings":"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"}