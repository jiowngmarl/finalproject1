{"version":3,"file":"defectManager-B7PYiofn.js","sources":["../../../client/src/pages/quality/defectManager.vue"],"sourcesContent":["<template>\n  <div class=\"defect-form\">\n    <h3 class=\"form-title\">불량항목 등록</h3>\n    <br />\n\n    <!-- 상단 입력박스 -->\n    <div class=\"form-section\">\n      <div class=\"input-row\">\n        <va-input\n          v-model=\"form.defectTypeCode\"\n          label=\"불량유형코드\"\n          class=\"quarter-width\"\n          :readonly=\"isEditMode\"\n        />\n        <va-input\n          v-model=\"form.defectTypeName\"\n          label=\"불량명\"\n          class=\"quarter-width\"\n        />\n        <va-input v-model=\"form.defectremark\" label=\"비고\" class=\"half-width\" />\n      </div>\n      <div class=\"form-buttons\">\n        <va-button @click=\"insertDefect\" color=\"primary\">등록</va-button>\n        <va-button @click=\"resetForm\" color=\"secondary\">초기화</va-button>\n        <va-button @click=\"deletDefect\" color=\"danger\">삭제</va-button>\n      </div>\n    </div>\n    <!-- 하단 데이터 리스트 -->\n    <div class=\"form-section\">\n      <table class=\"custom-table\">\n        <thead>\n          <tr>\n            <th>불량유형코드</th>\n            <th>불량명</th>\n            <th>비고</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr\n            v-for=\"(item, index) in defectList\"\n            :key=\"item.defect_type_code\"\n            @click=\"selectItem(item)\"\n          >\n            <td>{{ item.defect_type_code }}</td>\n            <td>{{ item.defect_type_name }}</td>\n            <td>{{ item.defect_type_remark }}</td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, onMounted } from \"vue\";\nimport axios from \"axios\";\n\ninterface DefectItem {\n  defect_type_code: string;\n  defect_type_name: string;\n  defect_type_remark: string;\n}\n\nconst defectList = ref<DefectItem[]>([]);\n\nconst form = ref({\n  defectTypeCode: \"\",\n  defectTypeName: \"\",\n  defectremark: \"\",\n});\n\nconst fetchDefectList = async () => {\n  try {\n    const res = await axios.get(\"/defects/list\");\n    console.log(\"응답데이터 : \", res.data);\n    defectList.value = res.data;\n  } catch (err) {\n    console.error(\"검사항목 조회 실패 : \", err);\n  }\n};\n\nconst isEditMode = ref(false);\n\nfunction selectItem(item: any) {\n  form.value = {\n    defectTypeCode: item.defect_type_code,\n    defectTypeName: item.defect_type_name,\n    defectremark: item.defect_type_remark,\n  };\n  isEditMode.value = true; // 등록된 데이터를 클릭하고 초기화를 눌렀을 때 :readonly=\"isEditMode\"에서 isEditMode가 true가 되면서 readonly 작동\n}\n\nconst insertDefect = async () => {\n  const newDefect = {\n    defect_type_code: form.value.defectTypeCode,\n    defect_type_name: form.value.defectTypeName,\n    defect_type_remark: form.value.defectremark,\n  };\n\n  try {\n    if (isEditMode.value) {\n      // input박스에 값이 들어가있은 경우에 true로 지정되면 이를 통해 등록이 아닌 수정인 경우로 분류하기 위한 if 조건문\n      const res = await axios.post(\"/defects/update\", newDefect);\n      if (res.data.success) {\n        alert(\"수정성공\");\n      } else {\n        alert(\"수정실패\");\n      }\n    } else {\n      // isEditMode.value의 값이 1이 아닌 경우, input박스에는 값이 없으므로 등록 조건문을 사용\n      const res = await axios.post(\"/defects/insert\", newDefect);\n      if (res.data.success) {\n        alert(\"등록 성공\");\n        defectList.value.push({ ...newDefect }); // 수정은 기존의 데이터에 변경된 내용만 입력하면 되기때문에 이부분이 없음\n      }\n    }\n\n    await fetchDefectList();\n    resetForm();\n  } catch (err: any) {\n    if (axios.isAxiosError(err)) {\n      // axiosError로 타입의 범위를 좁힌다\n      const message = err.response?.data?.message;\n      if (message === \"중복\") {\n        // router에 중복err로 등록된 message가 '중복'이기 때문에 같으면 아래 조건을 실행\n        alert(\"이미 존재하는 불량항목코드입니다\");\n      } else {\n        alert(\"등록 중 오류 발생: \" + (message || err.message));\n      }\n    } else {\n      alert(\"오류 발생\"); // 지정하지 않은 나머지 오류에 대한 alert창\n    }\n  }\n};\n\nfunction resetForm() {\n  form.value = {\n    defectTypeCode: \"\",\n    defectTypeName: \"\",\n    defectremark: \"\",\n  };\n  isEditMode.value = false; // false로 지정해야 초기화했을때 불량유형코드 readonly 작동이 풀린다\n}\n\nfunction deletDefect() {\n  alert(\"기능 미구현\");\n}\n\nonMounted(() => {\n  fetchDefectList();\n});\n</script>\n\n<style scoped>\n.defect-form {\n  background-color: transparent;\n  border-radius: 0.5rem;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);\n  padding: 1rem;\n}\n\n.form-title {\n  font-size: 1.125rem;\n  font-weight: 1000;\n  width: 200px;\n  margin-bottom: 1rem;\n}\n\n.form-section {\n  border: 1px solid #ccc; /* 테두리는 유지 */\n  border-radius: 0.5rem;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  background-color: white; /* 배경을 흰색으로 바꿈 */\n}\n\n.input-row {\n  display: flex;\n  gap: 1rem;\n  margin-bottom: 0.5rem;\n}\n\n.va-input {\n  margin-bottom: 0.5rem;\n}\n\n.quarter-width {\n  flex: 1;\n}\n\n.half-width {\n  flex: 2;\n  width: 50%;\n}\n\n.form-buttons {\n  display: flex;\n  justify-content: flex-end;\n  gap: 0.5rem;\n  margin-top: 0.5rem;\n}\n\n.custom-table {\n  width: 100%;\n  border-collapse: collapse;\n  border-radius: 0.5rem;\n  overflow: hidden;\n  background-color: transparent;\n}\n\n.custom-table th,\n.custom-table td {\n  padding: 0.75rem;\n  border-bottom: 1px solid #e0e0e0;\n  text-align: center;\n  background-color: transparent;\n}\n\n.custom-table th {\n  font-weight: bold;\n}\n</style>\n"],"names":["defectList","ref","form","fetchDefectList","res","axios","err","isEditMode","selectItem","item","insertDefect","newDefect","resetForm","message","_b","_a","deletDefect","onMounted","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_va_input","$event","_hoisted_4","_component_va_button","_hoisted_5","_hoisted_6","_Fragment","_renderList","index","_toDisplayString"],"mappings":"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"}