import{d as j,n as f,r as W,c as L,o as Y,p as b,i as s,t as v,q as E,s as C,v as N,h as m,_ as X}from"./index-fxpmRMrw.js";const z={class:"dashboard-container"},K={key:0,class:"loading-container"},U={key:1,class:"error-container"},G={class:"error-message"},J={key:2,class:"dashboard-content"},Q={class:"stats-section"},Z={class:"stats-grid"},ss={class:"stat-card"},ts={class:"stat-info"},es={class:"stat-value"},ls={class:"stat-card"},os={class:"stat-info"},as={class:"stat-value"},is={class:"stat-card"},ns={class:"stat-info"},rs={class:"stat-value"},cs={class:"stat-card"},ds={class:"stat-info"},hs={class:"stat-value"},us={class:"charts-section"},vs={class:"chart-row"},ps={class:"chart-card"},fs={class:"chart-container"},gs={key:0,class:"no-data"},_s={class:"chart-card"},ys={class:"chart-container"},bs={key:0,class:"no-data"},ms={class:"chart-row"},ws={class:"chart-card"},xs={class:"chart-container"},Cs={key:0,class:"no-data"},Ds={class:"chart-card"},ks={class:"process-status"},Ss={class:"process-item"},qs={class:"process-bar"},Rs={class:"process-value"},Ts={class:"process-item"},Ps={class:"process-bar"},$s={class:"process-value"},As={class:"process-item"},Es={class:"process-bar"},Ms={class:"process-value"},Is={class:"process-item"},Vs={class:"process-bar"},Ws={class:"process-value"},Bs={class:"process-item"},Fs={class:"process-bar"},Hs={class:"process-value"},Os=j({__name:"Dashboard",setup(js){const R=f(),T=f(),P=f(),D=f(!0),p=f(null),M=f(new Date),w=W({totalOrders:0,equipmentEfficiency:0,avgDeliveryDays:0,qualityPassRate:0}),k=f([]),S=f([]),q=f([]),d=W({material:0,production:0,quality:0,packaging:0,shipping:0});L(()=>M.value.toLocaleString("ko-KR"));const I=async()=>{try{D.value=!0,p.value=null,console.log("대시보드 데이터 요청 시작 (공개 접근)...");const t=(await N.get("/dashboard/summary",{headers:{"Content-Type":"application/json"},timeout:1e4,withCredentials:!1})).data;console.log("받은 데이터 (공개):",t),Object.assign(w,t.stats),k.value=t.productionData||[],S.value=t.equipmentData||[],q.value=t.productRatios||[],Object.assign(d,t.processStatus),M.value=new Date,console.log("대시보드 데이터 로드 완료 (공개 접근)")}catch(e){console.error("대시보드 데이터 로드 실패:",e),e.response?(console.error("에러 상세 정보:"),console.error("- 상태 코드:",e.response.status),console.error("- 상태 텍스트:",e.response.statusText),console.error("- 응답 데이터:",e.response.data),e.response.status===401?p.value="대시보드 접근이 차단되었습니다. 서버 설정을 확인해주세요.":e.response.status===404?p.value="대시보드 API를 찾을 수 없습니다.":p.value=`서버 오류가 발생했습니다. (${e.response.status})`):e.request?(console.error("- 네트워크 오류:",e.request),p.value="서버에 연결할 수 없습니다. 네트워크를 확인해주세요."):(console.error("- 설정 오류:",e.message),p.value=`요청 설정 오류: ${e.message}`)}finally{D.value=!1}},B=(e,t,o)=>{const l=e.getContext("2d");if(!l||t.length===0)return;l.clearRect(0,0,e.width,e.height);const r=50,g=e.width-r*2,y=e.height-r*2;l.fillStyle="#fafafa",l.fillRect(0,0,e.width,e.height),l.strokeStyle="#e0e0e0",l.lineWidth=1;for(let a=0;a<=5;a++){const c=r+y/5*a;l.beginPath(),l.moveTo(r,c),l.lineTo(e.width-r,c),l.stroke()}const _=Math.max(...t.map(a=>a.value)),h=Math.min(...t.map(a=>a.value)),u=_-h||1;l.strokeStyle="#4ECDC4",l.lineWidth=3,l.beginPath(),t.forEach((a,c)=>{const i=r+g/(t.length-1)*c,n=r+y-(a.value-h)/u*y;c===0?l.moveTo(i,n):l.lineTo(i,n),l.fillStyle="#4ECDC4",l.beginPath(),l.arc(i,n,5,0,Math.PI*2),l.fill(),l.fillStyle="#333",l.font="12px Arial",l.textAlign="center",l.fillText(a.value.toLocaleString(),i,n-10),l.fillText(`${a.month}월`,i,e.height-10)}),l.stroke()},F=(e,t)=>{const o=e.getContext("2d");if(!o||t.length===0)return;o.clearRect(0,0,e.width,e.height);const l=50,r=e.width-l*2,g=e.height-l*2;o.fillStyle="#fafafa",o.fillRect(0,0,e.width,e.height);const y=Math.max(...t.map(u=>u.efficiency||u),100),_=r/t.length*.6,h=r/t.length*.4;t.forEach((u,a)=>{const c=u.efficiency||u,i=u.month||a+1,n=c/y*g,x=l+a*(_+h)+h/2,$=l+g-n;o.fillStyle=c>=90?"#4CAF50":c>=70?"#FF9800":"#F44336",o.fillRect(x,$,_,n),o.fillStyle="#333",o.font="12px Arial",o.textAlign="center",o.fillText(`${c}%`,x+_/2,$-5),o.fillText(`${i}월`,x+_/2,e.height-10)})},H=(e,t)=>{const o=e.getContext("2d");if(!o||t.length===0)return;o.clearRect(0,0,e.width,e.height);const l=e.width/2,r=e.height/2-30,g=Math.min(l,r)-60,y=g*.6,_=t.reduce((i,n)=>i+n.value,0);let h=-Math.PI/2;t.forEach(i=>{const n=i.value/_*2*Math.PI;o.beginPath(),o.arc(l,r,g,h,h+n),o.arc(l,r,y,h+n,h,!0),o.closePath(),o.fillStyle=i.color,o.fill(),h+=n});const u=r+g+20,a=18,c=2;t.forEach((i,n)=>{const x=Math.floor(n/c),V=20+n%c*180,A=u+x*a;A+a<e.height&&(o.fillStyle=i.color,o.fillRect(V,A,12,12),o.fillStyle="#333",o.font="11px Arial",o.fillText(`${i.name} (${i.value}%)`,V+18,A+9))})};Y(async()=>{console.log("Dashboard 컴포넌트 마운트"),await I(),!D.value&&!p.value&&setTimeout(()=>{O()},100)});const O=()=>{console.log("차트 렌더링 시작"),R.value&&k.value.length>0&&B(R.value,k.value),T.value&&S.value.length>0&&F(T.value,S.value),P.value&&q.value.length>0&&H(P.value,q.value),console.log("차트 렌더링 완료")};return(e,t)=>(m(),b("div",z,[t[23]||(t[23]=s("h1",{class:"dashboard-title"},"제조업 통합 대시보드",-1)),D.value?(m(),b("div",K,t[0]||(t[0]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"대시보드 데이터를 불러오는 중...",-1)]))):p.value?(m(),b("div",U,[s("div",G,[t[1]||(t[1]=s("h3",null,"오류 발생",-1)),s("p",null,v(p.value),1),s("button",{onClick:I,class:"retry-button"},"다시 시도")])])):(m(),b("div",J,[s("div",Q,[s("div",Z,[s("div",ss,[s("div",ts,[t[2]||(t[2]=s("div",{class:"stat-label"},"총 주문 건수",-1)),t[3]||(t[3]=s("div",{class:"stat-sublabel"},"(이번 달)",-1)),s("div",es,v(w.totalOrders),1),t[4]||(t[4]=s("div",{class:"stat-unit"},"건",-1))])]),s("div",ls,[s("div",os,[t[5]||(t[5]=s("div",{class:"stat-label"},"설비 가동률",-1)),t[6]||(t[6]=s("div",{class:"stat-sublabel"},"(현재)",-1)),s("div",as,v(w.equipmentEfficiency),1),t[7]||(t[7]=s("div",{class:"stat-unit"},"%",-1))])]),s("div",is,[s("div",ns,[t[8]||(t[8]=s("div",{class:"stat-label"},"평균 납기일",-1)),t[9]||(t[9]=s("div",{class:"stat-sublabel"},"(이번 달)",-1)),s("div",rs,v(w.avgDeliveryDays),1),t[10]||(t[10]=s("div",{class:"stat-unit"},"일",-1))])]),s("div",cs,[s("div",ds,[t[11]||(t[11]=s("div",{class:"stat-label"},"품질 합격률",-1)),t[12]||(t[12]=s("div",{class:"stat-sublabel"},"(최근 7일)",-1)),s("div",hs,v(w.qualityPassRate),1),t[13]||(t[13]=s("div",{class:"stat-unit"},"%",-1))])])])]),s("div",us,[s("div",vs,[s("div",ps,[t[14]||(t[14]=s("div",{class:"chart-header"},[s("h3",{class:"chart-title"},"월별 생산량 추이"),s("div",{class:"chart-subtitle"},"최근 6개월")],-1)),s("div",fs,[s("canvas",{ref_key:"productionChart",ref:R,width:"400",height:"200"},null,512),k.value.length===0?(m(),b("div",gs," 생산량 데이터가 없습니다 ")):E("",!0)])]),s("div",_s,[t[15]||(t[15]=s("div",{class:"chart-header"},[s("h3",{class:"chart-title"},"설비 가동률 추이"),s("div",{class:"chart-subtitle"},"최근 6개월")],-1)),s("div",ys,[s("canvas",{ref_key:"equipmentChart",ref:T,width:"400",height:"200"},null,512),S.value.length===0?(m(),b("div",bs," 설비 가동률 데이터가 없습니다 ")):E("",!0)])])]),s("div",ms,[s("div",ws,[t[16]||(t[16]=s("div",{class:"chart-header"},[s("h3",{class:"chart-title"},"제품별 주문 비율"),s("div",{class:"chart-subtitle"},"이번 달 기준")],-1)),s("div",xs,[s("canvas",{ref_key:"productChart",ref:P,width:"400",height:"350"},null,512),q.value.length===0?(m(),b("div",Cs," 제품별 데이터가 없습니다 ")):E("",!0)])]),s("div",Ds,[t[22]||(t[22]=s("div",{class:"chart-header"},[s("h3",{class:"chart-title"},"공정별 현황"),s("div",{class:"chart-subtitle"},"최근 7일 기준")],-1)),s("div",ks,[s("div",Ss,[t[17]||(t[17]=s("div",{class:"process-label"},"자재 준비",-1)),s("div",qs,[s("div",{class:"process-fill",style:C({width:`${d.material}%`})},null,4)]),s("div",Rs,v(d.material)+"%",1)]),s("div",Ts,[t[18]||(t[18]=s("div",{class:"process-label"},"생산",-1)),s("div",Ps,[s("div",{class:"process-fill",style:C({width:`${d.production}%`})},null,4)]),s("div",$s,v(d.production)+"%",1)]),s("div",As,[t[19]||(t[19]=s("div",{class:"process-label"},"품질검사",-1)),s("div",Es,[s("div",{class:"process-fill",style:C({width:`${d.quality}%`})},null,4)]),s("div",Ms,v(d.quality)+"%",1)]),s("div",Is,[t[20]||(t[20]=s("div",{class:"process-label"},"포장",-1)),s("div",Vs,[s("div",{class:"process-fill",style:C({width:`${d.packaging}%`})},null,4)]),s("div",Ws,v(d.packaging)+"%",1)]),s("div",Bs,[t[21]||(t[21]=s("div",{class:"process-label"},"출하",-1)),s("div",Fs,[s("div",{class:"process-fill",style:C({width:`${d.shipping}%`})},null,4)]),s("div",Hs,v(d.shipping)+"%",1)])])])])])]))]))}}),Ys=X(Os,[["__scopeId","data-v-4de4d48c"]]);export{Ys as default};
//# sourceMappingURL=Dashboard-Dx86Bo3q.js.map
