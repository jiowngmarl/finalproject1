{"version":3,"file":"faultyInsertPage-CpgRSvkz.js","sources":["../../../client/src/pages/quality/faultyInsertPage.vue"],"sourcesContent":["<template>\n  <div class=\"product-page\">\n    <div class=\"product-container\">\n      <div>\n        <!-- 제품 등록 폼 -->\n        <div class=\"product-form\">\n          <h3 class=\"form-title\">불량품검사 등록</h3>\n          <va-select\n            v-model=\"form.productCode\"\n            :options=\"productOptions\"\n            label=\"제품명\"\n            class=\"quarter-width\"\n            value-by=\"value\"\n            text-by=\"label\"\n            placeholder=\"제품을 선택하세요\"\n          />\n          <va-select\n            v-model=\"form.code\"\n            :options=\"workOrderOptions\"\n            label=\"작업지시서번호\"\n            class=\"quarter-width\"\n            value-by=\"value\"\n            text-by=\"label\"\n            placeholder=\"작업지시서를 선택하세요\"\n          />\n          <va-input v-model=\"form.processStage\" label=\"공정단계\" readonly />\n          <va-select\n            v-model=\"form.faultyType\"\n            :options=\"defectTypeOptions\"\n            label=\"불량유형\"\n            class=\"quarter-width\"\n            value-by=\"value\"\n            text-by=\"label\"\n            placeholder=\"불량유형 선택하세요\"\n          />\n\n          <!-- 불량상세 자동입력 -->\n          <va-input v-model=\"form.faultyDetail\" label=\"불량상세\" readonly />\n          <va-input v-model=\"form.faultyQuantity\" label=\"불량수량\" readonly />\n          <va-input\n            v-model=\"form.occurDate\"\n            label=\"불합판정일자\"\n            type=\"date\"\n            readonly\n          />\n          <va-input v-model=\"form.detail\" label=\"상세설명\" readonly />\n\n          <div class=\"form-buttons\">\n            <va-button @click=\"registerProduct\" color=\"primary\">등록</va-button>\n            <va-button @click=\"resetForm\" color=\"secondary\">초기화</va-button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, onMounted, watch } from \"vue\";\nimport axios from \"axios\";\n\nconst form = ref({\n  productCode: \"\",\n  code: \"\",\n  processStage: \"\",\n  faultyType: \"\",\n  faultyDetail: \"\",\n  faultyQuantity: \"\",\n  occurDate: \"\",\n  detail: \"\",\n});\n\nconst productOptions = ref<{ label: string; value: string }[]>([]);\nconst workOrderOptions = ref<{ label: string; value: string }[]>([]);\n\nconst resetForm = () => {\n  form.value = {\n    productCode: \"\",\n    code: \"\",\n    processStage: \"\",\n    faultyType: \"\",\n    faultyDetail: \"\",\n    faultyQuantity: \"\",\n    occurDate: \"\",\n    detail: \"\",\n  };\n  workOrderOptions.value = []; // 제품명 변경 시 작업지시서도 초기화\n};\n\n// 제품명 목록 불러오기\nonMounted(async () => {\n  try {\n    const res = await axios.get(\"/faultys/productList\");\n    productOptions.value = res.data.map((item: any) => ({\n      label: item.product_name,\n      value: item.product_code,\n    }));\n  } catch (err) {\n    console.error(\"제품명 목록 조회 실패:\", err);\n  }\n});\n\n// ✅ 제품명이 선택되었을 때 작업지시서 목록 가져오기\nwatch(\n  () => form.value.productCode,\n  async (newCode) => {\n    if (!newCode) return;\n    try {\n      const res = await axios.get(\"/faultys/faultyOrderNoList\", {\n        params: { productCode: newCode },\n      });\n      workOrderOptions.value = res.data.map((item: any) => ({\n        label: item.work_order_no,\n        value: item.work_order_no,\n      }));\n    } catch (err) {\n      console.error(\"작업지시서 번호 조회 실패:\", err);\n    }\n  },\n);\n\nwatch(\n  () => form.value.code,\n  async (newCode) => {\n    if (!newCode) return;\n\n    try {\n      const res = await axios.get(\"/faultys/faultyDetail\", {\n        params: { workOrderNo: newCode },\n      });\n\n      if (res.data.length > 0) {\n        const detail = res.data[0];\n        form.value.processStage = detail.process_name || \"\";\n        form.value.faultyQuantity = detail.insp_value_qty || \"\";\n        form.value.occurDate = detail.created_at || \"\";\n        form.value.detail = detail.qual_remark || \"\";\n      }\n    } catch (err) {\n      console.error(\"불량 상세 정보 조회 실패:\", err);\n    }\n  },\n);\n\nconst defectTypeOptions = ref<\n  { label: string; value: string; remark: string }[]\n>([]);\n\nonMounted(async () => {\n  try {\n    const res = await axios.get(\"/faultys/defectTypeList\");\n    defectTypeOptions.value = res.data.map((item: any) => ({\n      label: item.defect_type_name,\n      value: item.defect_type_name,\n      remark: item.defect_type_remark,\n    }));\n  } catch (err) {\n    console.error(\"불량유형 목록 조회 실패:\", err);\n  }\n});\n\nwatch(\n  () => form.value.faultyType,\n  (selectedType) => {\n    const match = defectTypeOptions.value.find(\n      (item) => item.value === selectedType,\n    );\n    form.value.faultyDetail = match ? match.remark : \"\";\n  },\n);\n\nconst registerProduct = async () => {\n  try {\n    const payload = {\n      product_code: form.value.productCode,\n      work_order_no: form.value.code,\n      process_name: form.value.processStage,\n      defect_type: form.value.faultyType,\n      defect_detail: form.value.faultyDetail,\n      quantity: Number(form.value.faultyQuantity),\n      occur_date: form.value.occurDate,\n      qual_remark: form.value.detail,\n    };\n\n    const res = await axios.post(\"/faultys/register\", payload);\n\n    if (res.status === 200) {\n      alert(\"불량품검사 등록 성공\");\n      resetForm();\n    } else {\n      alert(\"등록 실패\");\n    }\n  } catch (err) {\n    console.error(\"등록 오류:\", err);\n    alert(\"등록 중 오류가 발생했습니다.\");\n  }\n};\n</script>\n\n<style scoped>\n.product-page {\n  padding: 1.5rem;\n  display: flex;\n  justify-content: center;\n  height: 739px;\n}\n\n.product-container {\n  width: 1060px;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.product-form {\n  background-color: white;\n  border-radius: 0.5rem;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);\n  padding: 1rem;\n}\n\n.form-title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.va-input {\n  margin-bottom: 0.5rem;\n}\n\n.form-buttons {\n  display: flex;\n  justify-content: flex-end; /* 오른쪽 정렬 */\n  gap: 0.5rem;\n  margin-top: 0.5rem;\n}\n\n.judgment-radio-group {\n  display: flex;\n  justify-content: center; /* 가운데 정렬 */\n  margin-bottom: 0.5rem;\n}\n</style>\n"],"names":["form","ref","productOptions","workOrderOptions","resetForm","onMounted","res","axios","item","err","watch","newCode","detail","defectTypeOptions","selectedType","match","registerProduct","payload","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","_createVNode","_component_va_select","$event","_component_va_input","_hoisted_4","_component_va_button"],"mappings":"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"}