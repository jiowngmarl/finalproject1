import{_ as re,n as r,c as de,I as ce,o as ve,v as pe,p as n,J as me,i as e,z as N,t as l,q as v,m as U,h as F,D as z,H as Z,E as _e,F as ke,y as ge,a as fe,A as be,f as i}from"./index-BJgCI8mH.js";const ye={class:"package-line-container"},we={key:0,class:"package-type-selection"},Ne={class:"header-section"},Re={class:"package-type-cards"},Te={key:0,class:"completion-badge"},Ee={class:"completion-time"},Ie={key:0,class:"completion-badge"},Ce={class:"completion-time"},Ue={key:2,class:"selection-button disabled",disabled:""},Oe={key:0,class:"completion-summary"},qe={class:"completed-items"},Se={key:0,class:"completed-item"},xe={class:"item-content"},Le={class:"item-work"},Pe={class:"time"},he={key:1,class:"completed-item"},Me={class:"item-content"},De={class:"item-work"},$e={class:"time"},We={key:0,class:"all-complete-section"},Ae={class:"complete-summary-info"},Be={key:1,class:"line-selection"},Ve={class:"breadcrumb"},Fe={class:"breadcrumb-item active"},ze={class:"header-section"},je={class:"workflow-progress"},He={key:0,class:"next-step-guide"},Je={class:"guide-content"},Ke={class:"guide-details"},Ge={class:"filter-section"},Qe={class:"filter-row"},Xe={class:"filter-group"},Ye={class:"filter-group"},Ze={class:"filter-group"},es={key:0,class:"loading-state"},ss={key:1,class:"error-state"},ts={key:2,class:"empty-state"},ls={key:3,class:"lines-grid"},os={class:"line-header"},as={class:"line-name"},ns={key:0,class:"recommended-badge"},is={class:"line-status"},us={class:"line-details"},rs={class:"detail-row"},ds={class:"value"},cs={class:"detail-row"},vs={class:"value"},ps={class:"detail-row"},ms={class:"value"},_s={class:"detail-row"},ks={class:"value"},gs={class:"detail-row"},fs={class:"value"},bs={key:0,class:"detail-row"},ys={class:"value"},ws={class:"line-actions"},Ns=["onClick"],Rs=["onClick"],Ts={key:2,disabled:"",class:"action-btn stopped"},Es={key:3,disabled:"",class:"action-btn stopped"},Is={class:"modal-header"},Cs={class:"modal-body"},Us={class:"line-info"},Os={key:0,class:"workflow-info"},qs={class:"workflow-step completed"},Ss={class:"step-details"},xs={class:"step-meta"},Ls={class:"workflow-step current"},Ps={class:"step-details"},hs={class:"step-meta"},Ms={class:"confirmation-text"},Ds={class:"modal-actions"},$s=Object.assign({name:"PackageLineSelection"},{__name:"PackageLine",setup(Ws,{expose:ee}){const O=fe(),d=be(),k=r("package-type-selection"),u=r(null),a=r([]),p=r(null),T=r(null),g=r(""),x=r(""),E=r(!1),D=r(""),$=r("success"),j=r(null),m=r(""),f=r(""),b=r(""),L=r([]),W=r(!1),q=r(""),A=r(!1),c=r(null),H=de(()=>{let t=L.value||[];if(m.value&&(t=t.filter(s=>s.line_type===m.value)),f.value&&(t=t.filter(s=>s.line_state===f.value)),b.value){const s=b.value.toLowerCase();t=t.filter(_=>{var y,w,R;return((y=_.line_name)==null?void 0:y.toLowerCase().includes(s))||((w=_.eq_name)==null?void 0:w.toLowerCase().includes(s))||((R=_.line_id)==null?void 0:R.toString().includes(s))})}return t});ce(()=>{if(console.log("포장 라인 페이지 로드"),console.log("URL 파라미터:",d.query),d.query.inner_completed==="true"||d.query.completed_inner==="true"){console.log("내포장 완료 → 외포장 자동 활성화"),a.value=["INNER"],p.value=new Date,g.value=d.query.prev_work||d.query.completed_work||"내포장완료",u.value="OUTER",k.value="line-selection",m.value="OUTER",d.query.message&&(E.value=!0,D.value=d.query.message,$.value="success",setTimeout(()=>{E.value=!1},5e3)),setTimeout(()=>O.replace({query:{}}),100);return}if(d.query.outer_completed==="true"){console.log("외포장 완료 → 전체 완료"),a.value=["INNER","OUTER"],p.value=new Date(Date.now()-36e5),T.value=new Date,g.value=d.query.prev_inner_work||"내포장완료",x.value=d.query.prev_work||d.query.completed_work||"외포장완료",k.value="package-type-selection",u.value=null,E.value=!0,D.value="모든 포장 작업이 완료되었습니다!",$.value="success",setTimeout(()=>{E.value=!1},8e3),setTimeout(()=>O.replace({query:{}}),100);return}if(d.query.from_work==="true"){const t=d.query.maintain_type;console.log(`${t} 작업에서 돌아옴`),u.value=t,k.value="line-selection",m.value=t,t==="OUTER"&&(a.value=["INNER"],p.value=new Date(Date.now()-18e5),g.value=d.query.prev_work||"내포장완료"),setTimeout(()=>O.replace({query:{}}),100);return}console.log("일반 진입 - 처음부터 시작"),k.value="package-type-selection",u.value=null,a.value=[]}),ve(()=>{console.log("컴포넌트 마운트 - 라인 목록 로드 시작"),J()});async function J(){W.value=!0,q.value="";try{const t=await pe.get("/lines/list");t.data&&t.data.success&&Array.isArray(t.data.data)?(L.value=t.data.data,console.log("라인 목록 로드 완료:",t.data.data.length,"개")):(L.value=[],q.value="데이터 형식이 올바르지 않습니다")}catch(t){console.error("라인 목록 로드 실패:",t),q.value="라인 목록을 불러오지 못했습니다.",L.value=[]}finally{W.value=!1}}function S(t){if(console.log("포장 타입 선택:",t),console.log("현재 완료된 단계:",a.value),t==="OUTER"&&!a.value.includes("INNER")){alert("내포장 작업을 먼저 완료해주세요.");return}u.value=t,k.value="line-selection",m.value=t,f.value="",b.value="",console.log(`${t==="INNER"?"내포장":"외포장"} 라인 선택 화면으로 이동`)}function B(){k.value="package-type-selection",u.value=null,m.value="",f.value="",b.value=""}function V(){console.log("포장 라인 관리로 이동");try{O.push({name:"package_add_line"})}catch(t){console.warn("라우터를 통한 이동 실패:",t),window.location.href="/faq/package_add_line"}}function K(){confirm("모든 작업 내역이 초기화됩니다. 정말 새 작업을 시작하시겠습니까?")&&(k.value="package-type-selection",u.value=null,a.value=[],p.value=null,T.value=null,g.value="",x.value="",E.value=!1,m.value="",f.value="",b.value="",console.log("모든 단계 초기화 완료"))}function G(){k.value==="line-selection"&&u.value?m.value=u.value:m.value="",f.value="",b.value=""}function P(t){return u.value==="OUTER"&&a.value.includes("INNER")?t.line_state==="s2"&&t.line_type==="OUTER"&&(t.line_name.includes("A")||t.line_name.includes("1")):!1}function se(t){c.value=t,A.value=!0}function te(t){Q(t)}async function le(){if(c.value)try{console.log("작업 시작:",c.value),Q(c.value)}catch(t){console.error("작업 시작 중 오류:",t),alert("작업 시작 중 오류가 발생했습니다.")}finally{h()}}function Q(t){var _,y,w;console.log("작업 페이지로 이동:",t);const s={line_id:t.line_id,line_name:t.line_name,line_type:t.line_type,work_no:t.curr_work_no||"",return_to:"package_line",current_package_type:u.value,employee_id:((_=j.value)==null?void 0:_.employee_id)||"",employee_name:((y=j.value)==null?void 0:y.employee_name)||""};u.value==="OUTER"&&a.value.includes("INNER")?(s.workflow_step="OUTER",s.inner_completed="true",s.inner_work_no=g.value,s.inner_completion_time=(w=p.value)==null?void 0:w.toISOString(),s.auto_start_guide="true"):u.value==="INNER"&&(s.workflow_step="INNER",s.next_step="OUTER");try{O.push({name:"package_work",query:s}),console.log("작업 페이지로 이동 성공")}catch(R){console.error("라우터 이동 실패:",R);const M=new URLSearchParams(s);window.location.href=`/packaging/work?${M.toString()}`}}function h(){A.value=!1,c.value=null}function oe(){return u.value==="OUTER"&&a.value.includes("INNER")?"외포장 작업 시작 확인":"작업 시작 확인"}function ae(){return u.value==="OUTER"&&a.value.includes("INNER")?"외포장 작업 시작":"작업 시작"}function ne(){if(p.value&&T.value){const t=T.value.getTime()-p.value.getTime(),s=Math.floor(t/(1e3*60*60)),_=Math.floor(t%(1e3*60*60)/(1e3*60));return`${s}시간 ${_}분`}return"-"}function I(t){return t==="INNER"?"내포장":"외포장"}function ie(t){return{s1:"가동 중",s2:"가동대기 중",s3:"정지"}[t]||t}function C(t){return t?t.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"}):""}return ee({selectPackageType:S,goBackToPackageTypeSelection:B,goBackToLineAdd:V,resetAllSteps:K}),(t,s)=>{var _,y,w,R,M,X,Y;return i(),n("div",ye,[k.value==="package-type-selection"?(i(),n("div",we,[s[20]||(s[20]=me('<nav class="breadcrumb" data-v-d0f5b2ca><span class="breadcrumb-item" data-v-d0f5b2ca>홈</span><span class="breadcrumb-separator" data-v-d0f5b2ca>/</span><span class="breadcrumb-item" data-v-d0f5b2ca>포장</span><span class="breadcrumb-separator" data-v-d0f5b2ca>/</span><span class="breadcrumb-item active" data-v-d0f5b2ca>포장 직접 수행</span></nav>',1)),e("div",Ne,[s[8]||(s[8]=e("h1",null,"포장 라인 선택",-1)),s[9]||(s[9]=e("p",null,"작업할 포장 유형을 선택해주세요",-1)),E.value?(i(),n("div",{key:0,class:N(["completion-alert",$.value])},l(D.value),3)):v("",!0)]),e("div",Re,[e("div",{class:N(["package-type-card",{completed:a.value.includes("INNER")}]),onClick:s[1]||(s[1]=o=>S("INNER"))},[s[11]||(s[11]=e("h3",null,"내포장",-1)),s[12]||(s[12]=e("p",null,"정제를 PTP/병에 포장하는 작업",-1)),a.value.includes("INNER")?(i(),n("div",Te,[s[10]||(s[10]=U(" 작업완료 ")),e("div",Ee,l(C(p.value)),1)])):(i(),n("button",{key:1,class:"selection-button available",onClick:s[0]||(s[0]=F(o=>S("INNER"),["stop"]))}," 선택 가능 "))],2),e("div",{class:N(["package-type-card",{completed:a.value.includes("OUTER"),disabled:!a.value.includes("INNER"),highlighted:a.value.includes("INNER")&&!a.value.includes("OUTER")}]),onClick:s[3]||(s[3]=o=>S("OUTER"))},[s[14]||(s[14]=e("h3",null,"외포장",-1)),s[15]||(s[15]=e("p",null,"내포장된 제품을 박스에 포장하는 작업",-1)),a.value.includes("OUTER")?(i(),n("div",Ie,[s[13]||(s[13]=U(" 작업완료 ")),e("div",Ce,l(C(T.value)),1)])):a.value.includes("INNER")?(i(),n("button",{key:1,class:"selection-button available highlighted",onClick:s[2]||(s[2]=F(o=>S("OUTER"),["stop"]))}," 선택 가능 ")):(i(),n("button",Ue," 내포장 완료 후 선택 가능 "))],2)]),e("div",{class:"navigation-actions"},[e("button",{class:"back-btn secondary",onClick:V}," 라인 관리로 이동 ")]),a.value.length>0?(i(),n("div",Oe,[s[19]||(s[19]=e("h4",null,"완료된 작업",-1)),e("div",qe,[a.value.includes("INNER")?(i(),n("div",Se,[e("div",xe,[s[16]||(s[16]=e("span",{class:"item-title"},"내포장 완료",-1)),e("span",Le,"작업번호: "+l(g.value||"작업번호없음"),1)]),e("span",Pe,l(C(p.value)),1)])):v("",!0),a.value.includes("OUTER")?(i(),n("div",he,[e("div",Me,[s[17]||(s[17]=e("span",{class:"item-title"},"외포장 완료",-1)),e("span",De,"작업번호: "+l(x.value||"작업번호없음"),1)]),e("span",$e,l(C(T.value)),1)])):v("",!0)]),a.value.includes("INNER")&&a.value.includes("OUTER")?(i(),n("div",We,[s[18]||(s[18]=e("div",{class:"all-complete-message"}," 모든 포장 작업이 완료되었습니다! ",-1)),e("div",Ae,[e("p",null,"총 작업시간: "+l(ne()),1),e("p",null," 처리된 작업: 내포장("+l(g.value)+") + 외포장("+l(x.value)+") ",1)]),e("button",{class:"reset-btn",onClick:K}," 새 작업 시작하기 ")])):v("",!0)])):v("",!0)])):v("",!0),k.value==="line-selection"?(i(),n("div",Be,[e("nav",Ve,[s[21]||(s[21]=e("span",{class:"breadcrumb-item"},"홈",-1)),s[22]||(s[22]=e("span",{class:"breadcrumb-separator"},"/",-1)),s[23]||(s[23]=e("span",{class:"breadcrumb-item"},"포장",-1)),s[24]||(s[24]=e("span",{class:"breadcrumb-separator"},"/",-1)),e("span",{class:"breadcrumb-item",style:{cursor:"pointer",color:"#3b82f6"},onClick:B}," 포장 타입 선택 "),s[25]||(s[25]=e("span",{class:"breadcrumb-separator"},"/",-1)),e("span",Fe,l(I(u.value))+" 라인 선택",1)]),e("div",ze,[e("h1",null,l(I(u.value))+" 라인 선택",1),e("p",null," 사용 가능한 "+l(I(u.value))+" 라인을 선택하여 작업을 시작하세요 ",1),e("div",je,[e("div",{class:N(["progress-step",{completed:a.value.includes("INNER"),active:u.value==="INNER"}])},s[26]||(s[26]=[e("div",{class:"step-text"},"내포장",-1)]),2),s[28]||(s[28]=e("div",{class:"progress-arrow"},"->",-1)),e("div",{class:N(["progress-step",{completed:a.value.includes("OUTER"),active:u.value==="OUTER"}])},s[27]||(s[27]=[e("div",{class:"step-text"},"외포장",-1)]),2)]),u.value==="OUTER"&&a.value.includes("INNER")?(i(),n("div",He,[e("div",Je,[s[29]||(s[29]=e("h4",null,"내포장 작업이 완료되었습니다!",-1)),s[30]||(s[30]=e("p",null,"이제 외포장 라인을 선택하여 최종 포장 작업을 진행해주세요.",-1)),e("div",Ke,[e("span",null,"완료된 내포장 작업: "+l(g.value),1),e("span",null,"완료 시간: "+l(C(p.value)),1)])])])):v("",!0)]),e("div",Ge,[e("div",Qe,[e("div",Xe,[s[32]||(s[32]=e("label",null,"라인 타입",-1)),z(e("select",{"onUpdate:modelValue":s[4]||(s[4]=o=>m.value=o),class:"filter-select"},s[31]||(s[31]=[e("option",{value:""},"전체",-1),e("option",{value:"INNER"},"내포장",-1),e("option",{value:"OUTER"},"외포장",-1)]),512),[[Z,m.value]])]),e("div",Ye,[s[34]||(s[34]=e("label",null,"라인 상태",-1)),z(e("select",{"onUpdate:modelValue":s[5]||(s[5]=o=>f.value=o),class:"filter-select"},s[33]||(s[33]=[e("option",{value:""},"전체",-1),e("option",{value:"s1"},"가동 중",-1),e("option",{value:"s2"},"가동대기 중",-1),e("option",{value:"s3"},"정지",-1)]),512),[[Z,f.value]])]),e("div",Ze,[s[35]||(s[35]=e("label",null,"검색",-1)),z(e("input",{"onUpdate:modelValue":s[6]||(s[6]=o=>b.value=o),type:"text",placeholder:"라인명으로 검색",class:"filter-input"},null,512),[[_e,b.value]])]),e("button",{class:"filter-reset-btn",onClick:G}," 필터 초기화 ")])]),W.value?(i(),n("div",es,s[36]||(s[36]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"라인 정보를 불러오는 중...",-1)]))):q.value?(i(),n("div",ss,[e("p",null,l(q.value),1),e("button",{class:"retry-btn",onClick:J},"다시 시도")])):H.value.length===0?(i(),n("div",ts,[s[37]||(s[37]=e("h3",null,"조건에 맞는 라인이 없습니다",-1)),s[38]||(s[38]=e("p",null,"필터 조건을 변경해 주세요",-1)),e("button",{class:"retry-btn",onClick:G},"필터 초기화")])):(i(),n("div",ls,[(i(!0),n(ke,null,ge(H.value,o=>(i(),n("div",{key:o.line_id,class:N(["line-card",{available:o.line_state==="s2",working:o.line_state==="s1",stopped:o.line_state==="s3",recommended:P(o)}])},[e("div",os,[e("h3",as,l(o.line_name),1),P(o)?(i(),n("div",ns," 추천 ")):v("",!0)]),e("div",is,[e("span",{class:N(["status-badge",o.line_state])},l(ie(o.line_state)),3)]),e("div",us,[e("div",rs,[s[39]||(s[39]=e("span",{class:"label"},"타입:",-1)),e("span",ds,l(I(o.line_type)),1)]),e("div",cs,[s[40]||(s[40]=e("span",{class:"label"},"라인 ID:",-1)),e("span",vs,l(o.line_id),1)]),e("div",ps,[s[41]||(s[41]=e("span",{class:"label"},"설비명:",-1)),e("span",ms,l(o.eq_name),1)]),e("div",_s,[s[42]||(s[42]=e("span",{class:"label"},"제품번호:",-1)),e("span",ks,l(o.product_code),1)]),e("div",gs,[s[43]||(s[43]=e("span",{class:"label"},"제품명:",-1)),e("span",fs,l(o.product_name),1)]),o.curr_work_no?(i(),n("div",bs,[s[44]||(s[44]=e("span",{class:"label"},"작업번호:",-1)),e("span",ys,l(o.curr_work_no),1)])):v("",!0)]),e("div",ws,[o.line_state==="s2"?(i(),n("button",{key:0,class:N(["action-btn start",{recommended:P(o)}]),onClick:ue=>se(o)},l((P(o),"작업 시작")),11,Ns)):o.line_state==="s1"?(i(),n("button",{key:1,class:"action-btn continue",onClick:ue=>te(o)}," 작업 계속 ",8,Rs)):o.line_state==="s3"?(i(),n("button",Ts," 정지 ")):(i(),n("button",Es," 알 수 없음 "))])],2))),128))])),e("div",{class:"navigation-actions"},[e("button",{class:"back-btn",onClick:B}," 포장 타입 선택으로 돌아가기 "),e("button",{class:"back-btn secondary",onClick:V}," 라인 관리로 이동 ")])])):v("",!0),A.value?(i(),n("div",{key:2,class:"modal-overlay",onClick:h},[e("div",{class:"modal-content",onClick:s[7]||(s[7]=F(()=>{},["stop"]))},[e("div",Is,[e("h3",null,l(oe()),1),e("button",{class:"modal-close",onClick:h},"닫기")]),e("div",Cs,[e("div",Us,[e("h4",null,l((_=c.value)==null?void 0:_.line_name),1),e("p",null,[s[45]||(s[45]=e("strong",null,"라인 ID:",-1)),U(" "+l((y=c.value)==null?void 0:y.line_id),1)]),e("p",null,[s[46]||(s[46]=e("strong",null,"타입:",-1)),U(" "+l(I((w=c.value)==null?void 0:w.line_type)),1)]),e("p",null,[s[47]||(s[47]=e("strong",null,"제품번호:",-1)),U(" "+l((R=c.value)==null?void 0:R.product_code),1)]),e("p",null,[s[48]||(s[48]=e("strong",null,"제품명:",-1)),U(" "+l((M=c.value)==null?void 0:M.product_name),1)])]),u.value==="OUTER"&&a.value.includes("INNER")?(i(),n("div",Os,[e("div",qs,[s[50]||(s[50]=e("span",{class:"step-status"},"완료",-1)),e("div",Ss,[s[49]||(s[49]=e("strong",null,"내포장 완료",-1)),e("div",xs," 작업번호: "+l(g.value)+" • "+l(C(p.value)),1)])]),s[52]||(s[52]=e("div",{class:"workflow-arrow"},"다음 단계",-1)),e("div",Ls,[e("div",Ps,[s[51]||(s[51]=e("strong",null,"외포장 진행",-1)),e("div",hs,l((X=c.value)==null?void 0:X.line_name),1)])])])):v("",!0),e("p",Ms," 이 라인에서 "+l(I((Y=c.value)==null?void 0:Y.line_type))+" 작업을 시작하시겠습니까? ",1)]),e("div",Ds,[e("button",{class:"btn-cancel",onClick:h},"취소"),e("button",{class:"btn-confirm",onClick:le},l(ae()),1)])])])):v("",!0)])}}}),Bs=re($s,[["__scopeId","data-v-d0f5b2ca"]]);export{Bs as default};
//# sourceMappingURL=PackageLine-CI3ZB6Iy.js.map
