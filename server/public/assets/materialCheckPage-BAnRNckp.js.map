{"version":3,"file":"materialCheckPage-BAnRNckp.js","sources":["../../../client/src/pages/material/materialCheckPage.vue"],"sourcesContent":["<template>\n  <div class=\"order-search-page\">\n    <!-- 출고 조회 -->\n    <div class=\"search-section\">\n      <h3 class=\"section-title\">자재 조회</h3>\n      <div class=\"search-form\">\n        <va-input v-model=\"filters.material_code\" label=\"자재코드\" />\n        <va-date-input\n          v-model=\"filters.expiry_date\"\n          label=\"유통기한\"\n          :manual-input=\"false\"\n          :clearable=\"true\"\n        />\n        <va-input v-model=\"filters.material_name\" label=\"자재명\" />\n        <va-input v-model=\"filters.material_unit\" label=\"단위\" />\n        <va-input v-model=\"filters.material_cls\" label=\"분류\" />\n        <va-input v-model=\"filters.material_stand\" label=\"규격\" />\n\n        <div class=\"button-group\">\n          <va-button @click=\"searchOrders\">조회</va-button>\n          <va-button color=\"secondary\" @click=\"resetFilters\">초기화</va-button>\n        </div>\n      </div>\n    </div>\n\n    <!-- 발주 요청 리스트 -->\n    <div class=\"result-section\">\n      <h3 class=\"section-title\">자재 리스트</h3>\n      <div class=\"table-wrapper\">\n        <va-data-table\n          :items=\"materialChekck\"\n          :columns=\"columns\"\n          :per-page=\"perPage\"\n          :current-page.sync=\"page\"\n        >\n          <template #cell(received_date)=\"{ row }\">\n            {{ formatDateForView(row.source.received_date) }}\n          </template>\n\n          <template #cell(expiry_date)=\"{ row }\">\n            {{ formatDateForView(row.source.expiry_date) }}\n          </template>\n        </va-data-table>\n\n        <va-pagination\n          v-model=\"page\"\n          :pages=\"Math.max(1, Math.ceil(materialChekck.length / perPage))\"\n          class=\"mt-2\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport axios from \"axios\";\nimport { ref, onMounted } from \"vue\";\n\ninterface MaterialChekck {\n  material_code: string;\n  material_name: string;\n  quantity: number;\n  material_unit: string;\n  material_stand: string;\n  received_date: string;\n  expiry_date: string;\n  material_cls: string;\n}\n\nconst filters = ref({\n  material_code: \"\",\n  material_name: \"\",\n  material_unit: \"\",\n  material_cls: \"\",\n  expiry_date: null as Date | null,\n  material_stand: \"\",\n});\n\nconst materialChekck = ref<MaterialChekck[]>([]);\nconst allMaterialChekck = ref<MaterialChekck[]>([]);\nconst perPage = 5;\n\nconst page = ref(1);\n\nconst formatDateForView = (date: Date | string | null | undefined): string => {\n  if (!date) return \"\";\n  const d = typeof date === \"string\" ? new Date(date) : date;\n  return `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()}`;\n};\n\nconst columns = [\n  { key: \"material_code\", label: \"자재코드\" },\n  { key: \"material_name\", label: \"자재명\" },\n  { key: \"quantity\", label: \"재고\" },\n  { key: \"material_unit\", label: \"단위\" },\n  { key: \"material_stand\", label: \"규격\" },\n  { key: \"received_date\", label: \"입고 일자\" },\n  { key: \"expiry_date\", label: \"유통기한\" },\n  { key: \"material_cls\", label: \"분류\" },\n];\n\nconst fetchPurchase = async () => {\n  try {\n    const res = await axios.get(\"/materialCheck\");\n    allMaterialChekck.value = Array.isArray(res.data) ? res.data : [];\n    materialChekck.value = [...allMaterialChekck.value];\n    console.log(\"allOrders: \", res.data);\n    console.log(\"order: \", materialChekck.value);\n  } catch (err) {\n    console.error(\"계획 조회 실패\", err);\n    allMaterialChekck.value = [];\n  }\n};\n\nfunction isSameDate(d1: Date, d2: Date): boolean {\n  return (\n    d1.getFullYear() === d2.getFullYear() &&\n    d1.getMonth() === d2.getMonth() &&\n    d1.getDate() === d2.getDate()\n  );\n}\n\nfunction searchOrders() {\n  const {\n    material_code,\n    material_name,\n    material_unit,\n    material_stand,\n    expiry_date,\n    material_cls,\n  } = filters.value;\n\n  materialChekck.value = allMaterialChekck.value.filter((materialChekck) => {\n    const matchesMaterialCode =\n      !material_code || materialChekck.material_code.includes(material_code);\n    const matchesMaterialName =\n      !material_name || materialChekck.material_name.includes(material_name);\n    const matchesMaterialUnit =\n      !material_unit || materialChekck.material_unit.includes(material_unit);\n    const matchesMaterialStand =\n      !material_stand || materialChekck.material_stand.includes(material_stand);\n    const matchesMaterialCls =\n      !material_cls || materialChekck.material_cls.includes(material_cls);\n\n    const matchesOutboundDate =\n      !expiry_date ||\n      isSameDate(new Date(materialChekck.expiry_date), new Date(expiry_date));\n\n    return (\n      matchesMaterialCode &&\n      matchesMaterialName &&\n      matchesMaterialUnit &&\n      matchesMaterialStand &&\n      matchesMaterialCls &&\n      matchesOutboundDate\n    );\n  });\n  page.value = 1;\n}\n\nfunction resetFilters() {\n  filters.value = {\n    material_code: \"\",\n    material_name: \"\",\n    material_unit: \"\",\n    material_stand: \"\",\n    expiry_date: null,\n    material_cls: \"\",\n  };\n}\n\nonMounted(() => {\n  fetchPurchase();\n});\n</script>\n\n<style scoped>\n.order-search-page {\n  padding: 20px;\n  max-width: 1400px;\n  margin: auto;\n}\n.section-title {\n  font-size: 1.2rem;\n  font-weight: bold;\n  margin-bottom: 15px;\n}\n.search-form {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  column-gap: 20px;\n  row-gap: 16px;\n}\n.button-group {\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n  gap: 10px;\n}\n.result-section {\n  margin-top: 30px;\n  width: 100%;\n}\n.table-wrapper {\n  width: 100%;\n  overflow-x: auto; /* 필요 시만 스크롤 생김 */\n}\n.order-page {\n  padding: 20px;\n}\n\n.title {\n  text-align: center;\n  font-size: 24px;\n  margin-bottom: 20px;\n}\n\n.top-tables {\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 20px;\n}\n\n.info-table {\n  border-collapse: collapse;\n  width: 48%;\n  font-size: 14px;\n}\n\n.info-table th,\n.info-table td {\n  border: 1px solid #000;\n  padding: 6px;\n  text-align: left;\n}\n\n.request-text {\n  margin-top: 20px;\n  font-size: 16px;\n}\n\n.item-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 10px;\n  font-size: 14px;\n}\n\n.item-table th,\n.item-table td {\n  border: 1px solid #000;\n  padding: 6px;\n  text-align: center;\n}\n\n.footer {\n  font-size: 13px;\n  margin-top: 20px;\n}\n</style>\n"],"names":["perPage","filters","ref","materialChekck","allMaterialChekck","page","formatDateForView","date","d","columns","fetchPurchase","res","axios","err","isSameDate","d1","d2","searchOrders","material_code","material_name","material_unit","material_stand","expiry_date","material_cls","matchesMaterialCode","matchesMaterialName","matchesMaterialUnit","matchesMaterialStand","matchesMaterialCls","matchesOutboundDate","resetFilters","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","_hoisted_3","_createVNode","_component_va_input","$event","_component_va_date_input","_hoisted_4","_component_va_button","_hoisted_5","_hoisted_6","_component_va_data_table","_withCtx","row","_createTextVNode","_toDisplayString","_component_va_pagination"],"mappings":"iSAgFMA,EAAU,2CAXhB,MAAMC,EAAUC,EAAI,CAClB,cAAe,GACf,cAAe,GACf,cAAe,GACf,aAAc,GACd,YAAa,KACb,eAAgB,EAAA,CACjB,EAEKC,EAAiBD,EAAsB,EAAE,EACzCE,EAAoBF,EAAsB,EAAE,EAG5CG,EAAOH,EAAI,CAAC,EAEZI,EAAqBC,GAAmD,CAC5E,GAAI,CAACA,EAAM,MAAO,GAClB,MAAMC,EAAI,OAAOD,GAAS,SAAW,IAAI,KAAKA,CAAI,EAAIA,EACtD,MAAO,GAAGC,EAAE,YAAA,CAAa,IAAIA,EAAE,SAAA,EAAa,CAAC,IAAIA,EAAE,QAAA,CAAS,EAAA,EAGxDC,EAAU,CACd,CAAE,IAAK,gBAAiB,MAAO,MAAA,EAC/B,CAAE,IAAK,gBAAiB,MAAO,KAAA,EAC/B,CAAE,IAAK,WAAY,MAAO,IAAA,EAC1B,CAAE,IAAK,gBAAiB,MAAO,IAAA,EAC/B,CAAE,IAAK,iBAAkB,MAAO,IAAA,EAChC,CAAE,IAAK,gBAAiB,MAAO,OAAA,EAC/B,CAAE,IAAK,cAAe,MAAO,MAAA,EAC7B,CAAE,IAAK,eAAgB,MAAO,IAAA,CAAK,EAG/BC,EAAgB,SAAY,CAChC,GAAI,CACF,MAAMC,EAAM,MAAMC,EAAM,IAAI,gBAAgB,EAC5CR,EAAkB,MAAQ,MAAM,QAAQO,EAAI,IAAI,EAAIA,EAAI,KAAO,CAAA,EAC/DR,EAAe,MAAQ,CAAC,GAAGC,EAAkB,KAAK,EAClD,QAAQ,IAAI,cAAeO,EAAI,IAAI,EACnC,QAAQ,IAAI,UAAWR,EAAe,KAAK,CAAA,OACpCU,EAAK,CACZ,QAAQ,MAAM,WAAYA,CAAG,EAC7BT,EAAkB,MAAQ,CAAA,CAAC,CAC7B,EAGF,SAASU,EAAWC,EAAUC,EAAmB,CAC/C,OACED,EAAG,YAAA,IAAkBC,EAAG,YAAA,GACxBD,EAAG,SAAA,IAAeC,EAAG,YACrBD,EAAG,QAAA,IAAcC,EAAG,QAAA,CAAQ,CAIhC,SAASC,GAAe,CACtB,KAAM,CACJ,cAAAC,EACA,cAAAC,EACA,cAAAC,EACA,eAAAC,EACA,YAAAC,EACA,aAAAC,CAAA,EACEtB,EAAQ,MAEZE,EAAe,MAAQC,EAAkB,MAAM,OAAQD,GAAmB,CACxE,MAAMqB,EACJ,CAACN,GAAiBf,EAAe,cAAc,SAASe,CAAa,EACjEO,EACJ,CAACN,GAAiBhB,EAAe,cAAc,SAASgB,CAAa,EACjEO,EACJ,CAACN,GAAiBjB,EAAe,cAAc,SAASiB,CAAa,EACjEO,EACJ,CAACN,GAAkBlB,EAAe,eAAe,SAASkB,CAAc,EACpEO,EACJ,CAACL,GAAgBpB,EAAe,aAAa,SAASoB,CAAY,EAE9DM,EACJ,CAACP,GACDR,EAAW,IAAI,KAAKX,EAAe,WAAW,EAAG,IAAI,KAAKmB,CAAW,CAAC,EAExE,OACEE,GACAC,GACAC,GACAC,GACAC,GACAC,CAAA,CAEH,EACDxB,EAAK,MAAQ,CAAA,CAGf,SAASyB,GAAe,CACtB7B,EAAQ,MAAQ,CACd,cAAe,GACf,cAAe,GACf,cAAe,GACf,eAAgB,GAChB,YAAa,KACb,aAAc,EAAA,CAChB,CAGF,OAAA8B,EAAU,IAAM,CACdrB,EAAA,CAAc,CACf,gHA5KC,OAAAsB,EAAA,EAAAC,EAkDM,MAlDNC,EAkDM,CAhDJC,EAoBM,MApBNC,EAoBM,CAnBJC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAF,EAAoC,KAAA,CAAhC,MAAM,eAAA,EAAgB,QAAK,EAAA,GAC/BA,EAiBM,MAjBNG,EAiBM,CAhBJC,EAAyDC,EAAA,CAAtC,WAAAvC,EAAA,MAAQ,cAAR,sBAAAoC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAI,GAAAxC,EAAA,MAAQ,cAAawC,GAAE,MAAM,MAAA,yBAChDF,EAKEG,EAAA,CAJS,WAAAzC,EAAA,MAAQ,YAAR,sBAAAoC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAI,GAAAxC,EAAA,MAAQ,YAAWwC,GAC5B,MAAM,OACL,eAAc,GACd,UAAW,EAAA,yBAEdF,EAAwDC,EAAA,CAArC,WAAAvC,EAAA,MAAQ,cAAR,sBAAAoC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAI,GAAAxC,EAAA,MAAQ,cAAawC,GAAE,MAAM,KAAA,yBAChDF,EAAuDC,EAAA,CAApC,WAAAvC,EAAA,MAAQ,cAAR,sBAAAoC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAI,GAAAxC,EAAA,MAAQ,cAAawC,GAAE,MAAM,IAAA,yBAChDF,EAAsDC,EAAA,CAAnC,WAAAvC,EAAA,MAAQ,aAAR,sBAAAoC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAI,GAAAxC,EAAA,MAAQ,aAAYwC,GAAE,MAAM,IAAA,yBAC/CF,EAAwDC,EAAA,CAArC,WAAAvC,EAAA,MAAQ,eAAR,sBAAAoC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAI,GAAAxC,EAAA,MAAQ,eAAcwC,GAAE,MAAM,IAAA,yBAEjDN,EAGM,MAHNQ,EAGM,CAFJJ,EAA+CK,EAAA,CAAnC,QAAO3B,GAAY,WAAE,IAAEoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,IAAE,CAAA,iBACnCE,EAAkEK,EAAA,CAAvD,MAAM,YAAa,QAAOd,CAAA,aAAc,IAAGO,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAH,KAAG,CAAA,uBAM5DF,EAwBM,MAxBNU,EAwBM,CAvBJR,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAF,EAAqC,KAAA,CAAjC,MAAM,eAAA,EAAgB,SAAM,EAAA,GAChCA,EAqBM,MArBNW,EAqBM,CApBJP,EAagBQ,EAAA,CAZb,MAAO5C,EAAA,MACP,QAAAM,EACA,WAAUT,EACV,eAAmBK,EAAA,KAAA,GAET,sBAAmB2C,EAC5B,CAAiD,CADjB,IAAAC,KAAG,CAChCC,EAAAC,EAAA7C,EAAkB2C,EAAI,OAAO,aAAa,CAAA,EAAA,CAAA,CAAA,GAGpC,oBAAiBD,EAC1B,CAA+C,CADjB,IAAAC,KAAG,CAC9BC,EAAAC,EAAA7C,EAAkB2C,EAAI,OAAO,WAAW,CAAA,EAAA,CAAA,CAAA,oCAI/CV,EAIEa,EAAA,YAHS/C,EAAA,2CAAAA,EAAI,MAAAoC,GACZ,MAAO,KAAK,IAAG,EAAI,KAAK,KAAKtC,EAAA,MAAe,OAASH,CAAO,CAAA,EAC7D,MAAM,MAAA"}