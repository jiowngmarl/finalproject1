import{_ as Be,b as je,v as M,n as p,c as se,x as Je,o as He,p as s,i as l,k as y,t as r,z as q,q as d,D as g,E as $,H as R,G as Ce,F as I,y as U,h as K,m as x,a as Ge,f as n}from"./index-BJgCI8mH.js";const ze={class:"package-line-management"},Ke={class:"auth-header"},Qe={key:0,class:"user-info"},We={class:"department-info"},Xe={key:1,class:"guest-info"},Ye={class:"page-header"},Ze={class:"header-content"},el={class:"header-info"},ll={key:0},tl={key:1},al={key:1,class:"permission-notice"},sl={key:2,class:"login-required-notice"},nl={class:"filter-section"},ol={class:"search-bar"},rl={class:"filter-row"},ul={class:"content-section"},il={class:"section-header"},dl={class:"header-actions"},cl=["disabled"],_l={key:0,class:"loading-state"},pl={key:1,class:"error-state"},vl={key:2,class:"empty-state"},ml={key:3,class:"table-container"},yl={class:"data-table"},gl={key:0,class:"checkbox-col"},fl={key:1},bl={key:0,class:"checkbox-col"},hl=["value"],ql={class:"line-info"},kl={class:"line-name"},wl={class:"line-id"},El={key:0,class:"status-control"},Cl=["value","onChange"],Nl={class:"capacity-info"},Rl={class:"capacity-main"},Ll={class:"capacity-sub"},Ml={class:"product-info"},Il={class:"product-code"},Ul={key:0,class:"product-name"},$l={key:1},xl={class:"action-buttons"},Tl=["onClick"],Dl={class:"modal-body"},Vl={class:"form-row"},Pl={class:"form-group"},Ol=["value"],Sl={class:"form-group"},Al=["value"],Fl={class:"form-row"},Bl={class:"form-group"},jl=["value"],Jl={class:"form-group"},Hl=["value"],Gl={key:0,class:"error-message"},zl={class:"form-row"},Kl={class:"form-group"},Ql={class:"form-group"},Wl={key:0,class:"error-message"},Xl={class:"form-row"},Yl={class:"form-group"},Zl={key:0,class:"error-message"},et={class:"form-group"},lt=["value"],tt={key:0,class:"error-message"},at={class:"form-group full-width"},st={class:"modal-actions"},nt=["disabled"],ot={class:"modal-body"},rt={class:"form-row"},ut={class:"form-group"},it=["value"],dt={key:0,class:"error-message"},ct={class:"form-group"},_t=["value"],pt={class:"form-row"},vt={class:"form-group"},mt=["value"],yt={key:0,class:"error-message"},gt={key:1,class:"warning-message"},ft={class:"form-group"},bt=["value"],ht={key:0,class:"error-message"},qt={key:1,class:"warning-message"},kt={class:"form-row"},wt={class:"form-group"},Et={key:0,class:"error-message"},Ct={class:"form-group"},Nt={key:0,class:"error-message"},Rt={class:"form-row"},Lt={class:"form-group"},Mt={key:0,class:"error-message"},It={class:"form-group"},Ut={key:0,class:"error-message"},$t={class:"form-row"},xt={class:"form-group"},Tt=["value"],Dt={key:0,class:"error-message"},Vt={class:"form-group"},Pt=["value"],Ot={key:0,class:"error-message"},St={class:"form-group full-width"},At={class:"modal-actions"},Ft=["disabled"],Bt={class:"modal-body"},jt={class:"permission-notice-modal"},Jt={key:0},Ht={class:"available-actions"},Gt={key:0},zt={key:1},Kt={key:2},Qt={key:3},Wt={key:4},Xt={key:5},Yt={key:6},Zt=Object.assign({name:"PackageLineManagement"},{__name:"PackageAddLine",setup(ea){Ge();const c=je(),Ne=()=>{const t=window.onerror;window.onerror=(e,o,i,b,a)=>(console.error("전역 에러 감지:",{message:e,source:o,lineno:i,colno:b,error:a}),e&&(e.includes("vuestic")||e.includes("selectAppTreeItem")||e.includes("Could not find item"))?(console.warn("Vuestic UI 에러 무시:",e),!0):t?t(e,o,i,b,a):!1),window.addEventListener("unhandledrejection",e=>{if(console.error("처리되지 않은 Promise 에러:",e.reason),e.reason&&e.reason.message&&(e.reason.message.includes("vuestic")||e.reason.message.includes("selectAppTreeItem")||e.reason.message.includes("Could not find item"))){console.warn("Vuestic Promise 에러 무시:",e.reason.message),e.preventDefault();return}e.preventDefault()})};M.defaults.timeout=1e4,M.defaults.headers.common["Content-Type"]="application/json";const L=p([]),Re=se(()=>L.value.length),F=p(""),B=p(""),j=p(""),J=p(!1),T=p(!1),pe=p(!1),ve=p("데이터를 불러오는 중..."),Q=p(null),me=p(!1),Le=p(null),P=p(null),H=p(""),D=p(null);p(""),p("asc");const S=p(!1),h=p([]),ne=p(!1),oe=p(!1),W=p(!1),w=p(null),X=p(""),A=p([]),V=p([]),Y=p([]),E=p([]),C=p([]),v=p({eq_name:"",line_state:"s2",max_capacity:1e3,current_speed:30,product_code:"",target_qty:0,employee_id:"",description:""}),u=p({line_code:"",product_code:"",inner_eq_name:"",outer_eq_name:"",inner_capacity:1e3,outer_capacity:800,inner_speed:30,outer_speed:30,inner_employee_id:"",outer_employee_id:"",description:""}),k=p({}),m=p({}),re=p([]),Me=se(()=>w.value?w.value.line_type==="INNER"?E.value.map(t=>t.eq_name):C.value.map(t=>t.eq_name):[]),ue=se(()=>{let t=[...L.value];if(F.value.trim()){const e=F.value.toLowerCase().trim();t=t.filter(o=>o.line_name&&o.line_name.toLowerCase().includes(e)||o.line_id&&o.line_id.toLowerCase().includes(e)||o.eq_name&&o.eq_name.toLowerCase().includes(e))}return B.value&&(t=t.filter(e=>e.line_status===B.value)),j.value&&(t=t.filter(e=>e.line_type===j.value)),t}),G=se(()=>ue.value.map(e=>(console.log("라인 데이터 확인:",{line_code:e.line_code,line_type:e.line_type,line_name:e.line_name,eq_name:e.eq_name}),{...e,line_type:e.line_type||"INNER"})));Je([h,G],()=>{G.value.length===0?S.value=!1:S.value=h.value.length===G.value.length},{deep:!0});function O(t="이 작업"){return c.isLoggedIn?c.canManageLines?!0:(X.value=c.getPermissionMessage("line_manage"),W.value=!0,!1):(X.value="로그인이 필요합니다.",W.value=!0,!1)}function ie(){W.value=!1,X.value=""}async function Ie(t,e){var b,a;if(!O("상태 변경"))return;const o=Ue(e),i=t.line_status||"알 수 없음";if(confirm(`${t.line_name}의 상태를 '${i}'에서 '${o}'로 변경하시겠습니까?`)){pe.value=!0;try{f("info",`${t.line_name} 상태를 변경하는 중...`);const _={line_state:e,line_type:t.line_type,eq_name:t.eq_name,max_capacity:t.max_capacity,current_speed:t.current_speed,product_code:t.product_code,target_qty:t.target_qty,description:t.description,employee_id:t.employee_id},N=await M.put(`/lines/${t.line_id}`,_);if(N.data.success)f("success",`${t.line_name} 상태가 '${o}'로 변경되었습니다.`),await le();else throw new Error(N.data.message||"상태 변경에 실패했습니다")}catch(_){console.error("상태 변경 실패:",_),f("error",((a=(b=_.response)==null?void 0:b.data)==null?void 0:a.message)||`상태 변경 실패: ${_.message}`),await le()}finally{pe.value=!1}}}function Ue(t){return{s1:"가동 중",s2:"가동대기 중",s3:"가동정지"}[t]||"알 수 없음"}async function $e(){var t;try{if(c.isLoggedIn&&c.user){Q.value={employee_name:c.user.employee_name,employee_id:c.user.employee_id};return}const e=await M.get("/lines/current-employee");e.data&&e.data.success?Q.value=e.data.data:Q.value={employee_name:"로그인 필요",employee_id:null}}catch(e){console.error("사용자 정보 로드 실패:",e),Q.value={employee_name:"로그인 필요",employee_id:null},((t=e.response)==null?void 0:t.status)===401?f("error","로그인이 필요합니다."):f("error","사용자 정보를 불러올 수 없습니다.")}}async function de(){try{const t=await M.get("/lines/available-products");t.data&&t.data.success?(A.value=t.data.data,console.log("제품코드 목록 로드 성공:",A.value.length,"건")):A.value=[]}catch(t){console.error("제품코드 목록 로드 실패:",t),A.value=[{product_code:"BJA-DR-10",product_name:"10정 블리스터 포장"},{product_code:"BJA-DR-30",product_name:"30정 블리스터 포장"},{product_code:"BJA-DR-60",product_name:"60정 블리스터 포장"},{product_code:"BJA-BT-100",product_name:"100정 병 포장"}]}}async function Z(){try{const t=await M.get("/lines/available-employees");t.data&&t.data.success?(V.value=t.data.data,console.log("담당자 목록 로드 성공:",V.value.length,"명")):V.value=[]}catch(t){console.error("담당자 목록 로드 실패:",t),V.value=[{employee_id:2,employee_name:"김홍인"},{employee_id:3,employee_name:"김다산"},{employee_id:4,employee_name:"최현석"},{employee_id:5,employee_name:"이승민"}]}}async function ee(){try{D.value={type:"info",message:"설비 목록을 불러오는 중..."};const t=await M.get("/lines/available-equipments");t.data&&t.data.success?(Y.value=t.data.data,console.log("🔧 서버에서 받은 전체 설비 목록:",Y.value),E.value=[],C.value=[],Y.value.forEach(e=>{var i;const o=((i=e.eq_name)==null?void 0:i.toLowerCase())||"";if(console.log(`🔍 설비 분류 중: ${e.eq_name}`),o.includes("카톤")||o.includes("박스")||o.includes("케이스")||o.includes("상자")){console.log(`📦 외포장으로 분류: ${e.eq_name} (키워드 매칭)`),C.value.push(e);return}if(o.includes("블리스터")||o.includes("모노블럭")||o.includes("병")||o.includes("캡슐")||o.includes("튜브")||o.includes("정")&&!o.includes("카톤")){console.log(`🔧 내포장으로 분류: ${e.eq_name} (키워드 매칭)`),E.value.push(e);return}e.line_type==="OUTER"||e.eq_type==="OUTER"?(console.log(`📦 외포장으로 분류: ${e.eq_name} (타입 기반)`),C.value.push(e)):(console.log(`🔧 내포장으로 분류: ${e.eq_name} (기본값)`),E.value.push(e))}),console.log("✅ 최종 내포장 설비:",E.value.map(e=>e.eq_name)),console.log("✅ 최종 외포장 설비:",C.value.map(e=>e.eq_name)),C.value.length===0&&(console.warn("⚠️ 외포장 설비가 없어서 기본 설비를 추가합니다"),Te()),E.value.length===0&&(console.warn("⚠️ 내포장 설비가 없어서 기본 설비를 추가합니다"),xe()),D.value={type:"success",message:`설비 목록 로드 완료 (내포장: ${E.value.length}개, 외포장: ${C.value.length}개)`},setTimeout(()=>{D.value=null},3e3)):(console.warn("⚠️ API 응답이 비어있어서 기본 설비를 설정합니다"),ye(),D.value={type:"warning",message:"기본 설비 목록을 사용합니다"})}catch(t){console.error("❌ 설비명 목록 로드 실패:",t),ye(),D.value={type:"error",message:"설비 목록 로드 실패 - 기본 설비 사용"}}}function ye(){console.log("🔧 기본 설비 데이터 설정 시작..."),E.value=[{eq_name:"10정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"30정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"60정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"100정 병 모노블럭",line_type:"INNER",eq_type:"INNER"}],C.value=[{eq_name:"소형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"중형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"대형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"특수 카톤포장기",line_type:"OUTER",eq_type:"OUTER"}],Y.value=[...E.value,...C.value],console.log("✅ 기본 내포장 설비:",E.value.map(t=>t.eq_name)),console.log("✅ 기본 외포장 설비:",C.value.map(t=>t.eq_name))}function xe(){E.value=[{eq_name:"10정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"30정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"60정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"100정 병 모노블럭",line_type:"INNER",eq_type:"INNER"}],console.log("📦 기본 내포장 설비 설정 완료:",E.value.map(t=>t.eq_name))}function Te(){C.value=[{eq_name:"소형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"중형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"대형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"특수 카톤포장기",line_type:"OUTER",eq_type:"OUTER"}],console.log("📦 기본 외포장 설비 설정 완료:",C.value.map(t=>t.eq_name))}function f(t,e){P.value={type:t,message:e},t==="success"&&setTimeout(()=>{P.value=null},3e3)}async function le(){var t,e;J.value=!0,ve.value="라인 목록을 불러오는 중...",H.value="";try{const o=await M.get("/lines/list");o.data&&o.data.success&&Array.isArray(o.data.data)?(L.value=o.data.data,Le.value=new Date,me.value=!0,f("success",`${L.value.length}개의 라인을 불러왔습니다`)):(L.value=[],H.value="데이터 형식이 올바르지 않습니다",f("error","데이터 형식 오류가 발생했습니다"))}catch(o){if(console.error("라인 목록 로드 실패:",o),me.value=!1,o.code==="ERR_NETWORK"){const i="API 서버에 연결할 수 없습니다. 서버가 실행 중인지 확인해주세요.";o.value=i,f("error",i)}else{const i=`라인 목록 로드 실패: ${((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||o.message}`;o.value=i,f("error",i)}L.value=[]}finally{J.value=!1}}async function ce(){try{const t=L.value.map(o=>o.line_code).filter(o=>o),e=Array.from({length:26},(o,i)=>String.fromCharCode(65+i));re.value=e.filter(o=>!t.includes(o))}catch(t){console.warn("사용 가능한 라인 ID 계산 실패:",t),re.value=["F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}}function De(){if(O("라인 수정")&&h.value.length!==0)if(h.value.length===1){const t=h.value[0],[e,o]=t.split("-"),i=L.value.find(b=>b.line_code===e&&b.line_type===o);i&&ge(i)}else alert(`${h.value.length}개의 라인이 선택되었습니다.
일괄 수정 기능은 준비 중입니다.`)}async function Ve(){if(!O("라인 삭제")||h.value.length===0)return;const e=`선택된 ${h.value.length}개의 라인을 삭제하시겠습니까?
삭제된 라인은 복구할 수 없습니다.`;if(confirm(e))try{f("info","선택된 라인들을 삭제하는 중...");const o=h.value.map(_=>M.delete(`/lines/${_}`).catch(N=>(console.error(`라인 삭제 실패 (${_}):`,N),{success:!1,error:N.message}))),i=await Promise.allSettled(o);let b=0,a=0;i.forEach((_,N)=>{var Ee;_.status==="fulfilled"&&_.value&&_.value.data&&_.value.data.success?b++:(a++,console.error(`라인 삭제 실패 (${h.value[N]}):`,_.reason||((Ee=_.value)==null?void 0:Ee.error)))});try{h.value=[],S.value=!1}catch(_){console.warn("상태 초기화 중 에러 (무시):",_)}a===0?f("success",`${b}개의 라인이 삭제되었습니다`):f("warning",`${b}개 삭제 완료, ${a}개 실패`);try{await z()}catch(_){console.warn("데이터 새로고침 중 에러 (무시):",_),setTimeout(()=>{window.location.reload()},2e3)}}catch(o){console.error("일괄 삭제 실패:",o),f("error","라인 삭제 중 오류가 발생했습니다")}}function Pe(){c.canManageLines&&(S.value?h.value=G.value.map(t=>`${t.line_code}-${t.line_type}`):h.value=[])}function Oe(){const t={};return v.value.eq_name||(t.eq_name="설비명을 선택해주세요."),(!v.value.max_capacity||v.value.max_capacity<=0)&&(t.max_capacity="최대 생산능력을 입력해주세요."),(v.value.current_speed===null||v.value.current_speed===void 0||v.value.current_speed<0)&&(t.current_speed="현재 속도를 입력해주세요."),v.value.employee_id||(t.employee_id="담당자를 선택해주세요."),k.value=t,Object.keys(t).length===0}function Se(){const t={};return u.value.line_code||(t.line_code="라인 코드를 선택해주세요."),u.value.inner_eq_name||(t.inner_eq_name="내포장 설비명을 선택해주세요."),u.value.outer_eq_name||(t.outer_eq_name="외포장 설비명을 선택해주세요."),(!u.value.inner_capacity||u.value.inner_capacity<=0)&&(t.inner_capacity="내포장 지시수량을 입력해주세요."),(!u.value.outer_capacity||u.value.outer_capacity<=0)&&(t.outer_capacity="외포장 지시수량을 입력해주세요."),(u.value.inner_speed===null||u.value.inner_speed===void 0||u.value.inner_speed<0)&&(t.inner_speed="내포장 현재 속도를 입력해주세요."),(u.value.outer_speed===null||u.value.outer_speed===void 0||u.value.outer_speed<0)&&(t.outer_speed="외포장 현재 속도를 입력해주세요."),u.value.inner_employee_id||(t.inner_employee_id="내포장 담당자를 선택해주세요."),u.value.outer_employee_id||(t.outer_employee_id="외포장 담당자를 선택해주세요."),m.value=t,Object.keys(t).length===0}function ge(t){O("라인 수정")&&(console.log("수정할 라인 정보:",t),w.value={...t,line_type:t.line_type,line_code:t.line_code},v.value={eq_name:t.eq_name||"",line_state:t.line_state||"s2",max_capacity:t.max_capacity||1e3,current_speed:t.current_speed||30,product_code:t.product_code||"",target_qty:t.target_qty||0,employee_id:t.employee_id||"",description:t.description||""},k.value={},Z(),ee(),ne.value=!0,console.log("editingLine 설정:",w.value))}async function fe(){O("라인 등록")&&(u.value={line_code:"",product_code:"",inner_eq_name:"",outer_eq_name:"",inner_capacity:1e3,outer_capacity:800,inner_speed:30,outer_speed:30,inner_employee_id:"",outer_employee_id:"",description:""},m.value={},await ce(),await Z(),await de(),await ee(),oe.value=!0)}async function z(){const t=[];try{t.push(le().catch(e=>(console.warn("라인 목록 새로고침 실패:",e),[]))),t.push(ce().catch(e=>(console.warn("라인 ID 목록 새로고침 실패:",e),[]))),t.push(de().catch(e=>(console.warn("제품 목록 새로고침 실패:",e),[]))),t.push(Z().catch(e=>(console.warn("담당자 목록 새로고침 실패:",e),[]))),t.push(ee().catch(e=>(console.warn("설비 목록 새로고침 실패:",e),[]))),await Promise.allSettled(t),console.log("데이터 새로고침 완료")}catch(e){throw console.error("데이터 새로고침 중 예외 발생:",e),e}}async function be(){try{await z()}catch(t){console.error("데이터 새로고침 실패:",t),f("error","데이터 새로고침에 실패했습니다.")}}async function he(){var t,e;if(O("라인 등록")&&Se()){T.value=!0,m.value={};try{console.log("내포장/외포장 동시 등록 API 호출"),console.log("요청 데이터:",JSON.stringify(u.value,null,2));const i=["line_code","inner_eq_name","outer_eq_name","inner_employee_id","outer_employee_id"].filter(_=>!u.value[_]);if(i.length>0)throw new Error(`필수 필드가 누락되었습니다: ${i.join(", ")}`);const b={...u.value,eq_group_code:"e3"},a=await M.post("/lines/dual",b);if(a.data.success){f("success",a.data.message||"내포장/외포장 라인이 성공적으로 등록되었습니다.");try{ae()}catch(_){console.warn("모달 닫기 중 에러 (무시):",_)}try{await z()}catch(_){console.warn("데이터 새로고침 중 에러 (무시):",_),setTimeout(()=>{window.location.reload()},2e3)}}else throw new Error(a.data.message||"동시 등록에 실패했습니다")}catch(o){console.error("동시 등록 실패:",o);let i="동시 등록에 실패했습니다";(e=(t=o.response)==null?void 0:t.data)!=null&&e.message?i=o.response.data.message:o.message&&(i=o.message),i.includes("이미 존재하는 라인")&&(i=`${u.value.line_code}라인이 이미 존재합니다. 다른 라인 코드를 선택해주세요.`),f("error",i)}finally{T.value=!1}}}async function qe(){var t,e,o;if(O("라인 수정")&&Oe()){T.value=!0,k.value={};try{console.log("수정 API 호출 정보:"),console.log("  라인 코드:",w.value.line_code),console.log("  라인 타입:",w.value.line_type);const i={line_code:w.value.line_code,line_type:w.value.line_type,eq_name:v.value.eq_name,line_state:v.value.line_state,max_capacity:v.value.max_capacity,current_speed:v.value.current_speed,product_code:v.value.product_code,target_qty:v.value.target_qty,description:v.value.description,employee_id:v.value.employee_id,employee_name:((t=V.value.find(_=>_.employee_id==v.value.employee_id))==null?void 0:t.employee_name)||""},b=`/lines/${w.value.line_code}/${w.value.line_type}`;console.log("API URL:",b);const a=await M.put(b,i);if(a.data.success){f("success",a.data.message||`${w.value.line_code}라인 ${_e(w.value.line_type)}이 성공적으로 수정되었습니다`);try{te()}catch(_){console.warn("모달 닫기 중 에러 (무시):",_)}try{await z()}catch(_){console.warn("데이터 새로고침 중 에러 (무시):",_),setTimeout(()=>{window.location.reload()},2e3)}}else throw new Error(a.data.message||"수정에 실패했습니다")}catch(i){console.error("라인 수정 실패:",i),f("error",((o=(e=i.response)==null?void 0:e.data)==null?void 0:o.message)||`라인 수정 실패: ${i.message}`)}finally{T.value=!1}}}function te(){ne.value=!1,w.value=null,k.value={},v.value={eq_name:"",line_state:"s2",max_capacity:1e3,current_speed:30,product_code:"",target_qty:0,employee_id:"",description:""}}function ae(){oe.value=!1,m.value={},u.value={line_code:"",product_code:"",inner_eq_name:"",outer_eq_name:"",inner_capacity:1e3,outer_capacity:800,inner_speed:30,outer_speed:30,inner_employee_id:"",outer_employee_id:"",description:""}}function Ae(){F.value="",B.value="",j.value=""}async function ke(){H.value="",P.value=null;try{await z()}catch(t){console.error("재연결 실패:",t),f("error","재연결에 실패했습니다.")}}function _e(t){return t==="INNER"?"내포장":"외포장"}function we(t){return{"가동 중":"working","가동대기 중":"available",가동정지:"stopped"}[t]||"available"}function Fe(t){return(t==null?void 0:t.toLocaleString())||"0"}return He(async()=>{Ne();try{console.log("컴포넌트 마운트 - 초기 데이터 로딩 시작");const t=[$e().catch(e=>console.warn("사용자 정보 로딩 실패:",e)),le().catch(e=>console.warn("라인 목록 로딩 실패:",e)),ce().catch(e=>console.warn("라인 ID 목록 로딩 실패:",e)),de().catch(e=>console.warn("제품 목록 로딩 실패:",e)),Z().catch(e=>console.warn("담당자 목록 로딩 실패:",e)),ee().catch(e=>console.warn("설비 목록 로딩 실패:",e))];await Promise.allSettled(t),console.log("초기 데이터 로딩 완료")}catch(t){console.error("초기화 중 예외 발생:",t),f("warning","일부 데이터를 불러오는데 실패했습니다. 새로고침해주세요.")}}),(t,e)=>{var o,i,b;return n(),s("div",ze,[l("div",Ke,[y(c).isLoggedIn?(n(),s("div",Qe,[l("span",null,r(((o=y(c).user)==null?void 0:o.employee_name)||"사용자")+"님",1),l("span",We,"("+r(y(c).userRole)+")",1)])):(n(),s("div",Xe,e[28]||(e[28]=[l("span",{class:"guest-text"},"조회 모드 (로그인이 필요합니다)",-1)])))]),l("div",Ye,[e[30]||(e[30]=l("div",{class:"breadcrumb"},null,-1)),l("div",Ze,[l("div",el,[e[29]||(e[29]=l("h1",null,"포장 라인 관리",-1)),y(c).canManageLines?(n(),s("p",ll," 포장 라인을 등록, 수정, 삭제할 수 있습니다. ")):(n(),s("p",tl,"포장 라인 목록을 조회할 수 있습니다."))]),y(c).canManageLines?(n(),s("button",{key:0,class:"btn-register",onClick:e[0]||(e[0]=a=>fe())}," 라인 등록 ")):y(c).isLoggedIn?(n(),s("div",al,r(y(c).getPermissionMessage("line_manage")),1)):(n(),s("div",sl," 라인 등록은 로그인 후 이용 가능합니다 "))])]),P.value?(n(),s("div",{key:0,class:q(["api-status",P.value.type])},[l("span",null,r(P.value.message),1),P.value.type==="error"?(n(),s("button",{key:0,class:"retry-btn",onClick:ke}," 재시도 ")):d("",!0)],2)):d("",!0),l("div",nl,[l("div",ol,[g(l("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>F.value=a),type:"text",placeholder:"라인명, 라인ID, 설비명으로 검색",class:"search-input"},null,512),[[$,F.value]]),l("button",{class:"search-btn",onClick:be},"검색")]),l("div",rl,[g(l("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>j.value=a),class:"filter-select"},e[31]||(e[31]=[l("option",{value:""},"전체 타입",-1),l("option",{value:"INNER"},"내포장",-1),l("option",{value:"OUTER"},"외포장",-1)]),512),[[R,j.value]]),g(l("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>B.value=a),class:"filter-select"},e[32]||(e[32]=[l("option",{value:""},"전체 상태",-1),l("option",{value:"가동 중"},"가동 중",-1),l("option",{value:"가동대기 중"},"가동대기 중",-1),l("option",{value:"가동정지"},"가동정지",-1)]),512),[[R,B.value]]),l("button",{class:"filter-reset-btn",onClick:Ae},"초기화")])]),l("div",ul,[l("div",il,[l("h3",null,"라인 목록 ("+r(ue.value.length)+"/"+r(Re.value)+")",1),l("div",dl,[l("button",{class:"btn-refresh",disabled:J.value,onClick:be}," 새로고침 ",8,cl),y(c).canManageLines&&h.value.length>0?(n(),s("button",{key:0,class:"btn-edit",onClick:De}," 선택 수정 ("+r(h.value.length)+") ",1)):d("",!0),y(c).canManageLines&&h.value.length>0?(n(),s("button",{key:1,class:"btn-delete",onClick:Ve}," 선택 삭제 ("+r(h.value.length)+") ",1)):d("",!0)])]),J.value?(n(),s("div",_l,[e[33]||(e[33]=l("div",{class:"loading-spinner"},null,-1)),l("span",null,r(ve.value),1)])):H.value?(n(),s("div",pl,[e[34]||(e[34]=l("h4",null,"데이터를 불러올 수 없습니다",-1)),l("p",null,r(H.value),1),l("button",{class:"btn-retry",onClick:ke},"다시 시도")])):ue.value.length===0&&!J.value?(n(),s("div",vl,[l("h4",null,r(L.value.length===0?"등록된 라인이 없습니다":"조건에 맞는 라인이 없습니다"),1),l("p",null,r(L.value.length===0?"새로운 라인을 등록해주세요.":"검색 조건을 변경해주세요."),1),L.value.length===0&&y(c).canManageLines?(n(),s("button",{key:0,class:"btn-register",onClick:e[4]||(e[4]=a=>fe())}," 첫 번째 라인 등록하기 ")):d("",!0)])):(n(),s("div",ml,[l("table",yl,[l("thead",null,[l("tr",null,[y(c).canManageLines?(n(),s("th",gl,[g(l("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>S.value=a),type:"checkbox",onChange:Pe},null,544),[[Ce,S.value]])])):d("",!0),e[35]||(e[35]=l("th",null,"번호",-1)),e[36]||(e[36]=l("th",null,"라인명",-1)),e[37]||(e[37]=l("th",null,"분류",-1)),e[38]||(e[38]=l("th",null,"설비명",-1)),e[39]||(e[39]=l("th",null,"상태",-1)),e[40]||(e[40]=l("th",null,"생산능력",-1)),e[41]||(e[41]=l("th",null,"담당자",-1)),e[42]||(e[42]=l("th",null,"제품코드",-1)),y(c).canManageLines?(n(),s("th",fl,"작업")):d("",!0)])]),l("tbody",null,[(n(!0),s(I,null,U(G.value,(a,_)=>(n(),s("tr",{key:`${a.line_code}-${a.line_type}`},[y(c).canManageLines?(n(),s("td",bl,[g(l("input",{"onUpdate:modelValue":e[6]||(e[6]=N=>h.value=N),type:"checkbox",value:`${a.line_code}-${a.line_type}`},null,8,hl),[[Ce,h.value]])])):d("",!0),l("td",null,r(_+1),1),l("td",null,[l("div",ql,[l("div",kl,r(a.line_name),1),l("div",wl,"ID: "+r(a.line_code),1)])]),l("td",null,[l("span",{class:q(["type-badge",a.line_type?a.line_type.toLowerCase():"inner"])},r(_e(a.line_type)),3)]),l("td",null,r(a.eq_name||"-"),1),l("td",null,[y(c).canManageLines?(n(),s("div",El,[l("select",{value:a.line_state,class:q(["status-select",we(a.line_status)]),onChange:N=>Ie(a,N.target.value)},e[43]||(e[43]=[l("option",{value:"s1"},"가동 중",-1),l("option",{value:"s2"},"가동대기 중",-1),l("option",{value:"s3"},"가동정지",-1)]),42,Cl)])):(n(),s("span",{key:1,class:q(["status-badge",we(a.line_status)])},r(a.line_status||"가동대기 중"),3))]),l("td",null,[l("div",Nl,[l("div",Rl,r(Fe(a.max_capacity))+"정 ",1),l("div",Ll," 현재: "+r(a.current_speed||0)+"정/초 ",1)])]),l("td",null,r(a.employee_name||"-"),1),l("td",null,[l("div",Ml,[l("div",Il,r(a.product_code||"-"),1),a.product_name&&a.product_name!==a.product_code?(n(),s("div",Ul,r(a.product_name),1)):d("",!0)])]),y(c).canManageLines?(n(),s("td",$l,[l("div",xl,[l("button",{class:"btn-edit-single",onClick:N=>ge(a)}," 수정 ",8,Tl)])])):d("",!0)]))),128))])])]))]),ne.value&&y(c).canManageLines?(n(),s("div",{key:1,class:"modal-overlay",onClick:te},[l("div",{class:"modal-content",onClick:e[14]||(e[14]=K(()=>{},["stop"]))},[l("div",{class:"modal-header"},[e[44]||(e[44]=l("h3",null,"라인 수정",-1)),l("button",{class:"modal-close",onClick:te},"×")]),l("div",Dl,[l("form",{class:"line-form",onSubmit:K(qe,["prevent"])},[l("div",Vl,[l("div",Pl,[e[45]||(e[45]=l("label",null,"라인 ID",-1)),l("input",{value:(i=w.value)==null?void 0:i.line_code,type:"text",disabled:""},null,8,Ol)]),l("div",Sl,[e[47]||(e[47]=l("label",null,"제품코드",-1)),g(l("select",{"onUpdate:modelValue":e[7]||(e[7]=a=>v.value.product_code=a)},[e[46]||(e[46]=l("option",{value:""},"제품코드 선택",-1)),(n(!0),s(I,null,U(A.value,a=>(n(),s("option",{key:a.product_code,value:a.product_code},r(a.product_code)+" - "+r(a.product_name),9,Al))),128))],512),[[R,v.value.product_code]])])]),l("div",Fl,[l("div",Bl,[e[48]||(e[48]=l("label",null,"라인 타입",-1)),l("input",{value:_e(((b=w.value)==null?void 0:b.line_type)||"INNER"),type:"text",disabled:""},null,8,jl)]),l("div",Jl,[e[50]||(e[50]=l("label",null,"설비명 *",-1)),g(l("select",{"onUpdate:modelValue":e[8]||(e[8]=a=>v.value.eq_name=a),class:q({error:k.value.eq_name})},[e[49]||(e[49]=l("option",{value:""},"설비 선택",-1)),(n(!0),s(I,null,U(Me.value,a=>(n(),s("option",{key:a,value:a},r(a),9,Hl))),128))],2),[[R,v.value.eq_name]]),k.value.eq_name?(n(),s("div",Gl,r(k.value.eq_name),1)):d("",!0)])]),l("div",zl,[l("div",Kl,[e[52]||(e[52]=l("label",null,"상태",-1)),g(l("select",{"onUpdate:modelValue":e[9]||(e[9]=a=>v.value.line_state=a)},e[51]||(e[51]=[l("option",{value:"s1"},"가동 중",-1),l("option",{value:"s2"},"가동대기 중",-1),l("option",{value:"s3"},"가동정지",-1)]),512),[[R,v.value.line_state]])]),l("div",Ql,[e[53]||(e[53]=l("label",null,"지시수량 (정) *",-1)),g(l("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>v.value.max_capacity=a),type:"number",min:"1",class:q({error:k.value.max_capacity})},null,2),[[$,v.value.max_capacity,void 0,{number:!0}]]),k.value.max_capacity?(n(),s("div",Wl,r(k.value.max_capacity),1)):d("",!0)])]),l("div",Xl,[l("div",Yl,[e[54]||(e[54]=l("label",null,"현재 속도 (정/초) *",-1)),g(l("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>v.value.current_speed=a),type:"number",min:"0",class:q({error:k.value.current_speed})},null,2),[[$,v.value.current_speed,void 0,{number:!0}]]),k.value.current_speed?(n(),s("div",Zl,r(k.value.current_speed),1)):d("",!0)]),l("div",et,[e[56]||(e[56]=l("label",null,"담당자 *",-1)),g(l("select",{"onUpdate:modelValue":e[12]||(e[12]=a=>v.value.employee_id=a),class:q({error:k.value.employee_id})},[e[55]||(e[55]=l("option",{value:""},"담당자 선택",-1)),(n(!0),s(I,null,U(V.value,a=>(n(),s("option",{key:a.employee_id,value:a.employee_id},r(a.employee_name),9,lt))),128))],2),[[R,v.value.employee_id]]),k.value.employee_id?(n(),s("div",tt,r(k.value.employee_id),1)):d("",!0)])]),l("div",at,[e[57]||(e[57]=l("label",null,"설명",-1)),g(l("textarea",{"onUpdate:modelValue":e[13]||(e[13]=a=>v.value.description=a),rows:"3",placeholder:"라인에 대한 상세 설명을 입력하세요"},null,512),[[$,v.value.description]])])],32)]),l("div",st,[l("button",{class:"btn-cancel",onClick:te},"취소"),l("button",{disabled:T.value,class:"btn-save",onClick:qe},r(T.value?"저장중...":"수정"),9,nt)])])])):d("",!0),oe.value&&y(c).canManageLines?(n(),s("div",{key:2,class:"modal-overlay",onClick:ae},[l("div",{class:"modal-content",onClick:e[26]||(e[26]=K(()=>{},["stop"]))},[l("div",{class:"modal-header"},[e[58]||(e[58]=l("h3",null,"라인 등록",-1)),l("button",{class:"modal-close",onClick:ae},"×")]),l("div",ot,[e[74]||(e[74]=l("div",{class:"register-info"},[l("h4",null,"내포장/외포장 동시 등록"),l("p",null,[x(" 선택한 라인 ID로 "),l("strong",null,"내포장"),x("과 "),l("strong",null,"외포장"),x(" 라인이 동시에 등록됩니다. ")]),l("p",null,[l("strong",null,"담당자:"),x(" 각 포장 유형별로 담당자를 선택할 수 있습니다. ")]),l("p",null,[l("strong",null,"제품코드:"),x(" 공정흐름도에 따라 자동으로 처리됩니다. ")])],-1)),D.value?(n(),s("div",{key:0,class:q(["equipment-status",D.value.type])},[l("span",null,r(D.value.message),1)],2)):d("",!0),l("form",{class:"line-form",onSubmit:K(he,["prevent"])},[l("div",rt,[l("div",ut,[e[60]||(e[60]=l("label",null,"라인 ID *",-1)),g(l("select",{"onUpdate:modelValue":e[15]||(e[15]=a=>u.value.line_code=a),class:q({error:m.value.line_code})},[e[59]||(e[59]=l("option",{value:""},"라인 선택",-1)),(n(!0),s(I,null,U(re.value,a=>(n(),s("option",{key:a,value:a},r(a)+"라인 ",9,it))),128))],2),[[R,u.value.line_code]]),m.value.line_code?(n(),s("div",dt,r(m.value.line_code),1)):d("",!0)]),l("div",ct,[e[62]||(e[62]=l("label",null,"제품코드",-1)),g(l("select",{"onUpdate:modelValue":e[16]||(e[16]=a=>u.value.product_code=a)},[e[61]||(e[61]=l("option",{value:""},"제품코드 선택",-1)),(n(!0),s(I,null,U(A.value,a=>(n(),s("option",{key:a.product_code,value:a.product_code},r(a.product_code)+" - "+r(a.product_name),9,_t))),128))],512),[[R,u.value.product_code]])])]),l("div",pt,[l("div",vt,[l("label",null,"내포장 설비명 * ("+r(E.value.length)+"개 설비)",1),g(l("select",{"onUpdate:modelValue":e[17]||(e[17]=a=>u.value.inner_eq_name=a),class:q({error:m.value.inner_eq_name})},[e[63]||(e[63]=l("option",{value:""},"설비 선택",-1)),(n(!0),s(I,null,U(E.value,a=>(n(),s("option",{key:a.eq_name,value:a.eq_name},r(a.eq_name),9,mt))),128))],2),[[R,u.value.inner_eq_name]]),m.value.inner_eq_name?(n(),s("div",yt,r(m.value.inner_eq_name),1)):d("",!0),E.value.length===0?(n(),s("div",gt," 내포장 설비가 없습니다 ")):d("",!0)]),l("div",ft,[l("label",null,"외포장 설비명 * ("+r(C.value.length)+"개 설비)",1),g(l("select",{"onUpdate:modelValue":e[18]||(e[18]=a=>u.value.outer_eq_name=a),class:q({error:m.value.outer_eq_name})},[e[64]||(e[64]=l("option",{value:""},"설비 선택",-1)),(n(!0),s(I,null,U(C.value,a=>(n(),s("option",{key:a.eq_name,value:a.eq_name},r(a.eq_name),9,bt))),128))],2),[[R,u.value.outer_eq_name]]),m.value.outer_eq_name?(n(),s("div",ht,r(m.value.outer_eq_name),1)):d("",!0),C.value.length===0?(n(),s("div",qt," 외포장 설비가 없습니다 ")):d("",!0)])]),l("div",kt,[l("div",wt,[e[65]||(e[65]=l("label",null,"내포장 지시수량 (정) *",-1)),g(l("input",{"onUpdate:modelValue":e[19]||(e[19]=a=>u.value.inner_capacity=a),type:"number",min:"1",placeholder:"1000",class:q({error:m.value.inner_capacity})},null,2),[[$,u.value.inner_capacity,void 0,{number:!0}]]),m.value.inner_capacity?(n(),s("div",Et,r(m.value.inner_capacity),1)):d("",!0)]),l("div",Ct,[e[66]||(e[66]=l("label",null,"외포장 지시수량 (정) *",-1)),g(l("input",{"onUpdate:modelValue":e[20]||(e[20]=a=>u.value.outer_capacity=a),type:"number",min:"1",placeholder:"800",class:q({error:m.value.outer_capacity})},null,2),[[$,u.value.outer_capacity,void 0,{number:!0}]]),m.value.outer_capacity?(n(),s("div",Nt,r(m.value.outer_capacity),1)):d("",!0)])]),l("div",Rt,[l("div",Lt,[e[67]||(e[67]=l("label",null,"내포장 현재속도 (정/초) *",-1)),g(l("input",{"onUpdate:modelValue":e[21]||(e[21]=a=>u.value.inner_speed=a),type:"number",min:"0",placeholder:"30",class:q({error:m.value.inner_speed})},null,2),[[$,u.value.inner_speed,void 0,{number:!0}]]),m.value.inner_speed?(n(),s("div",Mt,r(m.value.inner_speed),1)):d("",!0)]),l("div",It,[e[68]||(e[68]=l("label",null,"외포장 현재속도 (정/초) *",-1)),g(l("input",{"onUpdate:modelValue":e[22]||(e[22]=a=>u.value.outer_speed=a),type:"number",min:"0",placeholder:"30",class:q({error:m.value.outer_speed})},null,2),[[$,u.value.outer_speed,void 0,{number:!0}]]),m.value.outer_speed?(n(),s("div",Ut,r(m.value.outer_speed),1)):d("",!0)])]),l("div",$t,[l("div",xt,[e[70]||(e[70]=l("label",null,"내포장 담당자 *",-1)),g(l("select",{"onUpdate:modelValue":e[23]||(e[23]=a=>u.value.inner_employee_id=a),class:q({error:m.value.inner_employee_id})},[e[69]||(e[69]=l("option",{value:""},"담당자 선택",-1)),(n(!0),s(I,null,U(V.value,a=>(n(),s("option",{key:a.employee_id,value:a.employee_id},r(a.employee_name),9,Tt))),128))],2),[[R,u.value.inner_employee_id]]),m.value.inner_employee_id?(n(),s("div",Dt,r(m.value.inner_employee_id),1)):d("",!0)]),l("div",Vt,[e[72]||(e[72]=l("label",null,"외포장 담당자 *",-1)),g(l("select",{"onUpdate:modelValue":e[24]||(e[24]=a=>u.value.outer_employee_id=a),class:q({error:m.value.outer_employee_id})},[e[71]||(e[71]=l("option",{value:""},"담당자 선택",-1)),(n(!0),s(I,null,U(V.value,a=>(n(),s("option",{key:a.employee_id,value:a.employee_id},r(a.employee_name),9,Pt))),128))],2),[[R,u.value.outer_employee_id]]),m.value.outer_employee_id?(n(),s("div",Ot,r(m.value.outer_employee_id),1)):d("",!0)])]),l("div",St,[e[73]||(e[73]=l("label",null,"설명",-1)),g(l("textarea",{"onUpdate:modelValue":e[25]||(e[25]=a=>u.value.description=a),rows:"3",placeholder:"라인에 대한 상세 설명을 입력하세요"},null,512),[[$,u.value.description]])])],32)]),l("div",At,[l("button",{class:"btn-cancel",onClick:ae},"취소"),l("button",{disabled:T.value,class:"btn-save",onClick:he},r(T.value?"등록중...":"등록"),9,Ft)])])])):d("",!0),W.value?(n(),s("div",{key:3,class:"modal-overlay",onClick:ie},[l("div",{class:"modal-content",onClick:e[27]||(e[27]=K(()=>{},["stop"]))},[l("div",{class:"modal-header"},[e[75]||(e[75]=l("h3",null,"접근 권한 없음",-1)),l("button",{class:"modal-close",onClick:ie},"×")]),l("div",Bt,[l("div",jt,[l("h4",null,r(X.value),1),y(c).userPermissionSummary?(n(),s("p",Jt,[e[76]||(e[76]=x(" 현재 부서: ")),l("strong",null,r(y(c).userPermissionSummary.departmentName)+"부서",1),e[77]||(e[77]=l("br",null,null,-1)),x(" 부서 권한: "+r(y(c).userPermissionSummary.description),1)])):d("",!0),e[79]||(e[79]=l("p",null,[x(" 포장 라인 관리는 "),l("strong",null,"포장부서"),x(" 직원만 사용할 수 있습니다. ")],-1)),l("div",Ht,[e[78]||(e[78]=l("h5",null,"사용 가능한 기능:",-1)),l("ul",null,[y(c).canViewLines?(n(),s("li",Gt,"포장 라인 목록 조회")):d("",!0),y(c).canManageProduction?(n(),s("li",zt,"생산 관리")):d("",!0),y(c).canManageMaterial?(n(),s("li",Kt,"자재 관리")):d("",!0),y(c).canManageQuality?(n(),s("li",Qt,"품질 관리")):d("",!0),y(c).canManageLogistics?(n(),s("li",Wt,"물류 관리")):d("",!0),y(c).canManageAdmin?(n(),s("li",Xt,"관리자 기능")):d("",!0),y(c).canManageSales?(n(),s("li",Yt,"영업 관리")):d("",!0)])])])]),l("div",{class:"modal-actions"},[l("button",{class:"btn-cancel",onClick:ie},"확인")])])])):d("",!0)])}}}),ta=Be(Zt,[["__scopeId","data-v-cf76a7cf"]]);export{ta as default};
//# sourceMappingURL=PackageAddLine-CGSpsMLi.js.map
