{"version":3,"file":"ProductPage-DOCG3m3T.js","sources":["../../../client/src/pages/product/ProductPage.vue"],"sourcesContent":["<template>\n  <div class=\"product-page\">\n    <div class=\"product-container\">\n      <h2 class=\"product-title\">제품 관리</h2>\n      <div class=\"product-grid\">\n        <!-- 제품 검색 필터 및 테이블 -->\n        <div class=\"product-table\">\n          <div class=\"product-filters\">\n            <va-input\n              v-model=\"filters.product_code\"\n              label=\"제품코드\"\n              class=\"filter-input\"\n            />\n            <va-input\n              v-model=\"filters.product_name\"\n              label=\"제품명\"\n              class=\"filter-input\"\n            />\n            <va-input\n              v-model=\"filters.product_stand\"\n              label=\"규격\"\n              class=\"filter-spec-input\"\n            />\n          </div>\n          <va-data-table\n            v-model:current-page=\"page\"\n            :items=\"filteredProducts\"\n            :columns=\"columns\"\n            :per-page=\"10\"\n            track-by=\"product_code\"\n          >\n            <template #cell(select)=\"{ row }\">\n              <va-checkbox\n                :model-value=\"selectedProductCode === row.source.product_code\"\n                :disabled=\"\n                  selectedProductCode !== null &&\n                  selectedProductCode !== row.source.product_code\n                \"\n                @update:model-value=\"\n                  (checked: boolean) => onCheckboxToggle(checked, row.source)\n                \"\n              />\n            </template>\n          </va-data-table>\n        </div>\n\n        <!-- 제품 등록 폼 -->\n        <div class=\"product-form\">\n          <div class=\"form-header\">\n            <h3 class=\"form-title\">제품 등록</h3>\n            <input type=\"file\" accept=\"image/*\" @change=\"onImageChange\" />\n          </div>\n\n          <!-- 미리보기 이미지 -->\n          <div v-if=\"previewImage\" class=\"image-preview\">\n            <img :src=\"previewImage\" alt=\"첨부 이미지 미리보기\" />\n          </div>\n\n          <va-input v-model=\"form.product_code\" label=\"제품코드\" />\n          <va-input v-model=\"form.product_name\" label=\"제품명\" />\n          <va-input v-model=\"form.product_pay\" label=\"판매가\" />\n          <va-input v-model=\"form.product_atc\" label=\"ATC코드\" />\n          <va-input v-model=\"form.product_gred\" label=\"주요성분\" />\n          <va-input v-model=\"form.product_stand\" label=\"규격\" />\n          <va-input v-model=\"form.product_perdt\" label=\"허가일\" type=\"date\" />\n          <va-input v-model=\"form.product_unit\" label=\"단위\" />\n          <va-input v-model=\"form.product_safty\" label=\"안전재고\" />\n\n          <div class=\"form-buttons\">\n            <va-button color=\"primary\" @click=\"registerProduct\">\n              등록\n            </va-button>\n            <va-button color=\"secondary\" @click=\"resetForm\"> 초기화 </va-button>\n            <va-button color=\"warning\" @click=\"updateProduct\"> 수정 </va-button>\n            <va-button color=\"danger\" @click=\"deleteProduct\"> 삭제 </va-button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport axios from \"axios\";\nimport { ref, computed, onMounted } from \"vue\";\n\ninterface Product {\n  product_code: string;\n  product_name: string;\n  product_pay: string;\n  product_atc: string;\n  product_gred: string;\n  product_stand: string;\n  product_perdt: string;\n  product_unit: string;\n  product_safty: string;\n  product_img: string;\n}\n\nconst products = ref<Product[]>([]);\n\nconst fetchProducts = async () => {\n  try {\n    const res = await axios.get(\"/product\");\n    products.value = res.data;\n  } catch (err) {\n    console.log(\"❌ 제품 목록 조회 실패:\", err);\n  }\n};\n\nconst columns = [\n  { key: \"select\", label: \"선택\" },\n  { key: \"product_code\", label: \"제품코드\" },\n  { key: \"product_name\", label: \"제품명\" },\n  { key: \"product_unit\", label: \"단위\" },\n  { key: \"product_stand\", label: \"규격\" },\n];\n\nconst filters = ref({\n  product_code: \"\",\n  product_name: \"\",\n  product_stand: \"\",\n});\n\nconst page = ref(1);\n\nconst filteredProducts = computed(() => {\n  return products.value.filter(\n    (p) =>\n      (!filters.value.product_code ||\n        p.product_code.includes(filters.value.product_code)) &&\n      (!filters.value.product_name ||\n        p.product_name.includes(filters.value.product_name)) &&\n      (!filters.value.product_stand ||\n        p.product_stand.includes(filters.value.product_stand)),\n  );\n});\n\nconst form = ref({\n  product_code: \"\",\n  product_name: \"\",\n  product_pay: \"\",\n  product_atc: \"\",\n  product_gred: \"\",\n  product_stand: \"\",\n  product_perdt: \"\",\n  product_unit: \"\",\n  product_safty: \"\",\n  product_img: \"\", // 이미지 이름 저장\n});\n\nconst previewImage = ref<string | null>(null);\nconst imageFile = ref<File | null>(null);\n\nfunction resetForm() {\n  form.value = {\n    product_code: \"\",\n    product_name: \"\",\n    product_pay: \"\",\n    product_atc: \"\",\n    product_gred: \"\",\n    product_stand: \"\",\n    product_perdt: \"\",\n    product_unit: \"\",\n    product_safty: \"\",\n    product_img: \"\",\n  };\n  previewImage.value = null;\n  imageFile.value = null;\n}\n\nfunction onImageChange(event: Event) {\n  const file = (event.target as HTMLInputElement).files?.[0];\n  if (!file) return;\n\n  imageFile.value = file;\n  form.value.product_img = file.name; // ✅ 이름을 form에 저장 (중요)\n\n  const reader = new FileReader();\n  reader.onload = () => {\n    previewImage.value = reader.result as string;\n  };\n  reader.readAsDataURL(file);\n}\n\nasync function registerProduct() {\n  if (!form.value.product_code || !form.value.product_name) {\n    alert(\"필수값 누락\");\n    return;\n  }\n\n  const formData = new FormData();\n\n  for (const key in form.value) {\n    formData.append(key, (form.value as any)[key]);\n  }\n\n  if (imageFile.value) {\n    formData.append(\"image\", imageFile.value);\n  }\n\n  try {\n    const res = await axios.post(\"/product\", formData, {\n      headers: { \"Content-Type\": \"multipart/form-data\" },\n    });\n\n    if (res.data.isSuccessed == true) {\n      alert(\"등록완료!\");\n      await fetchProducts();\n      resetForm();\n    } else {\n      alert(\"등록 실패!\");\n    }\n  } catch (err) {\n    console.log(\"오류 발생:\", err);\n    alert(\"서버 오류!\");\n  }\n}\n\nasync function updateProduct() {\n  const code = form.value.product_code.trim();\n  if (!code) {\n    alert(\"제품코드가 없습니다. 수정할 수 없습니다.\");\n    return;\n  }\n\n  const formData = new FormData();\n\n  for (const key in form.value) {\n    formData.append(key, (form.value as any)[key]);\n  }\n\n  if (imageFile.value) {\n    formData.append(\"image\", imageFile.value);\n  }\n\n  try {\n    const res = await axios.put(`/product/${code}`, formData, {\n      headers: { \"Content-Type\": \"multipart/form-data\" },\n    });\n\n    if (res.data.isUpdated === true) {\n      alert(\"수정 완료!\");\n      await fetchProducts();\n      resetForm();\n    } else {\n      alert(\"수정 실패!\");\n    }\n  } catch (err) {\n    console.error(\"❌ 수정 오류:\", err);\n    alert(\"서버 오류!\");\n  }\n}\n\nasync function deleteProduct() {\n  const trimmedCode = form.value.product_code.trim();\n\n  if (!trimmedCode) {\n    alert(\"제품코드가 없습니다. 삭제할 수 없습니다.\");\n    return;\n  }\n\n  if (!confirm(`정말로 ${trimmedCode} 제품을 삭제하시겠습니까?`)) {\n    return;\n  }\n\n  try {\n    const res = await axios.delete(`/product/${trimmedCode}`);\n\n    if (res.data.isDeleted == true) {\n      alert(\"삭제 완료!\");\n      await fetchProducts();\n      resetForm();\n    } else {\n      alert(\"삭제 실패! (해당 제품이 존재하지 않거나 이미 삭제됨)\");\n    }\n  } catch (err) {\n    console.error(\"❌ 삭제 중 오류 발생:\", err);\n    alert(\"서버 오류!\");\n  }\n}\n\nconst selectedProductCode = ref<string | null>(null);\n\nfunction onCheckboxToggle(checked: boolean, row: Product) {\n  if (checked) {\n    selectedProductCode.value = row.product_code;\n    form.value = { ...row };\n  } else {\n    selectedProductCode.value = null;\n    resetForm();\n  }\n}\n\nonMounted(() => {\n  fetchProducts();\n});\n</script>\n\n<style scoped>\n.product-page {\n  padding: 1.5rem;\n  display: flex;\n  justify-content: center;\n  height: 739px;\n}\n\n.product-container {\n  width: 1060px;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.product-title {\n  font-size: 1.25rem;\n  font-weight: bold;\n  margin-bottom: 1rem;\n}\n\n.product-grid {\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  column-gap: 2.5rem;\n}\n\n.product-table {\n  grid-column: span 2 / span 2;\n}\n\n.product-filters {\n  display: flex;\n  gap: 1rem;\n  margin-bottom: 1rem;\n}\n\n.filter-input {\n  width: 33.333%;\n}\n\n.filter-spec-input {\n  width: 25%;\n}\n\n.product-form {\n  background-color: white;\n  border-radius: 0.5rem;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);\n  padding: 1rem;\n}\n\n.form-title {\n  font-size: 1.125rem;\n  font-weight: 1000;\n  width: 100px;\n  margin-bottom: 1rem;\n}\n\n.va-input {\n  margin-bottom: 0.5rem;\n}\n\n.form-buttons {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 0.5rem;\n}\n\n.form-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n}\n\n.image-preview {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-bottom: 1rem;\n}\n\n.image-preview img {\n  max-width: 100%;\n  max-height: 150px;\n  object-fit: contain;\n  border: 1px solid #ccc;\n  padding: 4px;\n  border-radius: 4px;\n}\n</style>\n"],"names":["products","ref","fetchProducts","res","axios","err","columns","filters","page","filteredProducts","computed","p","form","previewImage","imageFile","resetForm","onImageChange","event","file","_a","reader","registerProduct","formData","key","updateProduct","code","deleteProduct","trimmedCode","selectedProductCode","onCheckboxToggle","checked","row","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_cache","_hoisted_3","_hoisted_4","_hoisted_5","_createVNode","_component_va_input","$event","_component_va_data_table","_withCtx","_component_va_checkbox","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_10","_component_va_button"],"mappings":"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"}