{"version":3,"file":"defectManager-BrhRM3zn.js","sources":["../../../client/src/pages/quality/defectManager.vue"],"sourcesContent":["<template>\r\n\r\n<div class=\"defect-form\">\r\n  <h3 class=\"form-title\">불량항목 등록</h3>\r\n  <br>  \r\n\r\n  <!-- 상단 입력박스 -->\r\n  <div class=\"form-section\">\r\n    <div class=\"input-row\">\r\n      <va-input v-model=\"form.defectTypeCode\" label=\"불량유형코드\" class=\"quarter-width\" :readonly=\"isEditMode\"/>\r\n      <va-input v-model=\"form.defectTypeName\" label=\"불량명\" class=\"quarter-width\"/>\r\n      <va-input v-model=\"form.defectremark\" label=\"비고\" class=\"half-width\"/>\r\n    </div>\r\n    <div class=\"form-buttons\">\r\n      <va-button @click=\"insertDefect\" color=\"primary\">등록</va-button>\r\n      <va-button @click=\"resetForm\" color=\"secondary\">초기화</va-button>\r\n      <va-button @click=\"deletDefect\" color=\"danger\">삭제</va-button>\r\n    </div>\r\n  </div>\r\n   <!-- 하단 데이터 리스트 -->\r\n  <div class=\"form-section\">\r\n    <table class=\"custom-table\">\r\n      <thead>\r\n        <tr>\r\n          <th>불량유형코드</th>\r\n          <th>불량명</th>\r\n          <th>비고</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"(item, index) in defectList\" :key=\"item.defect_type_code\" @click=\"selectItem(item)\">\r\n          <td>{{ item.defect_type_code }}</td>\r\n          <td>{{ item.defect_type_name }}</td>\r\n          <td>{{ item.defect_type_remark }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport axios from 'axios'\r\n\r\ninterface DefectItem{\r\n  defect_type_code: string\r\n  defect_type_name: string\r\n  defect_type_remark: string\r\n}\r\n\r\nconst defectList = ref<DefectItem[]>([])\r\n\r\nconst form = ref({\r\n  defectTypeCode:'',\r\n  defectTypeName:'',\r\n  defectremark:''\r\n})\r\n\r\nconst fetchDefectList = async () => {\r\n  try{\r\n    const res = await axios.get('/defects/list')\r\n    console.log('응답데이터 : ', res.data);\r\n    defectList.value = res.data\r\n  } catch (err) {\r\n    console.error('검사항목 조회 실패 : ', err);\r\n  }\r\n}\r\n\r\nconst isEditMode = ref(false)\r\n\r\nfunction selectItem(item: any) {\r\n  form.value = {\r\n    defectTypeCode: item.defect_type_code,\r\n    defectTypeName: item.defect_type_name,\r\n    defectremark: item.defect_type_remark\r\n  };\r\n  isEditMode.value = true; // 등록된 데이터를 클릭하고 초기화를 눌렀을 때 :readonly=\"isEditMode\"에서 isEditMode가 true가 되면서 readonly 작동\r\n}\r\n\r\nconst insertDefect = async () => {\r\n\r\n  const newDefect = {\r\n    defect_type_code: form.value.defectTypeCode,\r\n    defect_type_name: form.value.defectTypeName,\r\n    defect_type_remark: form.value.defectremark\r\n  }\r\n\r\n  try{\r\n    if(isEditMode.value) { // input박스에 값이 들어가있은 경우에 true로 지정되면 이를 통해 등록이 아닌 수정인 경우로 분류하기 위한 if 조건문\r\n      const res = await axios.post('/defects/update', newDefect);\r\n      if(res.data.success) {\r\n        alert('수정성공');\r\n      } else {\r\n        alert('수정실패');\r\n      }\r\n    } else { // isEditMode.value의 값이 1이 아닌 경우, input박스에는 값이 없으므로 등록 조건문을 사용\r\n    const res = await axios.post('/defects/insert', newDefect);\r\n      if(res.data.success) {\r\n        alert(\"등록 성공\");\r\n        defectList.value.push({ ...newDefect }); // 수정은 기존의 데이터에 변경된 내용만 입력하면 되기때문에 이부분이 없음\r\n      }\r\n    }\r\n\r\n    await fetchDefectList();\r\n    resetForm();\r\n    } catch (err: any) {\r\n      if(axios.isAxiosError(err)) { // axiosError로 타입의 범위를 좁힌다\r\n        const message = err.response?.data?.message;\r\n        if(message === '중복') { // router에 중복err로 등록된 message가 '중복'이기 때문에 같으면 아래 조건을 실행\r\n          alert('이미 존재하는 불량항목코드입니다'); \r\n        } else {\r\n          alert('등록 중 오류 발생: ' + (message || err.message));\r\n        }\r\n      } else {\r\n        alert('오류 발생'); // 지정하지 않은 나머지 오류에 대한 alert창\r\n      }\r\n  }\r\n};\r\n\r\nfunction resetForm() {\r\n  form.value = {\r\n    defectTypeCode: '', defectTypeName: '', defectremark: ''\r\n  };\r\n  isEditMode.value = false; // false로 지정해야 초기화했을때 불량유형코드 readonly 작동이 풀린다\r\n}\r\n\r\nfunction deletDefect() {\r\n  alert(\"기능 미구현\");\r\n}\r\n\r\nonMounted(() => {\r\n  fetchDefectList()\r\n})\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.defect-form {\r\n  background-color: transparent;\r\n  border-radius: 0.5rem;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);\r\n  padding: 1rem;\r\n}\r\n\r\n.form-title {\r\n  font-size: 1.125rem;\r\n  font-weight: 1000;\r\n  width: 200px;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.form-section {\r\n  border: 1px solid #ccc;       /* 테두리는 유지 */\r\n  border-radius: 0.5rem;\r\n  padding: 1rem;\r\n  margin-bottom: 1rem;\r\n  background-color: white;      /* 배경을 흰색으로 바꿈 */\r\n}\r\n\r\n.input-row {\r\n  display: flex;\r\n  gap: 1rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.va-input {\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.quarter-width {\r\n  flex: 1;\r\n}\r\n\r\n.half-width {\r\n  flex: 2;\r\n  width: 50%;\r\n}\r\n\r\n.form-buttons {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 0.5rem;\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n.custom-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  border-radius: 0.5rem;\r\n  overflow: hidden;\r\n  background-color: transparent;\r\n}\r\n\r\n.custom-table th,\r\n.custom-table td {\r\n  padding: 0.75rem;\r\n  border-bottom: 1px solid #e0e0e0;\r\n  text-align: center;\r\n  background-color: transparent;\r\n}\r\n\r\n.custom-table th {\r\n  font-weight: bold;\r\n}\r\n\r\n</style>"],"names":["defectList","ref","form","fetchDefectList","res","axios","err","isEditMode","selectItem","item","insertDefect","newDefect","resetForm","message","_b","_a","deletDefect","onMounted","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_va_input","$event","_hoisted_4","_component_va_button","_hoisted_5","_hoisted_6","_Fragment","_renderList","index","_toDisplayString"],"mappings":"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"}