{"version":3,"file":"faultyDisuseInsertPage-DjCyWFgV.js","sources":["../../../client/src/pages/quality/faultyDisuseInsertPage.vue"],"sourcesContent":["<template>\n  <!-- 제품 등록 폼 -->\n  <div class=\"product-form\">\n    <h3 class=\"form-title\">불량품폐기 등록</h3>\n    <br />\n\n    <!-- 상단 폼 -->\n    <div class=\"form-section\">\n      <h3 class=\"form-title\">불량이력 조회</h3>\n      <div class=\"input-row\">\n        <va-select\n          v-model=\"form.name\"\n          :options=\"productOptions\"\n          label=\"제품명\"\n          placeholder=\"제품을 선택하세요\"\n          value-by=\"value\"\n          text-by=\"label\"\n        />\n        <va-select\n          v-model=\"form.code\"\n          :options=\"workOrderOptions\"\n          label=\"작업지시서번호\"\n          placeholder=\"작업지시서를 선택하세요\"\n          value-by=\"value\"\n          text-by=\"label\"\n          :disabled=\"workOrderOptions.length === 0\"\n        />\n      </div>\n      <div class=\"input-row\">\n        <va-input v-model=\"form.processStage\" label=\"공정단계\" />\n        <va-input v-model=\"form.occurDate\" label=\"발생일자\" type=\"date\" />\n      </div>\n      <div class=\"input-row\">\n        <va-input v-model=\"form.faultyQuantity\" label=\"불량수량\" />\n        <va-input v-model=\"form.faultyType\" label=\"불량유형\" />\n      </div>\n    </div>\n\n    <!-- 하단 폼 -->\n    <div class=\"form-section\">\n      <h3 class=\"form-title\">폐기정보 등록</h3>\n      <div class=\"input-row\">\n        <va-input v-model=\"form.faultyQuantity\" label=\"폐기수량\" />\n        <va-input v-model=\"form.Representative\" label=\"담당자\" />\n      </div>\n      <div class=\"input-row\">\n        <va-input v-model=\"form.disuseReson\" label=\"폐기사유\" />\n        <va-input v-model=\"form.disuseState\" label=\"처리상태\" />\n      </div>\n    </div>\n\n    <!-- 버튼 -->\n    <div class=\"form-buttons\">\n      <va-button @click=\"registerProduct\" color=\"primary\">등록</va-button>\n      <va-button @click=\"resetForm\" color=\"seconderys\">초기화</va-button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, onMounted, watch } from \"vue\";\nimport axios from \"axios\";\n\nconst productOptions = ref<{ label: string; value: string }[]>([]);\nconst workOrderOptions = ref<{ label: string; value: string }[]>([]);\n\nconst form = ref({\n  faultyCode: \"\",\n  occurDate: \"\",\n  name: \"\", // 제품코드 저장 (제품명 아닌 코드)\n  code: \"\", // 작업지시서 번호 저장\n  processStage: \"\",\n  faultyType: \"\",\n  faultyResult: \"\",\n  faultyQuantity: \"\",\n  disuseCompany: \"\",\n  Representative: \"\",\n  disuseReson: \"\",\n  disuseState: \"\",\n});\n\n// 제품 리스트 로드\nonMounted(async () => {\n  try {\n    const res = await axios.get(\"/faultyDisuses/productList\");\n    productOptions.value = res.data.map((item: any) => ({\n      label: item.product_name,\n      value: item.product_code,\n    }));\n  } catch (err) {\n    console.error(\"제품명 목록 조회 실패:\", err);\n  }\n});\n\n// 제품 선택 시 작업지시서 목록 불러오기\nwatch(\n  () => form.value.name,\n  async (newProductCode) => {\n    if (!newProductCode) {\n      workOrderOptions.value = [];\n      form.value.code = \"\";\n      return;\n    }\n    try {\n      const res = await axios.get(\"faultyDisuses/workOrderList\", {\n        params: { productCode: newProductCode },\n      });\n      workOrderOptions.value = res.data.map((item: any) => ({\n        label: item.work_order_no,\n        value: item.work_order_no,\n      }));\n    } catch (err) {\n      console.error(\"작업지시서 목록 조회 실패:\", err);\n      workOrderOptions.value = [];\n      form.value.code = \"\";\n    }\n  },\n);\n\nwatch(\n  () => form.value.code,\n  async (newWorkOrderNo) => {\n    if (!form.value.name || !newWorkOrderNo) return;\n\n    try {\n      const res = await axios.get(\"/faultyDisuses/faultyInfo\", {\n        params: {\n          productCode: form.value.name,\n          workOrderNo: newWorkOrderNo,\n        },\n      });\n\n      const data = res.data;\n      form.value.processStage = data.process_name || \"\";\n      form.value.occurDate = data.created_at || \"\";\n      form.value.faultyQuantity = data.quantity || \"\";\n      form.value.faultyType = data.defect_type || \"\";\n    } catch (err) {\n      console.error(\"불량 정보 조회 실패:\", err);\n      form.value.processStage = \"\";\n      form.value.occurDate = \"\";\n      form.value.faultyQuantity = \"\";\n      form.value.faultyType = \"\";\n    }\n  },\n);\n\nfunction resetForm() {\n  form.value = {\n    faultyCode: \"\",\n    occurDate: \"\",\n    name: \"\",\n    code: \"\",\n    processStage: \"\",\n    faultyType: \"\",\n    faultyResult: \"\",\n    faultyQuantity: \"\",\n    disuseCompany: \"\",\n    Representative: \"\",\n    disuseReson: \"\",\n    disuseState: \"\",\n  };\n}\n\nasync function registerProduct() {\n  if (!form.value.name || !form.value.code) {\n    return alert(\"제품명과 작업지시서는 필수입니다.\");\n  }\n\n  try {\n    const payload = {\n      product_code: form.value.name,\n      work_order_no: form.value.code,\n      process_name: form.value.processStage,\n      occur_date: form.value.occurDate,\n      defect_type: form.value.faultyType,\n      faulty_quantity: Number(form.value.faultyQuantity),\n      representative: form.value.Representative,\n      disuse_reason: form.value.disuseReson,\n      disuse_state: form.value.disuseState,\n    };\n\n    await axios.post(\"/faultyDisuses/register\", payload);\n    alert(\"폐기정보 등록이 완료되었습니다.\");\n    resetForm();\n  } catch (err) {\n    console.error(\"등록 실패:\", err);\n    alert(\"등록 중 오류가 발생했습니다.\");\n  }\n}\n\nfunction updateProduct() {\n  alert(\"수정 기능은 아직 구현되지 않았습니다.\");\n}\n\nfunction deleteProduct() {\n  alert(\"삭제 기능은 아직 구현되지 않았습니다.\");\n}\n</script>\n\n<style scoped>\n.product-page {\n  padding: 1.5rem;\n  display: flex;\n  justify-content: center;\n  height: 739px;\n}\n\n.product-container {\n  width: 1060px;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.product-form {\n  background-color: white;\n  border-radius: 0.5rem;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);\n  padding: 1rem;\n}\n\n.form-section {\n  border: 1px solid #ccc; /* 테두리 회색 */\n  border-radius: 0.5rem; /* 모서리 둥글게 */\n  padding: 1rem; /* 안쪽 여백 */\n  margin-bottom: 1rem; /* 아래 여백 */\n  background-color: #f9f9f9; /* 살짝 밝은 배경색 (선택) */\n}\n\n.form-title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.input-row {\n  display: flex;\n  gap: 1rem; /* 두 박스 간 여백 */\n  margin-bottom: 0.5rem;\n}\n\n.half-width {\n  width: 50%;\n}\n\n.va-input {\n  margin-bottom: 0.5rem;\n}\n\n.form-buttons {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 0.5rem;\n}\n</style>\n"],"names":["productOptions","ref","workOrderOptions","form","onMounted","res","axios","item","err","watch","newProductCode","newWorkOrderNo","data","resetForm","registerProduct","payload","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_va_select","$event","_hoisted_4","_component_va_input","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_component_va_button"],"mappings":"kYA+DA,MAAMA,EAAiBC,EAAwC,EAAE,EAC3DC,EAAmBD,EAAwC,EAAE,EAE7DE,EAAOF,EAAI,CACf,WAAY,GACZ,UAAW,GACX,KAAM,GACN,KAAM,GACN,aAAc,GACd,WAAY,GACZ,aAAc,GACd,eAAgB,GAChB,cAAe,GACf,eAAgB,GAChB,YAAa,GACb,YAAa,EAAA,CACd,EAGDG,EAAU,SAAY,CACpB,GAAI,CACF,MAAMC,EAAM,MAAMC,EAAM,IAAI,4BAA4B,EACxDN,EAAe,MAAQK,EAAI,KAAK,IAAKE,IAAe,CAClD,MAAOA,EAAK,aACZ,MAAOA,EAAK,YAAA,EACZ,CAAA,OACKC,EAAK,CACZ,QAAQ,MAAM,gBAAiBA,CAAG,CAAA,CACpC,CACD,EAGDC,EACE,IAAMN,EAAK,MAAM,KACjB,MAAOO,GAAmB,CACxB,GAAI,CAACA,EAAgB,CACnBR,EAAiB,MAAQ,CAAA,EACzBC,EAAK,MAAM,KAAO,GAClB,MAAA,CAEF,GAAI,CACF,MAAME,EAAM,MAAMC,EAAM,IAAI,8BAA+B,CACzD,OAAQ,CAAE,YAAaI,CAAA,CAAe,CACvC,EACDR,EAAiB,MAAQG,EAAI,KAAK,IAAKE,IAAe,CACpD,MAAOA,EAAK,cACZ,MAAOA,EAAK,aAAA,EACZ,CAAA,OACKC,EAAK,CACZ,QAAQ,MAAM,kBAAmBA,CAAG,EACpCN,EAAiB,MAAQ,CAAA,EACzBC,EAAK,MAAM,KAAO,EAAA,CACpB,CACF,EAGFM,EACE,IAAMN,EAAK,MAAM,KACjB,MAAOQ,GAAmB,CACxB,GAAI,GAACR,EAAK,MAAM,MAAQ,CAACQ,GAEzB,GAAI,CAQF,MAAMC,GAPM,MAAMN,EAAM,IAAI,4BAA6B,CACvD,OAAQ,CACN,YAAaH,EAAK,MAAM,KACxB,YAAaQ,CAAA,CACf,CACD,GAEgB,KACjBR,EAAK,MAAM,aAAeS,EAAK,cAAgB,GAC/CT,EAAK,MAAM,UAAYS,EAAK,YAAc,GAC1CT,EAAK,MAAM,eAAiBS,EAAK,UAAY,GAC7CT,EAAK,MAAM,WAAaS,EAAK,aAAe,EAAA,OACrCJ,EAAK,CACZ,QAAQ,MAAM,eAAgBA,CAAG,EACjCL,EAAK,MAAM,aAAe,GAC1BA,EAAK,MAAM,UAAY,GACvBA,EAAK,MAAM,eAAiB,GAC5BA,EAAK,MAAM,WAAa,EAAA,CAC1B,CACF,EAGF,SAASU,GAAY,CACnBV,EAAK,MAAQ,CACX,WAAY,GACZ,UAAW,GACX,KAAM,GACN,KAAM,GACN,aAAc,GACd,WAAY,GACZ,aAAc,GACd,eAAgB,GAChB,cAAe,GACf,eAAgB,GAChB,YAAa,GACb,YAAa,EAAA,CACf,CAGF,eAAeW,GAAkB,CAC/B,GAAI,CAACX,EAAK,MAAM,MAAQ,CAACA,EAAK,MAAM,KAClC,OAAO,MAAM,oBAAoB,EAGnC,GAAI,CACF,MAAMY,EAAU,CACd,aAAcZ,EAAK,MAAM,KACzB,cAAeA,EAAK,MAAM,KAC1B,aAAcA,EAAK,MAAM,aACzB,WAAYA,EAAK,MAAM,UACvB,YAAaA,EAAK,MAAM,WACxB,gBAAiB,OAAOA,EAAK,MAAM,cAAc,EACjD,eAAgBA,EAAK,MAAM,eAC3B,cAAeA,EAAK,MAAM,YAC1B,aAAcA,EAAK,MAAM,WAAA,EAG3B,MAAMG,EAAM,KAAK,0BAA2BS,CAAO,EACnD,MAAM,mBAAmB,EACzBF,EAAA,CAAU,OACHL,EAAK,CACZ,QAAQ,MAAM,SAAUA,CAAG,EAC3B,MAAM,kBAAkB,CAAA,CAC1B,uEA1LA,OAAAQ,EAAA,EAAAC,EAsDM,MAtDNC,EAsDM,CArDJC,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAC,EAAoC,KAAA,CAAhC,MAAM,YAAA,EAAa,WAAQ,EAAA,iBAC/BA,EAAM,KAAA,KAAA,KAAA,EAAA,GAGNA,EA6BM,MA7BNC,EA6BM,CA5BJF,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAC,EAAmC,KAAA,CAA/B,MAAM,YAAA,EAAa,UAAO,EAAA,GAC9BA,EAkBM,MAlBNE,EAkBM,CAjBJC,EAOEC,EAAA,CANS,WAAArB,EAAA,MAAK,KAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,KAAIsB,GACjB,QAASzB,EAAA,MACV,MAAM,MACN,YAAY,YACZ,WAAS,QACT,UAAQ,OAAA,mCAEVuB,EAQEC,EAAA,CAPS,WAAArB,EAAA,MAAK,KAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,KAAIsB,GACjB,QAASvB,EAAA,MACV,MAAM,UACN,YAAY,eACZ,WAAS,QACT,UAAQ,QACP,SAAUA,EAAA,MAAiB,SAAM,CAAA,gDAGtCkB,EAGM,MAHNM,EAGM,CAFJH,EAAqDI,EAAA,CAAlC,WAAAxB,EAAA,MAAK,aAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,aAAYsB,GAAE,MAAM,MAAA,yBAC5CF,EAA8DI,EAAA,CAA3C,WAAAxB,EAAA,MAAK,UAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,UAASsB,GAAE,MAAM,OAAO,KAAK,MAAA,2BAEvDL,EAGM,MAHNQ,EAGM,CAFJL,EAAuDI,EAAA,CAApC,WAAAxB,EAAA,MAAK,eAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,eAAcsB,GAAE,MAAM,MAAA,yBAC9CF,EAAmDI,EAAA,CAAhC,WAAAxB,EAAA,MAAK,WAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,WAAUsB,GAAE,MAAM,MAAA,6BAK9CL,EAUM,MAVNS,EAUM,CATJV,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAC,EAAmC,KAAA,CAA/B,MAAM,YAAA,EAAa,UAAO,EAAA,GAC9BA,EAGM,MAHNU,EAGM,CAFJP,EAAuDI,EAAA,CAApC,WAAAxB,EAAA,MAAK,eAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,eAAcsB,GAAE,MAAM,MAAA,yBAC9CF,EAAsDI,EAAA,CAAnC,WAAAxB,EAAA,MAAK,eAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,eAAcsB,GAAE,MAAM,KAAA,2BAEhDL,EAGM,MAHNW,EAGM,CAFJR,EAAoDI,EAAA,CAAjC,WAAAxB,EAAA,MAAK,YAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,YAAWsB,GAAE,MAAM,MAAA,yBAC3CF,EAAoDI,EAAA,CAAjC,WAAAxB,EAAA,MAAK,YAAL,sBAAAgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAM,GAAAtB,EAAA,MAAK,YAAWsB,GAAE,MAAM,MAAA,6BAK/CL,EAGM,MAHNY,EAGM,CAFJT,EAAkEU,EAAA,CAAtD,QAAOnB,EAAiB,MAAM,SAAA,aAAU,IAAEK,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,GAAF,IAAE,CAAA,kBACtDI,EAAgEU,EAAA,CAApD,QAAOpB,EAAW,MAAM,YAAA,aAAa,IAAGM,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,GAAH,KAAG,CAAA"}