{"version":3,"file":"faultyDisuseInsertPage-DWn4OnmA.js","sources":["../../../client/src/pages/quality/faultyDisuseInsertPage.vue"],"sourcesContent":[" <template>\r\n  <!-- 제품 등록 폼 -->\r\n  <div class=\"product-form\">\r\n    <h3 class=\"form-title\">불량품폐기 등록</h3>\r\n    <br>\r\n\r\n    <!-- 상단 폼 -->\r\n    <div class=\"form-section\">\r\n      <h3 class=\"form-title\">불량이력 조회</h3>\r\n      <div class=\"input-row\">\r\n        <va-select\r\n          v-model=\"form.name\"\r\n          :options=\"productOptions\"\r\n          label=\"제품명\"\r\n          placeholder=\"제품을 선택하세요\"\r\n          value-by=\"value\"\r\n          text-by=\"label\"\r\n        />\r\n        <va-select\r\n          v-model=\"form.code\"\r\n          :options=\"workOrderOptions\"\r\n          label=\"작업지시서번호\"\r\n          placeholder=\"작업지시서를 선택하세요\"\r\n          value-by=\"value\"\r\n          text-by=\"label\"\r\n          :disabled=\"workOrderOptions.length === 0\"\r\n        />\r\n      </div>\r\n      <div class=\"input-row\">\r\n        <va-input v-model=\"form.processStage\" label=\"공정단계\" />\r\n        <va-input v-model=\"form.occurDate\" label=\"발생일자\" type=\"date\" />\r\n      </div>\r\n      <div class=\"input-row\">        \r\n        <va-input v-model=\"form.faultyQuantity\" label=\"불량수량\" />\r\n        <va-input v-model=\"form.faultyType\" label=\"불량유형\" />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 하단 폼 -->\r\n    <div class=\"form-section\">\r\n      <h3 class=\"form-title\">폐기정보 등록</h3>\r\n      <div class=\"input-row\">\r\n        <va-input v-model=\"form.faultyQuantity\" label=\"폐기수량\" />\r\n        <va-input v-model=\"form.Representative\" label=\"담당자\" />\r\n      </div>\r\n      <div class=\"input-row\">\r\n        <va-input v-model=\"form.disuseReson\" label=\"폐기사유\" />\r\n        <va-input v-model=\"form.disuseState\" label=\"처리상태\" />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 버튼 -->\r\n    <div class=\"form-buttons\">\r\n      <va-button @click=\"registerProduct\" color=\"primary\">등록</va-button>\r\n      <va-button @click=\"resetForm\" color=\"seconderys\">초기화</va-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { ref, onMounted, watch } from 'vue';\r\nimport axios from 'axios';\r\n\r\nconst productOptions = ref<{ label: string; value: string }[]>([]);\r\nconst workOrderOptions = ref<{ label: string; value: string }[]>([]);\r\n\r\nconst form = ref({\r\n  faultyCode: '',\r\n  occurDate: '',\r\n  name: '',  // 제품코드 저장 (제품명 아닌 코드)\r\n  code: '',  // 작업지시서 번호 저장\r\n  processStage: '',\r\n  faultyType: '',\r\n  faultyResult: '',\r\n  faultyQuantity: '',\r\n  disuseCompany: '',\r\n  Representative: '',\r\n  disuseReson: '',\r\n  disuseState: ''\r\n});\r\n\r\n// 제품 리스트 로드\r\nonMounted(async () => {\r\n  try {\r\n    const res = await axios.get('/faultyDisuses/productList');\r\n    productOptions.value = res.data.map((item: any) => ({\r\n      label: item.product_name,\r\n      value: item.product_code,\r\n    }));\r\n  } catch (err) {\r\n    console.error('제품명 목록 조회 실패:', err);\r\n  }\r\n});\r\n\r\n// 제품 선택 시 작업지시서 목록 불러오기\r\nwatch(() => form.value.name, async (newProductCode) => {\r\n  if (!newProductCode) {\r\n    workOrderOptions.value = [];\r\n    form.value.code = '';\r\n    return;\r\n  }\r\n  try {\r\n    const res = await axios.get('faultyDisuses/workOrderList', { params: { productCode: newProductCode } });\r\n    workOrderOptions.value = res.data.map((item: any) => ({\r\n      label: item.work_order_no,\r\n      value: item.work_order_no,\r\n    }));\r\n  } catch (err) {\r\n    console.error('작업지시서 목록 조회 실패:', err);\r\n    workOrderOptions.value = [];\r\n    form.value.code = '';\r\n  }\r\n});\r\n\r\nwatch(() => form.value.code, async (newWorkOrderNo) => {\r\n  if (!form.value.name || !newWorkOrderNo) return;\r\n\r\n  try {\r\n    const res = await axios.get('/faultyDisuses/faultyInfo', {\r\n      params: {\r\n        productCode: form.value.name,\r\n        workOrderNo: newWorkOrderNo,\r\n      },\r\n    });\r\n\r\n    const data = res.data;\r\n    form.value.processStage = data.process_name || '';\r\n    form.value.occurDate = data.created_at || '';\r\n    form.value.faultyQuantity = data.quantity || '';\r\n    form.value.faultyType = data.defect_type || '';\r\n  } catch (err) {\r\n    console.error('불량 정보 조회 실패:', err);\r\n    form.value.processStage = '';\r\n    form.value.occurDate = '';\r\n    form.value.faultyQuantity = '';\r\n    form.value.faultyType = '';\r\n  }\r\n});\r\n\r\nfunction resetForm() {\r\n  form.value = {\r\n    faultyCode: '', occurDate: '', name: '', code: '', processStage: '',\r\n    faultyType: '', faultyResult: '', faultyQuantity: '',\r\n    disuseCompany: '', Representative: '', disuseReson: '',\r\n    disuseState: ''\r\n  }\r\n}\r\n\r\nasync function registerProduct() {\r\n  if (!form.value.name || !form.value.code) {\r\n    return alert('제품명과 작업지시서는 필수입니다.');\r\n  }\r\n\r\n  try {\r\n    const payload = {\r\n      product_code: form.value.name,\r\n      work_order_no: form.value.code,\r\n      process_name: form.value.processStage,\r\n      occur_date: form.value.occurDate,\r\n      defect_type: form.value.faultyType,\r\n      faulty_quantity: Number(form.value.faultyQuantity),\r\n      representative: form.value.Representative,\r\n      disuse_reason: form.value.disuseReson,\r\n      disuse_state: form.value.disuseState,\r\n    };\r\n\r\n    await axios.post('/faultyDisuses/register', payload);\r\n    alert('폐기정보 등록이 완료되었습니다.');\r\n    resetForm();\r\n  } catch (err) {\r\n    console.error('등록 실패:', err);\r\n    alert('등록 중 오류가 발생했습니다.');\r\n  }\r\n}\r\n\r\nfunction updateProduct() {\r\n  alert('수정 기능은 아직 구현되지 않았습니다.')\r\n}\r\n\r\nfunction deleteProduct() {\r\n  alert('삭제 기능은 아직 구현되지 않았습니다.')\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.product-page {\r\n  padding: 1.5rem;\r\n  display: flex;\r\n  justify-content: center;\r\n  height: 739px;\r\n}\r\n\r\n.product-container {\r\n  width: 1060px;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.product-form {\r\n  background-color: white;\r\n  border-radius: 0.5rem;\r\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.05);\r\n  padding: 1rem;\r\n}\r\n\r\n.form-section {\r\n  border: 1px solid #ccc;         /* 테두리 회색 */\r\n  border-radius: 0.5rem;          /* 모서리 둥글게 */\r\n  padding: 1rem;                  /* 안쪽 여백 */\r\n  margin-bottom: 1rem;            /* 아래 여백 */\r\n  background-color: #f9f9f9;      /* 살짝 밝은 배경색 (선택) */\r\n}\r\n\r\n\r\n.form-title {\r\n  font-size: 1.125rem;\r\n  font-weight: 600;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.input-row {\r\n  display: flex;\r\n  gap: 1rem; /* 두 박스 간 여백 */\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.half-width {\r\n  width: 50%;\r\n}\r\n\r\n.va-input {\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.form-buttons {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n</style>"],"names":["productOptions","ref","workOrderOptions","form","onMounted","res","axios","item","err","watch","newProductCode","newWorkOrderNo","data","resetForm","registerProduct","payload","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_va_select","$event","_hoisted_4","_component_va_input","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_component_va_button"],"mappings":"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"}