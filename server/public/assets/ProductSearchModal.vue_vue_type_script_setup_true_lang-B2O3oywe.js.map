{"version":3,"file":"ProductSearchModal.vue_vue_type_script_setup_true_lang-B2O3oywe.js","sources":["../../../client/src/pages/modals/ProductSearchModal.vue"],"sourcesContent":["<template>\n  <va-modal v-model=\"visible\" title=\"제품 검색\" size=\"large\">\n    <div class=\"va-mb-4 va-row va-gap-2\">\n      <va-input v-model=\"search.product_name\" label=\"제품명\" />\n      <va-input v-model=\"search.product_stand\" label=\"제품규격\" />\n      <va-input v-model=\"search.result_id\" label=\"실적ID\" />\n      <va-button @click=\"searchProducts\">검색</va-button>\n    </div>\n\n    <va-data-table\n      :items=\"productList\"\n      :columns=\"columns\"\n      track-by=\"product_code\"\n    >\n      <template #cell(select)=\"{ row }\">\n        <va-checkbox\n          :model-value=\"row.rowData.selected\"\n          @update:modelValue=\"(val) => handleSelect(row.rowData, val)\"\n        />\n      </template>\n    </va-data-table>\n\n    <div class=\"va-mt-4 va-row va-justify-end va-gap-2\">\n      <va-button color=\"primary\" @click=\"applySelection\">선택</va-button>\n    </div>\n  </va-modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, computed, defineProps, defineEmits } from \"vue\";\nimport axios from \"axios\";\n\nconst props = defineProps<{ visible: boolean }>();\nconst emit = defineEmits([\"update:visible\", \"apply\"]);\n\nconst visible = computed({\n  get: () => props.visible,\n  set: (val) => emit(\"update:visible\", val),\n});\n\nconst search = ref({\n  product_name: \"\",\n  product_stand: \"\",\n  result_id: \"\",\n});\n\nconst productList = ref<any[]>([]);\n\nconst columns = [\n  { key: \"select\", label: \"선택\", width: 60 },\n  { key: \"work_order_no\", label: \"작업지시 코드\" },\n  { key: \"product_name\", label: \"제품명\" },\n  { key: \"product_stand\", label: \"제품규격\" },\n  { key: \"result_id\", label: \"실적 ID\" },\n];\n\nconst searchProducts = async () => {\n  try {\n    const res = await axios.get(\"/prodResult\");\n    productList.value = res.data\n      .filter((item: any) => {\n        return (\n          (!search.value.product_name ||\n            item.product_name.includes(search.value.product_name)) &&\n          (!search.value.product_stand ||\n            item.product_stand.includes(search.value.product_stand))\n        );\n      })\n      .map((item: any) => ({ ...item, selected: false }));\n  } catch (err) {\n    alert(\"제품 목록 조회 실패\");\n  }\n};\n\nconst handleSelect = (target: any, val: boolean) => {\n  productList.value.forEach((item) => (item.selected = false));\n  if (val) target.selected = true;\n};\n\nconst applySelection = () => {\n  const selected = productList.value.find((p) => p.selected);\n  if (selected) {\n    emit(\"apply\", selected);\n    visible.value = false;\n  } else {\n    alert(\"선택된 제품이 없습니다.\");\n  }\n};\n</script>\n"],"names":["props","__props","emit","__emit","visible","computed","val","search","ref","productList","columns","searchProducts","res","axios","item","handleSelect","target","applySelection","selected","p","_createBlock","_component_va_modal","$event","_createElementVNode","_hoisted_1","_createVNode","_component_va_input","_cache","_component_va_button","_component_va_data_table","_withCtx","row","_component_va_checkbox","_hoisted_2"],"mappings":"yTAgCA,MAAMA,EAAQC,EACRC,EAAOC,EAEPC,EAAUC,EAAS,CACvB,IAAK,IAAML,EAAM,QACjB,IAAMM,GAAQJ,EAAK,iBAAkBI,CAAG,CAAA,CACzC,EAEKC,EAASC,EAAI,CACjB,aAAc,GACd,cAAe,GACf,UAAW,EAAA,CACZ,EAEKC,EAAcD,EAAW,EAAE,EAE3BE,EAAU,CACd,CAAE,IAAK,SAAU,MAAO,KAAM,MAAO,EAAA,EACrC,CAAE,IAAK,gBAAiB,MAAO,SAAA,EAC/B,CAAE,IAAK,eAAgB,MAAO,KAAA,EAC9B,CAAE,IAAK,gBAAiB,MAAO,MAAA,EAC/B,CAAE,IAAK,YAAa,MAAO,OAAA,CAAQ,EAG/BC,EAAiB,SAAY,CACjC,GAAI,CACF,MAAMC,EAAM,MAAMC,EAAM,IAAI,aAAa,EACzCJ,EAAY,MAAQG,EAAI,KACrB,OAAQE,IAEJ,CAACP,EAAO,MAAM,cACbO,EAAK,aAAa,SAASP,EAAO,MAAM,YAAY,KACrD,CAACA,EAAO,MAAM,eACbO,EAAK,cAAc,SAASP,EAAO,MAAM,aAAa,EAE3D,EACA,IAAKO,IAAe,CAAE,GAAGA,EAAM,SAAU,EAAA,EAAQ,CAAA,MACxC,CACZ,MAAM,aAAa,CAAA,CACrB,EAGIC,EAAe,CAACC,EAAaV,IAAiB,CAClDG,EAAY,MAAM,QAASK,GAAUA,EAAK,SAAW,EAAM,EACvDR,MAAY,SAAW,GAAA,EAGvBW,EAAiB,IAAM,CAC3B,MAAMC,EAAWT,EAAY,MAAM,KAAMU,GAAMA,EAAE,QAAQ,EACrDD,GACFhB,EAAK,QAASgB,CAAQ,EACtBd,EAAQ,MAAQ,IAEhB,MAAM,eAAe,CACvB,0HArFAgB,EAwBWC,EAAA,YAxBQjB,EAAA,2CAAAA,EAAO,MAAAkB,GAAE,MAAM,QAAQ,KAAK,OAAA,aAC7C,IAKM,CALNC,EAKM,MALNC,EAKM,CAJJC,EAAsDC,EAAA,CAAnC,WAAAnB,EAAA,MAAO,aAAP,sBAAAoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,GAAAf,EAAA,MAAO,aAAYe,GAAE,MAAM,KAAA,yBAC9CG,EAAwDC,EAAA,CAArC,WAAAnB,EAAA,MAAO,cAAP,sBAAAoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,GAAAf,EAAA,MAAO,cAAae,GAAE,MAAM,MAAA,yBAC/CG,EAAoDC,EAAA,CAAjC,WAAAnB,EAAA,MAAO,UAAP,sBAAAoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAL,GAAAf,EAAA,MAAO,UAASe,GAAE,MAAM,MAAA,yBAC3CG,EAAiDG,EAAA,CAArC,QAAOjB,GAAc,WAAE,IAAEgB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,IAAE,CAAA,mBAGvCF,EAWgBI,EAAA,CAVb,MAAOpB,EAAA,MACP,QAAAC,EACD,WAAS,cAAA,GAEE,eAAYoB,EACrB,CAGE,CAJuB,IAAAC,KAAG,CAC5BN,EAGEO,EAAA,CAFC,cAAaD,EAAI,QAAQ,SACzB,sBAAoBzB,GAAQS,EAAagB,EAAI,QAASzB,CAAG,CAAA,oEAKhEiB,EAEM,MAFNU,EAEM,CADJR,EAAiEG,EAAA,CAAtD,MAAM,UAAW,QAAOX,CAAA,aAAgB,IAAEU,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,IAAE,CAAA"}