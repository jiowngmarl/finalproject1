{"version":3,"file":"EquipmentDetail-DSFYRlt1.js","sources":["../../../client/src/pages/equipment/EquipmentDetail.vue"],"sourcesContent":["<template>\n  <div class=\"equipment-detail-page p-6\">\n    <!-- 제목 -->\n    <h1 class=\"va-h3 mb-4\">설비 상세 정보</h1>\n\n    <!-- 버튼 오른쪽 정렬 -->\n    <div class=\"flex justify-end mb-6\">\n      <div class=\"flex gap-2\">\n        <VaButton @click=\"goBack\" color=\"secondary\" class=\"w-32\">목록</VaButton>\n        <VaButton color=\"info\" @click=\"goToFullHistory\"\n          >점검 이력 조회</VaButton\n        >\n      </div>\n    </div>\n\n    <!-- 이미지 중앙 정렬 -->\n    <div class=\"flex justify-center mb-6\">\n      <div class=\"w-full max-w-sm\">\n        <img\n          v-if=\"equipment.imageUrl\"\n          :src=\"equipment.imageUrl\"\n          class=\"w-full rounded border\"\n          @error=\"onImageError\"\n        />\n        <div\n          v-else\n          class=\"w-full h-[300px] flex items-center justify-center rounded border border-gray-300 text-gray-500\"\n        >\n          이미지 없음\n        </div>\n      </div>\n    </div>\n\n    <!-- 정보 카드 중앙 정렬 -->\n    <div class=\"flex justify-center mb-6\">\n      <div class=\"w-full max-w-screen-lg grid grid-cols-2 gap-6\">\n        <div class=\"col-span-2 flex flex-col gap-6\">\n          <VaCard>\n            <VaCardTitle>설비 기본 정보</VaCardTitle>\n            <VaCardContent class=\"grid grid-cols-2 gap-4\">\n              <VaInput\n                :model-value=\"equipment.code\"\n                label=\"설비번호\"\n                readonly\n              />\n              <VaInput :model-value=\"equipment.name\" label=\"설비명\" readonly />\n\n              <!-- 설비 분류 + 설비 유형 -->\n              <VaInput\n                :model-value=\"equipment.category\"\n                label=\"설비 분류\"\n                readonly\n              />\n              <VaInput\n                :model-value=\"equipment.type\"\n                label=\"설비 유형\"\n                readonly\n              />\n\n              <!-- 생산 라인 전체 -->\n              <VaInput\n                :model-value=\"equipment.line\"\n                label=\"생산 라인\"\n                readonly\n                class=\"col-span-2\"\n              />\n\n              <!-- 도입 유형 전체 -->\n              <VaInput\n                :model-value=\"equipment.installType\"\n                label=\"도입 유형\"\n                readonly\n                class=\"col-span-2\"\n              />\n\n              <!-- 위치 전체 -->\n              <VaInput\n                :model-value=\"equipment.location\"\n                label=\"설비 위치\"\n                readonly\n                class=\"col-span-2\"\n              />\n\n              <!-- 제조일 + 등록일 -->\n              <VaInput\n                :model-value=\"equipment.manufactureDate\"\n                label=\"설비 제조일\"\n                readonly\n              />\n              <VaInput\n                :model-value=\"equipment.registerDate\"\n                label=\"설비 등록일\"\n                readonly\n              />\n            </VaCardContent>\n          </VaCard>\n\n          <VaCard>\n            <VaCardTitle>설비 기술 사양</VaCardTitle>\n            <VaCardContent class=\"grid grid-cols-2 gap-4\">\n              <VaInput :model-value=\"equipment.maker\" label=\"제조사\" readonly />\n              <VaInput\n                :model-value=\"equipment.serial\"\n                label=\"제조번호\"\n                readonly\n              />\n              <VaInput :model-value=\"equipment.model\" label=\"모델명\" readonly />\n              <VaInput\n                :model-value=\"equipment.power\"\n                label=\"정격 전력\"\n                readonly\n              />\n              <VaInput\n                :model-value=\"equipment.maxRuntime\"\n                label=\"최대 가동 시간\"\n                readonly\n              />\n              <VaInput\n                :model-value=\"equipment.maintenanceCycle\"\n                label=\"정기 점검 주기\"\n                readonly\n              />\n            </VaCardContent>\n          </VaCard>\n\n          <VaTextarea :model-value=\"equipment.note\" label=\"비고\" readonly />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onMounted } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport axios from \"axios\";\n\ninterface Equipment {\n  code: string;\n  name: string;\n  category: string;\n  line: string;\n  type: string;\n  location: string;\n  installType: string;\n  manufactureDate: string;\n  registerDate: string;\n  maker: string;\n  model: string;\n  serial: string;\n  power: string;\n  maxRuntime: string;\n  maintenanceCycle: string;\n  note: string;\n  imageUrl: string;\n}\n\ninterface CommonCodeItem {\n  value: string;\n  label: string;\n}\n\ninterface CommonCodes {\n  [key: string]: {\n    [key: string]: string;\n  };\n}\n\ninterface EquipmentData {\n  eq_id: string;\n  eq_name: string;\n  eq_group_code: string;\n  eq_type_code: string;\n  eq_import_code: string;\n  eq_factory_code: string;\n  eq_floor_code: string;\n  eq_room_code: string;\n  line_id: string | null;\n  eq_manufacture_date: string;\n  eq_registration_date: string;\n  eq_manufacturer: string;\n  eq_model: string;\n  eq_serial_number: string;\n  eq_power_spec: string;\n  eq_max_operation_time: string;\n  eq_inspection_cycle: string;\n  eq_remark: string | null;\n  eq_image: string | null;\n}\n\ninterface HistoryItem {\n  [key: string]: any;\n}\n\nconst route = useRoute();\nconst router = useRouter();\nconst equipmentId = route.params.id as string;\n\nconst loading = ref(false);\nconst activeTab = ref(\"downtime\");\n\nconst equipment = ref<Equipment>({\n  code: \"\",\n  name: \"\",\n  category: \"\",\n  line: \"\",\n  type: \"\",\n  location: \"\",\n  installType: \"\",\n  manufactureDate: \"\",\n  registerDate: \"\",\n  maker: \"\",\n  model: \"\",\n  serial: \"\",\n  power: \"\",\n  maxRuntime: \"\",\n  maintenanceCycle: \"\",\n  note: \"\",\n  imageUrl: \"\",\n});\n\nconst downtimeHistory = ref<HistoryItem[]>([]);\nconst inspectionHistory = ref<HistoryItem[]>([]);\nconst cleaningHistory = ref<HistoryItem[]>([]);\n\nconst goBack = () => {\n  router.push(\"/faq/equipment-inquiry\").catch(() => {\n    router.push(\"/equipments\").catch(() => {\n      router.push(\"/facility/equipment\").catch(() => {\n        router.back();\n      });\n    });\n  });\n};\n\nconst goToFullHistory = () => {\n  router.push(`/faq/equipment-history`);\n};\n\nconst onImageError = (event: Event) => {\n  console.error(\"이미지 로드 실패:\", (event.target as HTMLImageElement).src);\n};\n\nconst commonCodes = ref<CommonCodes>({});\n\nconst loadCommonCodes = async () => {\n  try {\n    const { data } = await axios.get(\"/common-codes?groups=0E,0T,0I,0F,0L,0M\");\n    if (data) {\n      Object.keys(data).forEach((group) => {\n        if (Array.isArray(data[group])) {\n          commonCodes.value[group] = {};\n          data[group].forEach((item: CommonCodeItem) => {\n            commonCodes.value[group][item.value] = item.label;\n          });\n        }\n      });\n    }\n  } catch {\n    useHardcodedCommonCodes();\n  }\n};\n\nconst useHardcodedCommonCodes = () => {\n  commonCodes.value = {\n    \"0E\": { e1: \"생산설비\", e2: \"품질관리설비\", e3: \"포장설비\" },\n    \"0T\": {\n      t1: \"고속 혼합기\",\n      t2: \"습식 과립기\",\n      t3: \"유동층 건조기\",\n      t4: \"정제 압축기\",\n      t5: \"정제 코팅기\",\n      t6: \"자동 포장기\",\n      t7: \"물리적 검사 장비\",\n      t8: \"분석 장비\",\n    },\n    \"0I\": { i1: \"신규\", i2: \"교체\" },\n    \"0F\": { f1: \"1 공장\", f2: \"2 공장\" },\n    \"0L\": { l1: \"1 층\", l2: \"2 층\" },\n    \"0M\": {\n      m1: \"혼합실\",\n      m2: \"과립실\",\n      m3: \"건조실\",\n      m4: \"압축실\",\n      m5: \"코팅실\",\n      m6: \"칭량실\",\n      m7: \"품질검사실\",\n      m8: \"포장실\",\n    },\n  };\n};\n\nconst getCodeLabel = (\n  group: string,\n  code: string | null | undefined,\n): string => {\n  if (!code) return \"-\";\n  return commonCodes.value[group]?.[code] || code || \"-\";\n};\n\nonMounted(async () => {\n  loading.value = true;\n  try {\n    await loadCommonCodes();\n    const { data } = await axios.get(`/equipments/${equipmentId}/detail`);\n    if (data.isSuccessed && data.data) {\n      const eq = data.data.equipment;\n      const imageUrl = eq.eq_image ? `/uploads/equipment/${eq.eq_image}` : \"\";\n      equipment.value = {\n        code: eq.eq_id || \"\",\n        name: eq.eq_name || \"\",\n        category: getCodeLabel(\"0E\", eq.eq_group_code),\n        line: eq.line_id ? `라인 ${eq.line_id}` : \"-\",\n        type: getCodeLabel(\"0T\", eq.eq_type_code),\n        location: `${getCodeLabel(\"0F\", eq.eq_factory_code)} ${getCodeLabel(\"0L\", eq.eq_floor_code)} ${getCodeLabel(\"0M\", eq.eq_room_code)}`,\n        installType: getCodeLabel(\"0I\", eq.eq_import_code),\n        manufactureDate: eq.eq_manufacture_date || \"\",\n        registerDate: eq.eq_registration_date || \"\",\n        maker: eq.eq_manufacturer || \"\",\n        model: eq.eq_model || \"\",\n        serial: eq.eq_serial_number || \"\",\n        power: eq.eq_power_spec || \"\",\n        maxRuntime: eq.eq_max_operation_time || \"\",\n        maintenanceCycle: eq.eq_inspection_cycle || \"\",\n        note: eq.eq_remark || \"-\",\n        imageUrl,\n      };\n      downtimeHistory.value = data.data.downtime?.slice(0, 5) || [];\n      inspectionHistory.value = data.data.inspection?.slice(0, 5) || [];\n      cleaningHistory.value = data.data.cleaning?.slice(0, 5) || [];\n    }\n  } catch {\n    alert(\"설비 정보를 불러오는데 실패했습니다.\");\n  } finally {\n    loading.value = false;\n  }\n});\n</script>\n\n<style scoped>\n.equipment-detail-page img {\n  max-height: 300px;\n  object-fit: contain;\n}\n\n.history-table {\n  overflow-x: auto;\n}\n\n.va-table {\n  border-collapse: collapse;\n  margin-top: 1rem;\n}\n\n.va-table th,\n.va-table td {\n  border: 1px solid #e0e0e0;\n  padding: 0.5rem;\n  text-align: left;\n}\n\n.va-table th {\n  background-color: #f5f5f5;\n  font-weight: 600;\n}\n\n.va-table tr:hover {\n  background-color: #f9f9f9;\n}\n</style>\n"],"names":["route","useRoute","router","useRouter","equipmentId","loading","ref","equipment","downtimeHistory","inspectionHistory","cleaningHistory","goBack","goToFullHistory","onImageError","event","commonCodes","loadCommonCodes","data","axios","group","item","useHardcodedCommonCodes","getCodeLabel","code","_a","onMounted","eq","imageUrl","_b","_c","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_component_VaButton","_hoisted_4","_hoisted_5","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_component_VaCard","_component_VaCardTitle","_component_VaCardContent","_component_VaInput","_component_VaTextarea"],"mappings":"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"}