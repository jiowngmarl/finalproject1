import{_ as Ae,a as Se,v as L,n as v,c as ne,x as Fe,o as Be,p as o,h as a,i as l,q as i,k as y,t as r,z as h,D as g,E as M,H as R,G as we,F as I,y as U,f as K,m as T,b as je}from"./index-1iuYf_qr.js";const Je={class:"package-line-management"},He={class:"auth-header"},Ge={key:0,class:"user-info"},ze={class:"department-info"},Ke={key:1,class:"guest-info"},Qe={class:"page-header"},We={class:"header-content"},Xe={class:"header-info"},Ye={key:0},Ze={key:1},el={key:1,class:"permission-notice"},ll={key:2,class:"login-required-notice"},tl={class:"filter-section"},nl={class:"search-bar"},ol={class:"filter-row"},al={class:"content-section"},sl={class:"section-header"},rl={class:"header-actions"},ul=["disabled"],il={key:0,class:"loading-state"},dl={key:1,class:"error-state"},cl={key:2,class:"empty-state"},_l={key:3,class:"table-container"},vl={class:"data-table"},pl={key:0,class:"checkbox-col"},ml={key:1},yl={key:0,class:"checkbox-col"},gl=["value"],fl={class:"line-info"},bl={class:"line-name"},hl={class:"line-id"},kl={class:"capacity-info"},ql={class:"capacity-main"},wl={class:"capacity-sub"},El={class:"product-info"},Nl={class:"product-code"},Rl={key:0,class:"product-name"},Cl={key:1},Ll={class:"action-buttons"},Il=["onClick"],Ul={class:"modal-body"},Ml={class:"form-row"},Tl={class:"form-group"},xl=["value"],$l={class:"form-group"},Vl=["value"],Dl={class:"form-row"},Pl={class:"form-group"},Ol=["value"],Al={class:"form-group"},Sl=["value"],Fl={key:0,class:"error-message"},Bl={class:"form-row"},jl={class:"form-group"},Jl={key:0,class:"error-message"},Hl={class:"form-group"},Gl={key:0,class:"error-message"},zl={class:"form-row"},Kl={class:"form-group"},Ql={key:0,class:"error-message"},Wl={class:"form-group"},Xl=["value"],Yl={key:0,class:"error-message"},Zl={class:"form-group full-width"},et={class:"modal-actions"},lt=["disabled"],tt={class:"modal-body"},nt={class:"form-row"},ot={class:"form-group"},at=["value"],st={key:0,class:"error-message"},rt={class:"form-group"},ut=["value"],it={class:"form-row"},dt={class:"form-group"},ct=["value"],_t={key:0,class:"error-message"},vt={key:1,class:"warning-message"},pt={class:"form-group"},mt=["value"],yt={key:0,class:"error-message"},gt={key:1,class:"warning-message"},ft={class:"form-row"},bt={class:"form-group"},ht={key:0,class:"error-message"},kt={class:"form-group"},qt={key:0,class:"error-message"},wt={class:"form-row"},Et={class:"form-group"},Nt={key:0,class:"error-message"},Rt={class:"form-group"},Ct={key:0,class:"error-message"},Lt={class:"form-row"},It={class:"form-group"},Ut=["value"],Mt={key:0,class:"error-message"},Tt={class:"form-group"},xt=["value"],$t={key:0,class:"error-message"},Vt={class:"form-group full-width"},Dt={class:"modal-actions"},Pt=["disabled"],Ot={class:"modal-body"},At={class:"permission-notice-modal"},St={key:0},Ft={class:"available-actions"},Bt={key:0},jt={key:1},Jt={key:2},Ht={key:3},Gt={key:4},zt={key:5},Kt={key:6},Qt=Object.assign({name:"PackageLineManagement"},{__name:"PackageAddLine",setup(Wt){je();const c=Se(),Ee=()=>{const t=window.onerror;window.onerror=(e,s,d,q,n)=>(console.error("전역 에러 감지:",{message:e,source:s,lineno:d,colno:q,error:n}),e&&(e.includes("vuestic")||e.includes("selectAppTreeItem")||e.includes("Could not find item"))?(console.warn("Vuestic UI 에러 무시:",e),!0):t?t(e,s,d,q,n):!1),window.addEventListener("unhandledrejection",e=>{if(console.error("처리되지 않은 Promise 에러:",e.reason),e.reason&&e.reason.message&&(e.reason.message.includes("vuestic")||e.reason.message.includes("selectAppTreeItem")||e.reason.message.includes("Could not find item"))){console.warn("Vuestic Promise 에러 무시:",e.reason.message),e.preventDefault();return}e.preventDefault()})};L.defaults.timeout=1e4,L.defaults.headers.common["Content-Type"]="application/json";const C=v([]),Ne=ne(()=>C.value.length),F=v(""),B=v(""),j=v(""),J=v(!1),x=v(!1),_e=v("데이터를 불러오는 중..."),Q=v(null),ve=v(!1),Re=v(null),D=v(null),H=v(""),$=v(null);v(""),v("asc");const O=v(!1),f=v([]),oe=v(!1),ae=v(!1),W=v(!1),w=v(null),X=v(""),A=v([]),V=v([]),Y=v([]),E=v([]),N=v([]),_=v({eq_name:"",line_state:"s2",max_capacity:1e3,current_speed:30,product_code:"",target_qty:0,employee_id:"",description:""}),u=v({line_code:"",product_code:"",inner_eq_name:"",outer_eq_name:"",inner_capacity:1e3,outer_capacity:800,inner_speed:30,outer_speed:30,inner_employee_id:"",outer_employee_id:"",description:""}),b=v({}),p=v({}),se=v([]),Ce=ne(()=>w.value?w.value.line_type==="INNER"?E.value.map(t=>t.eq_name):N.value.map(t=>t.eq_name):[]),re=ne(()=>{let t=[...C.value];if(F.value.trim()){const e=F.value.toLowerCase().trim();t=t.filter(s=>s.line_name&&s.line_name.toLowerCase().includes(e)||s.line_id&&s.line_id.toLowerCase().includes(e)||s.eq_name&&s.eq_name.toLowerCase().includes(e))}return B.value&&(t=t.filter(e=>e.line_status===B.value)),j.value&&(t=t.filter(e=>e.line_type===j.value)),t}),G=ne(()=>re.value.map(e=>(console.log("라인 데이터 확인:",{line_code:e.line_code,line_type:e.line_type,line_name:e.line_name,eq_name:e.eq_name}),{...e,line_type:e.line_type||"INNER"})));Fe([f,G],()=>{G.value.length===0?O.value=!1:O.value=f.value.length===G.value.length},{deep:!0});function S(t="이 작업"){return c.isLoggedIn?c.canManageLines?!0:(X.value=c.getPermissionMessage("line_manage"),W.value=!0,!1):(X.value="로그인이 필요합니다.",W.value=!0,!1)}function ue(){W.value=!1,X.value=""}async function Le(){var t;try{if(c.isLoggedIn&&c.user){Q.value={employee_name:c.user.employee_name,employee_id:c.user.employee_id};return}const e=await L.get("/lines/current-employee");e.data&&e.data.success?Q.value=e.data.data:Q.value={employee_name:"로그인 필요",employee_id:null}}catch(e){console.error("사용자 정보 로드 실패:",e),Q.value={employee_name:"로그인 필요",employee_id:null},((t=e.response)==null?void 0:t.status)===401?k("error","로그인이 필요합니다."):k("error","사용자 정보를 불러올 수 없습니다.")}}async function ie(){try{const t=await L.get("/lines/available-products");t.data&&t.data.success?(A.value=t.data.data,console.log("제품코드 목록 로드 성공:",A.value.length,"건")):A.value=[]}catch(t){console.error("제품코드 목록 로드 실패:",t),A.value=[{product_code:"BJA-DR-10",product_name:"10정 블리스터 포장"},{product_code:"BJA-DR-30",product_name:"30정 블리스터 포장"},{product_code:"BJA-DR-60",product_name:"60정 블리스터 포장"},{product_code:"BJA-BT-100",product_name:"100정 병 포장"}]}}async function Z(){try{const t=await L.get("/lines/available-employees");t.data&&t.data.success?(V.value=t.data.data,console.log("담당자 목록 로드 성공:",V.value.length,"명")):V.value=[]}catch(t){console.error("담당자 목록 로드 실패:",t),V.value=[{employee_id:2,employee_name:"김홍인"},{employee_id:3,employee_name:"김다산"},{employee_id:4,employee_name:"최현석"},{employee_id:5,employee_name:"이승민"}]}}async function ee(){try{$.value={type:"info",message:"설비 목록을 불러오는 중..."};const t=await L.get("/lines/available-equipments");t.data&&t.data.success?(Y.value=t.data.data,console.log("🔧 서버에서 받은 전체 설비 목록:",Y.value),E.value=[],N.value=[],Y.value.forEach(e=>{var d;const s=((d=e.eq_name)==null?void 0:d.toLowerCase())||"";if(console.log(`🔍 설비 분류 중: ${e.eq_name}`),s.includes("카톤")||s.includes("박스")||s.includes("케이스")||s.includes("상자")){console.log(`📦 외포장으로 분류: ${e.eq_name} (키워드 매칭)`),N.value.push(e);return}if(s.includes("블리스터")||s.includes("모노블럭")||s.includes("병")||s.includes("캡슐")||s.includes("튜브")||s.includes("정")&&!s.includes("카톤")){console.log(`🔧 내포장으로 분류: ${e.eq_name} (키워드 매칭)`),E.value.push(e);return}e.line_type==="OUTER"||e.eq_type==="OUTER"?(console.log(`📦 외포장으로 분류: ${e.eq_name} (타입 기반)`),N.value.push(e)):(console.log(`🔧 내포장으로 분류: ${e.eq_name} (기본값)`),E.value.push(e))}),console.log("✅ 최종 내포장 설비:",E.value.map(e=>e.eq_name)),console.log("✅ 최종 외포장 설비:",N.value.map(e=>e.eq_name)),N.value.length===0&&(console.warn("⚠️ 외포장 설비가 없어서 기본 설비를 추가합니다"),Ue()),E.value.length===0&&(console.warn("⚠️ 내포장 설비가 없어서 기본 설비를 추가합니다"),Ie()),$.value={type:"success",message:`설비 목록 로드 완료 (내포장: ${E.value.length}개, 외포장: ${N.value.length}개)`},setTimeout(()=>{$.value=null},3e3)):(console.warn("⚠️ API 응답이 비어있어서 기본 설비를 설정합니다"),pe(),$.value={type:"warning",message:"기본 설비 목록을 사용합니다"})}catch(t){console.error("❌ 설비명 목록 로드 실패:",t),pe(),$.value={type:"error",message:"설비 목록 로드 실패 - 기본 설비 사용"}}}function pe(){console.log("🔧 기본 설비 데이터 설정 시작..."),E.value=[{eq_name:"10정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"30정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"60정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"병 모노블럭",line_type:"INNER",eq_type:"INNER"}],N.value=[{eq_name:"소형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"중형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"대형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"병용 카톤포장기",line_type:"OUTER",eq_type:"OUTER"}],Y.value=[...E.value,...N.value],console.log("✅ 기본 내포장 설비:",E.value.map(t=>t.eq_name)),console.log("✅ 기본 외포장 설비:",N.value.map(t=>t.eq_name))}function Ie(){E.value=[{eq_name:"10정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"30정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"60정 블리스터 포장기",line_type:"INNER",eq_type:"INNER"},{eq_name:"병 모노블럭",line_type:"INNER",eq_type:"INNER"}],console.log("📦 기본 내포장 설비 설정 완료:",E.value.map(t=>t.eq_name))}function Ue(){N.value=[{eq_name:"소형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"중형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"대형 카톤포장기",line_type:"OUTER",eq_type:"OUTER"},{eq_name:"병용 카톤포장기",line_type:"OUTER",eq_type:"OUTER"}],console.log("📦 기본 외포장 설비 설정 완료:",N.value.map(t=>t.eq_name))}function k(t,e){D.value={type:t,message:e},t==="success"&&setTimeout(()=>{D.value=null},3e3)}async function me(){var t,e;J.value=!0,_e.value="라인 목록을 불러오는 중...",H.value="";try{const s=await L.get("/lines/list");s.data&&s.data.success&&Array.isArray(s.data.data)?(C.value=s.data.data,Re.value=new Date,ve.value=!0,k("success",`${C.value.length}개의 라인을 불러왔습니다`)):(C.value=[],H.value="데이터 형식이 올바르지 않습니다",k("error","데이터 형식 오류가 발생했습니다"))}catch(s){if(console.error("라인 목록 로드 실패:",s),ve.value=!1,s.code==="ERR_NETWORK"){const d="API 서버에 연결할 수 없습니다. 서버가 실행 중인지 확인해주세요.";s.value=d,k("error",d)}else{const d=`라인 목록 로드 실패: ${((e=(t=s.response)==null?void 0:t.data)==null?void 0:e.message)||s.message}`;s.value=d,k("error",d)}C.value=[]}finally{J.value=!1}}async function de(){try{const t=C.value.map(s=>s.line_code).filter(s=>s),e=Array.from({length:26},(s,d)=>String.fromCharCode(65+d));se.value=e.filter(s=>!t.includes(s))}catch(t){console.warn("사용 가능한 라인 ID 계산 실패:",t),se.value=["F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}}function Me(){if(S("라인 수정")&&f.value.length!==0)if(f.value.length===1){const t=f.value[0],[e,s]=t.split("-"),d=C.value.find(q=>q.line_code===e&&q.line_type===s);d&&ye(d)}else alert(`${f.value.length}개의 라인이 선택되었습니다.
일괄 수정 기능은 준비 중입니다.`)}async function Te(){if(!S("라인 삭제")||f.value.length===0)return;const e=`선택된 ${f.value.length}개의 라인을 삭제하시겠습니까?
삭제된 라인은 복구할 수 없습니다.`;if(confirm(e))try{k("info","선택된 라인들을 삭제하는 중...");const s=f.value.map(m=>L.delete(`/lines/${m}`).catch(P=>(console.error(`라인 삭제 실패 (${m}):`,P),{success:!1,error:P.message}))),d=await Promise.allSettled(s);let q=0,n=0;d.forEach((m,P)=>{var qe;m.status==="fulfilled"&&m.value&&m.value.data&&m.value.data.success?q++:(n++,console.error(`라인 삭제 실패 (${f.value[P]}):`,m.reason||((qe=m.value)==null?void 0:qe.error)))});try{f.value=[],O.value=!1}catch(m){console.warn("상태 초기화 중 에러 (무시):",m)}n===0?k("success",`${q}개의 라인이 삭제되었습니다`):k("warning",`${q}개 삭제 완료, ${n}개 실패`);try{await z()}catch(m){console.warn("데이터 새로고침 중 에러 (무시):",m),setTimeout(()=>{window.location.reload()},2e3)}}catch(s){console.error("일괄 삭제 실패:",s),k("error","라인 삭제 중 오류가 발생했습니다")}}function xe(){c.canManageLines&&(O.value?f.value=G.value.map(t=>`${t.line_code}-${t.line_type}`):f.value=[])}function $e(){const t={};return _.value.eq_name||(t.eq_name="설비명을 선택해주세요."),(!_.value.max_capacity||_.value.max_capacity<=0)&&(t.max_capacity="최대 생산능력을 입력해주세요."),(_.value.current_speed===null||_.value.current_speed===void 0||_.value.current_speed<0)&&(t.current_speed="현재 속도를 입력해주세요."),_.value.employee_id||(t.employee_id="담당자를 선택해주세요."),b.value=t,Object.keys(t).length===0}function Ve(){const t={};return u.value.line_code||(t.line_code="라인 코드를 선택해주세요."),u.value.inner_eq_name||(t.inner_eq_name="내포장 설비명을 선택해주세요."),u.value.outer_eq_name||(t.outer_eq_name="외포장 설비명을 선택해주세요."),(!u.value.inner_capacity||u.value.inner_capacity<=0)&&(t.inner_capacity="내포장 지시수량을 입력해주세요."),(!u.value.outer_capacity||u.value.outer_capacity<=0)&&(t.outer_capacity="외포장 지시수량을 입력해주세요."),(u.value.inner_speed===null||u.value.inner_speed===void 0||u.value.inner_speed<0)&&(t.inner_speed="내포장 현재 속도를 입력해주세요."),(u.value.outer_speed===null||u.value.outer_speed===void 0||u.value.outer_speed<0)&&(t.outer_speed="외포장 현재 속도를 입력해주세요."),u.value.inner_employee_id||(t.inner_employee_id="내포장 담당자를 선택해주세요."),u.value.outer_employee_id||(t.outer_employee_id="외포장 담당자를 선택해주세요."),p.value=t,Object.keys(t).length===0}function ye(t){S("라인 수정")&&(console.log("수정할 라인 정보:",t),w.value={...t,line_type:t.line_type,line_code:t.line_code},_.value={eq_name:t.eq_name||"",line_state:t.line_state||"s2",max_capacity:t.max_capacity||1e3,current_speed:t.current_speed||30,product_code:t.product_code||"",target_qty:t.target_qty||0,employee_id:t.employee_id||"",description:t.description||""},b.value={},Z(),ee(),oe.value=!0,console.log("editingLine 설정:",w.value))}async function ge(){S("라인 등록")&&(u.value={line_code:"",product_code:"",inner_eq_name:"",outer_eq_name:"",inner_capacity:1e3,outer_capacity:800,inner_speed:30,outer_speed:30,inner_employee_id:"",outer_employee_id:"",description:""},p.value={},await de(),await Z(),await ie(),await ee(),ae.value=!0)}async function z(){const t=[];try{t.push(me().catch(e=>(console.warn("라인 목록 새로고침 실패:",e),[]))),t.push(de().catch(e=>(console.warn("라인 ID 목록 새로고침 실패:",e),[]))),t.push(ie().catch(e=>(console.warn("제품 목록 새로고침 실패:",e),[]))),t.push(Z().catch(e=>(console.warn("담당자 목록 새로고침 실패:",e),[]))),t.push(ee().catch(e=>(console.warn("설비 목록 새로고침 실패:",e),[]))),await Promise.allSettled(t),console.log("데이터 새로고침 완료")}catch(e){throw console.error("데이터 새로고침 중 예외 발생:",e),e}}async function fe(){try{await z()}catch(t){console.error("데이터 새로고침 실패:",t),k("error","데이터 새로고침에 실패했습니다.")}}async function be(){var t,e;if(S("라인 등록")&&Ve()){x.value=!0,p.value={};try{console.log("내포장/외포장 동시 등록 API 호출"),console.log("요청 데이터:",JSON.stringify(u.value,null,2));const d=["line_code","inner_eq_name","outer_eq_name","inner_employee_id","outer_employee_id"].filter(m=>!u.value[m]);if(d.length>0)throw new Error(`필수 필드가 누락되었습니다: ${d.join(", ")}`);const q={...u.value,eq_group_code:"e3"},n=await L.post("/lines/dual",q);if(n.data.success){k("success",n.data.message||"내포장/외포장 라인이 성공적으로 등록되었습니다.");try{te()}catch(m){console.warn("모달 닫기 중 에러 (무시):",m)}try{await z()}catch(m){console.warn("데이터 새로고침 중 에러 (무시):",m),setTimeout(()=>{window.location.reload()},2e3)}}else throw new Error(n.data.message||"동시 등록에 실패했습니다")}catch(s){console.error("동시 등록 실패:",s);let d="동시 등록에 실패했습니다";(e=(t=s.response)==null?void 0:t.data)!=null&&e.message?d=s.response.data.message:s.message&&(d=s.message),d.includes("이미 존재하는 라인")&&(d=`${u.value.line_code}라인이 이미 존재합니다. 다른 라인 코드를 선택해주세요.`),k("error",d)}finally{x.value=!1}}}async function he(){var t,e,s;if(S("라인 수정")&&$e()){x.value=!0,b.value={};try{console.log("수정 API 호출 정보:"),console.log("  라인 코드:",w.value.line_code),console.log("  라인 타입:",w.value.line_type);const d={line_code:w.value.line_code,line_type:w.value.line_type,eq_name:_.value.eq_name,line_state:_.value.line_state,max_capacity:_.value.max_capacity,current_speed:_.value.current_speed,product_code:_.value.product_code,target_qty:_.value.target_qty,description:_.value.description,employee_id:_.value.employee_id,employee_name:((t=V.value.find(m=>m.employee_id==_.value.employee_id))==null?void 0:t.employee_name)||""},q=`/lines/${w.value.line_code}/${w.value.line_type}`;console.log("API URL:",q);const n=await L.put(q,d);if(n.data.success){k("success",n.data.message||`${w.value.line_code}라인 ${ce(w.value.line_type)}이 성공적으로 수정되었습니다`);try{le()}catch(m){console.warn("모달 닫기 중 에러 (무시):",m)}try{await z()}catch(m){console.warn("데이터 새로고침 중 에러 (무시):",m),setTimeout(()=>{window.location.reload()},2e3)}}else throw new Error(n.data.message||"수정에 실패했습니다")}catch(d){console.error("라인 수정 실패:",d),k("error",((s=(e=d.response)==null?void 0:e.data)==null?void 0:s.message)||`라인 수정 실패: ${d.message}`)}finally{x.value=!1}}}function le(){oe.value=!1,w.value=null,b.value={},_.value={eq_name:"",line_state:"s2",max_capacity:1e3,current_speed:30,product_code:"",target_qty:0,employee_id:"",description:""}}function te(){ae.value=!1,p.value={},u.value={line_code:"",product_code:"",inner_eq_name:"",outer_eq_name:"",inner_capacity:1e3,outer_capacity:800,inner_speed:30,outer_speed:30,inner_employee_id:"",outer_employee_id:"",description:""}}function De(){F.value="",B.value="",j.value=""}async function ke(){H.value="",D.value=null;try{await z()}catch(t){console.error("재연결 실패:",t),k("error","재연결에 실패했습니다.")}}function ce(t){return t==="INNER"?"내포장":"외포장"}function Pe(t){return{"가동 중":"working","가동대기 중":"available",가동정지:"stopped"}[t]||"available"}function Oe(t){return(t==null?void 0:t.toLocaleString())||"0"}return Be(async()=>{Ee();try{console.log("컴포넌트 마운트 - 초기 데이터 로딩 시작");const t=[Le().catch(e=>console.warn("사용자 정보 로딩 실패:",e)),me().catch(e=>console.warn("라인 목록 로딩 실패:",e)),de().catch(e=>console.warn("라인 ID 목록 로딩 실패:",e)),ie().catch(e=>console.warn("제품 목록 로딩 실패:",e)),Z().catch(e=>console.warn("담당자 목록 로딩 실패:",e)),ee().catch(e=>console.warn("설비 목록 로딩 실패:",e))];await Promise.allSettled(t),console.log("초기 데이터 로딩 완료")}catch(t){console.error("초기화 중 예외 발생:",t),k("warning","일부 데이터를 불러오는데 실패했습니다. 새로고침해주세요.")}}),(t,e)=>{var s,d,q;return a(),o("div",Je,[l("div",He,[y(c).isLoggedIn?(a(),o("div",Ge,[l("span",null,r(((s=y(c).user)==null?void 0:s.employee_name)||"사용자")+"님",1),l("span",ze,"("+r(y(c).userRole)+")",1)])):(a(),o("div",Ke,e[28]||(e[28]=[l("span",{class:"guest-text"},"조회 모드 (로그인이 필요합니다)",-1)])))]),l("div",Qe,[e[30]||(e[30]=l("div",{class:"breadcrumb"},null,-1)),l("div",We,[l("div",Xe,[e[29]||(e[29]=l("h1",null,"포장 라인 관리",-1)),y(c).canManageLines?(a(),o("p",Ye," 포장 라인을 등록, 수정, 삭제할 수 있습니다. ")):(a(),o("p",Ze,"포장 라인 목록을 조회할 수 있습니다."))]),y(c).canManageLines?(a(),o("button",{key:0,onClick:e[0]||(e[0]=n=>ge()),class:"btn-register"}," 라인 등록 ")):y(c).isLoggedIn?(a(),o("div",el,r(y(c).getPermissionMessage("line_manage")),1)):(a(),o("div",ll," 라인 등록은 로그인 후 이용 가능합니다 "))])]),D.value?(a(),o("div",{key:0,class:h(["api-status",D.value.type])},[l("span",null,r(D.value.message),1),D.value.type==="error"?(a(),o("button",{key:0,onClick:ke,class:"retry-btn"}," 재시도 ")):i("",!0)],2)):i("",!0),l("div",tl,[l("div",nl,[g(l("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>F.value=n),type:"text",placeholder:"라인명, 라인ID, 설비명으로 검색",class:"search-input"},null,512),[[M,F.value]]),l("button",{onClick:fe,class:"search-btn"},"검색")]),l("div",ol,[g(l("select",{"onUpdate:modelValue":e[2]||(e[2]=n=>j.value=n),class:"filter-select"},e[31]||(e[31]=[l("option",{value:""},"전체 타입",-1),l("option",{value:"INNER"},"내포장",-1),l("option",{value:"OUTER"},"외포장",-1)]),512),[[R,j.value]]),g(l("select",{"onUpdate:modelValue":e[3]||(e[3]=n=>B.value=n),class:"filter-select"},e[32]||(e[32]=[l("option",{value:""},"전체 상태",-1),l("option",{value:"가동 중"},"가동 중",-1),l("option",{value:"가동대기 중"},"가동대기 중",-1),l("option",{value:"가동정지"},"가동정지",-1)]),512),[[R,B.value]]),l("button",{onClick:De,class:"filter-reset-btn"},"초기화")])]),l("div",al,[l("div",sl,[l("h3",null,"라인 목록 ("+r(re.value.length)+"/"+r(Ne.value)+")",1),l("div",rl,[l("button",{onClick:fe,class:"btn-refresh",disabled:J.value}," 새로고침 ",8,ul),y(c).canManageLines&&f.value.length>0?(a(),o("button",{key:0,onClick:Me,class:"btn-edit"}," 선택 수정 ("+r(f.value.length)+") ",1)):i("",!0),y(c).canManageLines&&f.value.length>0?(a(),o("button",{key:1,onClick:Te,class:"btn-delete"}," 선택 삭제 ("+r(f.value.length)+") ",1)):i("",!0)])]),J.value?(a(),o("div",il,[e[33]||(e[33]=l("div",{class:"loading-spinner"},null,-1)),l("span",null,r(_e.value),1)])):H.value?(a(),o("div",dl,[e[34]||(e[34]=l("h4",null,"데이터를 불러올 수 없습니다",-1)),l("p",null,r(H.value),1),l("button",{onClick:ke,class:"btn-retry"},"다시 시도")])):re.value.length===0&&!J.value?(a(),o("div",cl,[l("h4",null,r(C.value.length===0?"등록된 라인이 없습니다":"조건에 맞는 라인이 없습니다"),1),l("p",null,r(C.value.length===0?"새로운 라인을 등록해주세요.":"검색 조건을 변경해주세요."),1),C.value.length===0&&y(c).canManageLines?(a(),o("button",{key:0,onClick:e[4]||(e[4]=n=>ge()),class:"btn-register"}," 첫 번째 라인 등록하기 ")):i("",!0)])):(a(),o("div",_l,[l("table",vl,[l("thead",null,[l("tr",null,[y(c).canManageLines?(a(),o("th",pl,[g(l("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=n=>O.value=n),onChange:xe},null,544),[[we,O.value]])])):i("",!0),e[35]||(e[35]=l("th",null,"번호",-1)),e[36]||(e[36]=l("th",null,"라인명",-1)),e[37]||(e[37]=l("th",null,"분류",-1)),e[38]||(e[38]=l("th",null,"설비명",-1)),e[39]||(e[39]=l("th",null,"상태",-1)),e[40]||(e[40]=l("th",null,"생산능력",-1)),e[41]||(e[41]=l("th",null,"담당자",-1)),e[42]||(e[42]=l("th",null,"제품코드",-1)),y(c).canManageLines?(a(),o("th",ml,"작업")):i("",!0)])]),l("tbody",null,[(a(!0),o(I,null,U(G.value,(n,m)=>(a(),o("tr",{key:`${n.line_code}-${n.line_type}`},[y(c).canManageLines?(a(),o("td",yl,[g(l("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=P=>f.value=P),value:`${n.line_code}-${n.line_type}`},null,8,gl),[[we,f.value]])])):i("",!0),l("td",null,r(m+1),1),l("td",null,[l("div",fl,[l("div",bl,r(n.line_name),1),l("div",hl,"ID: "+r(n.line_code),1)])]),l("td",null,[l("span",{class:h(["type-badge",n.line_type?n.line_type.toLowerCase():"inner"])},r(ce(n.line_type)),3)]),l("td",null,r(n.eq_name||"-"),1),l("td",null,[l("span",{class:h(["status-badge",Pe(n.line_status)])},r(n.line_status||"가동대기 중"),3)]),l("td",null,[l("div",kl,[l("div",ql,r(Oe(n.max_capacity))+"정 ",1),l("div",wl," 현재: "+r(n.current_speed||0)+"정/초 ",1)])]),l("td",null,r(n.employee_name||"-"),1),l("td",null,[l("div",El,[l("div",Nl,r(n.product_code||"-"),1),n.product_name&&n.product_name!==n.product_code?(a(),o("div",Rl,r(n.product_name),1)):i("",!0)])]),y(c).canManageLines?(a(),o("td",Cl,[l("div",Ll,[l("button",{onClick:P=>ye(n),class:"btn-edit-single"}," 수정 ",8,Il)])])):i("",!0)]))),128))])])]))]),oe.value&&y(c).canManageLines?(a(),o("div",{key:1,class:"modal-overlay",onClick:le},[l("div",{class:"modal-content",onClick:e[14]||(e[14]=K(()=>{},["stop"]))},[l("div",{class:"modal-header"},[e[43]||(e[43]=l("h3",null,"라인 수정",-1)),l("button",{onClick:le,class:"modal-close"},"×")]),l("div",Ul,[l("form",{onSubmit:K(he,["prevent"]),class:"line-form"},[l("div",Ml,[l("div",Tl,[e[44]||(e[44]=l("label",null,"라인 ID",-1)),l("input",{value:(d=w.value)==null?void 0:d.line_code,type:"text",disabled:""},null,8,xl)]),l("div",$l,[e[46]||(e[46]=l("label",null,"제품코드",-1)),g(l("select",{"onUpdate:modelValue":e[7]||(e[7]=n=>_.value.product_code=n)},[e[45]||(e[45]=l("option",{value:""},"제품코드 선택",-1)),(a(!0),o(I,null,U(A.value,n=>(a(),o("option",{key:n.product_code,value:n.product_code},r(n.product_code)+" - "+r(n.product_name),9,Vl))),128))],512),[[R,_.value.product_code]])])]),l("div",Dl,[l("div",Pl,[e[47]||(e[47]=l("label",null,"라인 타입",-1)),l("input",{value:ce(((q=w.value)==null?void 0:q.line_type)||"INNER"),type:"text",disabled:""},null,8,Ol)]),l("div",Al,[e[49]||(e[49]=l("label",null,"설비명 *",-1)),g(l("select",{"onUpdate:modelValue":e[8]||(e[8]=n=>_.value.eq_name=n),class:h({error:b.value.eq_name})},[e[48]||(e[48]=l("option",{value:""},"설비 선택",-1)),(a(!0),o(I,null,U(Ce.value,n=>(a(),o("option",{key:n,value:n},r(n),9,Sl))),128))],2),[[R,_.value.eq_name]]),b.value.eq_name?(a(),o("div",Fl,r(b.value.eq_name),1)):i("",!0)])]),l("div",Bl,[l("div",jl,[e[51]||(e[51]=l("label",null,"상태 *",-1)),g(l("select",{"onUpdate:modelValue":e[9]||(e[9]=n=>_.value.line_state=n),class:h({error:b.value.line_state})},e[50]||(e[50]=[l("option",{value:"s1"},"가동 중",-1),l("option",{value:"s2"},"가동대기 중",-1),l("option",{value:"s3"},"가동정지",-1)]),2),[[R,_.value.line_state]]),b.value.line_state?(a(),o("div",Jl,r(b.value.line_state),1)):i("",!0)]),l("div",Hl,[e[52]||(e[52]=l("label",null,"지시수량 (정) *",-1)),g(l("input",{"onUpdate:modelValue":e[10]||(e[10]=n=>_.value.max_capacity=n),type:"number",min:"1",class:h({error:b.value.max_capacity})},null,2),[[M,_.value.max_capacity,void 0,{number:!0}]]),b.value.max_capacity?(a(),o("div",Gl,r(b.value.max_capacity),1)):i("",!0)])]),l("div",zl,[l("div",Kl,[e[53]||(e[53]=l("label",null,"현재 속도 (정/초) *",-1)),g(l("input",{"onUpdate:modelValue":e[11]||(e[11]=n=>_.value.current_speed=n),type:"number",min:"0",class:h({error:b.value.current_speed})},null,2),[[M,_.value.current_speed,void 0,{number:!0}]]),b.value.current_speed?(a(),o("div",Ql,r(b.value.current_speed),1)):i("",!0)]),l("div",Wl,[e[55]||(e[55]=l("label",null,"담당자 *",-1)),g(l("select",{"onUpdate:modelValue":e[12]||(e[12]=n=>_.value.employee_id=n),class:h({error:b.value.employee_id})},[e[54]||(e[54]=l("option",{value:""},"담당자 선택",-1)),(a(!0),o(I,null,U(V.value,n=>(a(),o("option",{key:n.employee_id,value:n.employee_id},r(n.employee_name),9,Xl))),128))],2),[[R,_.value.employee_id]]),b.value.employee_id?(a(),o("div",Yl,r(b.value.employee_id),1)):i("",!0)])]),l("div",Zl,[e[56]||(e[56]=l("label",null,"설명",-1)),g(l("textarea",{"onUpdate:modelValue":e[13]||(e[13]=n=>_.value.description=n),rows:"3",placeholder:"라인에 대한 상세 설명을 입력하세요"},null,512),[[M,_.value.description]])])],32)]),l("div",et,[l("button",{onClick:le,class:"btn-cancel"},"취소"),l("button",{onClick:he,disabled:x.value,class:"btn-save"},r(x.value?"저장중...":"수정"),9,lt)])])])):i("",!0),ae.value&&y(c).canManageLines?(a(),o("div",{key:2,class:"modal-overlay",onClick:te},[l("div",{class:"modal-content",onClick:e[26]||(e[26]=K(()=>{},["stop"]))},[l("div",{class:"modal-header"},[e[57]||(e[57]=l("h3",null,"라인 등록",-1)),l("button",{onClick:te,class:"modal-close"},"×")]),l("div",tt,[e[73]||(e[73]=l("div",{class:"register-info"},[l("h4",null,"내포장/외포장 동시 등록"),l("p",null,[T(" 선택한 라인 ID로 "),l("strong",null,"내포장"),T("과 "),l("strong",null,"외포장"),T(" 라인이 동시에 등록됩니다. ")]),l("p",null,[l("strong",null,"담당자:"),T(" 각 포장 유형별로 담당자를 선택할 수 있습니다. ")]),l("p",null,[l("strong",null,"제품코드:"),T(" 공정흐름도에 따라 자동으로 처리됩니다. ")])],-1)),$.value?(a(),o("div",{key:0,class:h(["equipment-status",$.value.type])},[l("span",null,r($.value.message),1)],2)):i("",!0),l("form",{onSubmit:K(be,["prevent"]),class:"line-form"},[l("div",nt,[l("div",ot,[e[59]||(e[59]=l("label",null,"라인 ID *",-1)),g(l("select",{"onUpdate:modelValue":e[15]||(e[15]=n=>u.value.line_code=n),class:h({error:p.value.line_code})},[e[58]||(e[58]=l("option",{value:""},"라인 선택",-1)),(a(!0),o(I,null,U(se.value,n=>(a(),o("option",{key:n,value:n},r(n)+"라인 ",9,at))),128))],2),[[R,u.value.line_code]]),p.value.line_code?(a(),o("div",st,r(p.value.line_code),1)):i("",!0)]),l("div",rt,[e[61]||(e[61]=l("label",null,"제품코드",-1)),g(l("select",{"onUpdate:modelValue":e[16]||(e[16]=n=>u.value.product_code=n)},[e[60]||(e[60]=l("option",{value:""},"제품코드 선택",-1)),(a(!0),o(I,null,U(A.value,n=>(a(),o("option",{key:n.product_code,value:n.product_code},r(n.product_code)+" - "+r(n.product_name),9,ut))),128))],512),[[R,u.value.product_code]])])]),l("div",it,[l("div",dt,[l("label",null,"내포장 설비명 * ("+r(E.value.length)+"개 설비)",1),g(l("select",{"onUpdate:modelValue":e[17]||(e[17]=n=>u.value.inner_eq_name=n),class:h({error:p.value.inner_eq_name})},[e[62]||(e[62]=l("option",{value:""},"설비 선택",-1)),(a(!0),o(I,null,U(E.value,n=>(a(),o("option",{key:n.eq_name,value:n.eq_name},r(n.eq_name),9,ct))),128))],2),[[R,u.value.inner_eq_name]]),p.value.inner_eq_name?(a(),o("div",_t,r(p.value.inner_eq_name),1)):i("",!0),E.value.length===0?(a(),o("div",vt," 내포장 설비가 없습니다 ")):i("",!0)]),l("div",pt,[l("label",null,"외포장 설비명 * ("+r(N.value.length)+"개 설비)",1),g(l("select",{"onUpdate:modelValue":e[18]||(e[18]=n=>u.value.outer_eq_name=n),class:h({error:p.value.outer_eq_name})},[e[63]||(e[63]=l("option",{value:""},"설비 선택",-1)),(a(!0),o(I,null,U(N.value,n=>(a(),o("option",{key:n.eq_name,value:n.eq_name},r(n.eq_name),9,mt))),128))],2),[[R,u.value.outer_eq_name]]),p.value.outer_eq_name?(a(),o("div",yt,r(p.value.outer_eq_name),1)):i("",!0),N.value.length===0?(a(),o("div",gt," 외포장 설비가 없습니다 ")):i("",!0)])]),l("div",ft,[l("div",bt,[e[64]||(e[64]=l("label",null,"내포장 지시수량 (정) *",-1)),g(l("input",{"onUpdate:modelValue":e[19]||(e[19]=n=>u.value.inner_capacity=n),type:"number",min:"1",placeholder:"1000",class:h({error:p.value.inner_capacity})},null,2),[[M,u.value.inner_capacity,void 0,{number:!0}]]),p.value.inner_capacity?(a(),o("div",ht,r(p.value.inner_capacity),1)):i("",!0)]),l("div",kt,[e[65]||(e[65]=l("label",null,"외포장 지시수량 (정) *",-1)),g(l("input",{"onUpdate:modelValue":e[20]||(e[20]=n=>u.value.outer_capacity=n),type:"number",min:"1",placeholder:"800",class:h({error:p.value.outer_capacity})},null,2),[[M,u.value.outer_capacity,void 0,{number:!0}]]),p.value.outer_capacity?(a(),o("div",qt,r(p.value.outer_capacity),1)):i("",!0)])]),l("div",wt,[l("div",Et,[e[66]||(e[66]=l("label",null,"내포장 현재속도 (정/초) *",-1)),g(l("input",{"onUpdate:modelValue":e[21]||(e[21]=n=>u.value.inner_speed=n),type:"number",min:"0",placeholder:"30",class:h({error:p.value.inner_speed})},null,2),[[M,u.value.inner_speed,void 0,{number:!0}]]),p.value.inner_speed?(a(),o("div",Nt,r(p.value.inner_speed),1)):i("",!0)]),l("div",Rt,[e[67]||(e[67]=l("label",null,"외포장 현재속도 (정/초) *",-1)),g(l("input",{"onUpdate:modelValue":e[22]||(e[22]=n=>u.value.outer_speed=n),type:"number",min:"0",placeholder:"30",class:h({error:p.value.outer_speed})},null,2),[[M,u.value.outer_speed,void 0,{number:!0}]]),p.value.outer_speed?(a(),o("div",Ct,r(p.value.outer_speed),1)):i("",!0)])]),l("div",Lt,[l("div",It,[e[69]||(e[69]=l("label",null,"내포장 담당자 *",-1)),g(l("select",{"onUpdate:modelValue":e[23]||(e[23]=n=>u.value.inner_employee_id=n),class:h({error:p.value.inner_employee_id})},[e[68]||(e[68]=l("option",{value:""},"담당자 선택",-1)),(a(!0),o(I,null,U(V.value,n=>(a(),o("option",{key:n.employee_id,value:n.employee_id},r(n.employee_name),9,Ut))),128))],2),[[R,u.value.inner_employee_id]]),p.value.inner_employee_id?(a(),o("div",Mt,r(p.value.inner_employee_id),1)):i("",!0)]),l("div",Tt,[e[71]||(e[71]=l("label",null,"외포장 담당자 *",-1)),g(l("select",{"onUpdate:modelValue":e[24]||(e[24]=n=>u.value.outer_employee_id=n),class:h({error:p.value.outer_employee_id})},[e[70]||(e[70]=l("option",{value:""},"담당자 선택",-1)),(a(!0),o(I,null,U(V.value,n=>(a(),o("option",{key:n.employee_id,value:n.employee_id},r(n.employee_name),9,xt))),128))],2),[[R,u.value.outer_employee_id]]),p.value.outer_employee_id?(a(),o("div",$t,r(p.value.outer_employee_id),1)):i("",!0)])]),l("div",Vt,[e[72]||(e[72]=l("label",null,"설명",-1)),g(l("textarea",{"onUpdate:modelValue":e[25]||(e[25]=n=>u.value.description=n),rows:"3",placeholder:"라인에 대한 상세 설명을 입력하세요"},null,512),[[M,u.value.description]])])],32)]),l("div",Dt,[l("button",{onClick:te,class:"btn-cancel"},"취소"),l("button",{onClick:be,disabled:x.value,class:"btn-save"},r(x.value?"등록중...":"등록"),9,Pt)])])])):i("",!0),W.value?(a(),o("div",{key:3,class:"modal-overlay",onClick:ue},[l("div",{class:"modal-content",onClick:e[27]||(e[27]=K(()=>{},["stop"]))},[l("div",{class:"modal-header"},[e[74]||(e[74]=l("h3",null,"접근 권한 없음",-1)),l("button",{onClick:ue,class:"modal-close"},"×")]),l("div",Ot,[l("div",At,[l("h4",null,r(X.value),1),y(c).userPermissionSummary?(a(),o("p",St,[e[75]||(e[75]=T(" 현재 부서: ")),l("strong",null,r(y(c).userPermissionSummary.departmentName)+"부서",1),e[76]||(e[76]=l("br",null,null,-1)),T(" 부서 권한: "+r(y(c).userPermissionSummary.description),1)])):i("",!0),e[78]||(e[78]=l("p",null,[T(" 포장 라인 관리는 "),l("strong",null,"포장부서"),T(" 직원만 사용할 수 있습니다. ")],-1)),l("div",Ft,[e[77]||(e[77]=l("h5",null,"사용 가능한 기능:",-1)),l("ul",null,[y(c).canViewLines?(a(),o("li",Bt,"포장 라인 목록 조회")):i("",!0),y(c).canManageProduction?(a(),o("li",jt,"생산 관리")):i("",!0),y(c).canManageMaterial?(a(),o("li",Jt,"자재 관리")):i("",!0),y(c).canManageQuality?(a(),o("li",Ht,"품질 관리")):i("",!0),y(c).canManageLogistics?(a(),o("li",Gt,"물류 관리")):i("",!0),y(c).canManageAdmin?(a(),o("li",zt,"관리자 기능")):i("",!0),y(c).canManageSales?(a(),o("li",Kt,"영업 관리")):i("",!0)])])])]),l("div",{class:"modal-actions"},[l("button",{onClick:ue,class:"btn-cancel"},"확인")])])])):i("",!0)])}}}),Yt=Ae(Qt,[["__scopeId","data-v-9bdfcf85"]]);export{Yt as default};
//# sourceMappingURL=PackageAddLine-BOxQnVrI.js.map
